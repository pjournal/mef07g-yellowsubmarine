<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Group Yellow Submarine">
<meta name="dcterms.date" content="2024-01-04">

<title>YELLOW SUBMARINE Progress Journal - Final Reports</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assignment1.html" rel="next">
<link href="./exploratorydataanalysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./finalreport.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Final Reports</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">YELLOW SUBMARINE Progress Journal</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pjournal/mef07g-yellowsubmarine" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocesseddata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preprocessed Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratorydataanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./finalreport.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Final Reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Assignment 1</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#key-takeways" id="toc-key-takeways" class="nav-link active" data-scroll-target="#key-takeways">Key Takeways</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#outcomes" id="toc-outcomes" class="nav-link" data-scroll-target="#outcomes">Outcomes</a>
  <ul class="collapse">
  <li><a href="#exports-imports-analysis" id="toc-exports-imports-analysis" class="nav-link" data-scroll-target="#exports-imports-analysis">Exports &amp; Imports Analysis</a></li>
  <li><a href="#trade-partnership-analysis" id="toc-trade-partnership-analysis" class="nav-link" data-scroll-target="#trade-partnership-analysis">Trade Partnership Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#shiny-app-link" id="toc-shiny-app-link" class="nav-link" data-scroll-target="#shiny-app-link">Shiny App Link</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Final Reports</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Group Yellow Submarine </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 4, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="key-takeways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeways">Key Takeways</h2>
<ol type="1">
<li><p>For the analysis period which is between 2002 and 2020, Turkey kept its net importer position in majority of the product categories that are primarily used as an intermediary in goods.</p></li>
<li><p>Turkey’s dependence on energy and natural resources is concentrated, posing a significant risk if relations with Russia and Iran were to deteriorate. A similar vulnerability is observed in machinery and mechanical components, suggesting the need for diversification or incentives to encourage local production.</p></li>
<li><p>Turkey has close relations with Europe, taking advantage of being a signatory of custom union with the EU. On the contrary; the exposure to Europe, as evidenced in the EDA, underscores a category risk for Turkey. Economic downturns or recessions in Europe significantly impact Turkey’s exports and imports.</p></li>
<li><p>While Turkey boasts more than 200 trading partners for both exports and imports, the high revenue-generating product categories lack diversification. Most of the top 10 product categories show stagnant or declining growth in USD values. This signals the importance of exploring new markets and expanding the product portfolio to mitigate risks associated with concentrated trade.</p></li>
<li><p>As the main outcome; this EDA reveals Turkey’s heavy reliance on intermediate goods and a relatively lower emphasis on strategic investments in R&amp;D and incentives for a skilled workforce, pointing out a necessity of adopting a new economic model, which encourages innovation, reduces dependence on intermediates, increasing diversification of trade partners and ensures a more sustainable and resilient trade ecosystem.</p></li>
</ol>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Our group project, “Turkey Analysis: Trade Balance &amp; Partners” delves into the details of Turkey’s international trade landscape from 2002 to 2020.</p>
<p>Utilizing the data aggregation capabilities of WITS, our analysis covers Turkey’s export &amp; import dynamics and its relations with trade partners during this significant period. The data, sourced from a package developed by a team led by Mauricio Vargas provides a comprehensive overview of Turkey’s trade dynamics.</p>
<p>Throughout our analysis, we uncovered key findings that include the consistent upward trajectory of Turkey’s exports and imports, the influence of global events such as the financial crisis and the impact of monetary policies and currency fluctuations. Notably, Turkey has maintained a persistent foreign trade deficit, with fluctuations and intriguing trends observed in different years.</p>
<p>Our exploration extends to product categories, revealing that certain sectors, like textiles and machinery, significantly contribute to Turkey’s export revenue. On the import side, machinery and base metals play a crucial role. We also delve into the trends of these categories over the years, identifying fluctuations and their potential drivers.</p>
<p>Additionally, our analysis scrutinizes Turkey’s trade partnerships, highlighting the country’s diverse range of trading allies. We examine the top trading partners, Turkey’s net exporter/importer positions, and the evolution of trade relations over the last five years.</p>
</section>
<section id="outcomes" class="level2">
<h2 class="anchored" data-anchor-id="outcomes">Outcomes</h2>
<section id="exports-imports-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exports-imports-analysis">Exports &amp; Imports Analysis</h3>
<p>Turkey has experienced a consistent upward trajectory in both exports and imports from 2002 to 2020, as measured in USD values, influenced by factors such as global crisis, commodity shocks and changes in macroeconomic policies and currency exchange rates. After the 2001 crisis, Turkey changed its monetary policy and floating exchange rate application which significantly changed Turkey’s trade dynamics<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. A notable slowdown in total trade values occurred in 2009, coinciding with the global financial crisis of 2008 when total trade deficit of Turkey was at $39 billion. In this period, EU market which receives almost 50 percent of Turkey’s exports went through rapid contraction and the efforts to change the destination of exports toward Middle East and North Africa markets could not compensate for the loss<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Between 2011 and 2014, Turkey witnessed an expansion in its foreign trade deficit, which then started to decrease from 2015 until 2020, except for a notable spike in 2017. During this period, Turkey’s foreign trade deficit narrowed to $63 billion in 2015 from $85 billion in 2014 and $100 billion in 2013.</p>
<p>The decrease in oil prices and downward trend in commodity prices was contributed to the reduction of Turkey’s foreign trade deficit in 2015. According to a study<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, intermediate goods trade deficit in Turkey’s economy is about twice the size of the total trade deficit and oil price shocks have more permanent and effective impact on the intermediate goods trade balance. Turkey’s dependency on intermediate goods will be presented in detail in the upcoming sections. On the other hand, the decline in 2015 can be attributed to the implementation of quantitative easing in Europe, implemented after European debt crisis and recession, leading to an increased money supply in the region and devalued EUR against USD.</p>
<p>EU and G20 countries have always been as a crucial economic partner for Turkey and euro-dollar parity plays a significant role in affecting Turkey’s trade values. The head of the Exporters’ Assembly of Turkey (TİM) during that period stated that, despite an increase in export amounts, the adverse impact of the euro-dollar parity amounted to ~$750 million on exports in the first 11 months of 2015.</p>
<p>Spike in 2017 can be attributed to increase in energy bills due to higher oil prices. Subsequently, the impact of non-monetary gold imports and exports began to play a significant role in trade statistics. Slowdown in economic activity, stemming from the currency crisis in August 2018, played a significant role on narrowing foreign deficit in 2019. Weakening economic activity on a global scale due to pandemic in 2020 have resulted in lower exports compared to imports, that resulted in wider foreign trade deficit.</p>
<p>We will delve deeper into the yearly dynamics and extend our analysis by examining product categories and trade partners.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>total_exports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_exports =</span> <span class="fu">sum</span>(trade_value_usd_exp))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>total_imports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_imports =</span> <span class="fu">sum</span>(trade_value_usd_imp))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize exports and imports over the years</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_exports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_exports, <span class="at">color =</span> <span class="st">"Exports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_imports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_imports, <span class="at">color =</span> <span class="st">"Imports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Turkey's Exports and Imports Over the Years"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Trade Value (USD)"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total trade for each year</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>yearly_trade <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year)) </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total export and import for each year</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>yearly_trade_net <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the net difference</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>yearly_trade_net <span class="ot">&lt;-</span> yearly_trade_net  <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)<span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export by year</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> yearly_trade_net, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span> ) <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> trade_difference, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference))),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Net Trade Position of Turkey"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"Import"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"skyblue3"</span>, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Net importer"</span>, <span class="st">"Export"</span>, <span class="st">"Import"</span>)) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="top-export-product-categories" class="level4">
<h4 class="anchored" data-anchor-id="top-export-product-categories">Top Export Product Categories</h4>
<p>Turkey’s annual export revenue on average throughout the analysis period is ~125bn USD.</p>
<p>Turkey’s top 10 export revenues constitute 89% of total export income.</p>
<p>Textiles and apparel, machinery and equipment, vehicles and associated equipment as well as base metals and mineral products are the significant contributors to Turkey’s export revenue.</p>
<p>Findings from a study conducted by the TIM<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, which defines the top 1000 exports, align with our observations. Prominent exporter companies in Turkey are engaged in the export of vehicles and spare parts, home appliances, and the export of base metals and mineral products. Examples include engine manufacturers and auto-makers, Ford Otosan, Toyota, Oyak-Renault, foreign trade company Kibar, major home appliances producers Vestel and Arcelik, automaker and energy firms Tupras and Socar. The study also highlights the presence of textile manufacturers on the list, although they may not be top-rated, indicating a higher number of companies in this category compared to others in Turkey.</p>
<p>In the second chart, the initial decline in export values across all product categories aligns with the 2008 crisis. Upon examining the yearly patterns of each product category, it becomes evident that vegetable products, plastics, and foodstuffs stand out as the most resilient to external factors, showcasing inelastic demand and maintaining their resilience against macroeconomic events. Peak in vegetable exports occurred in 2020 during the entire analysis period.</p>
<p>Following its peaks in 2012 and 2013, a notable decrease in the exports of natural and mineral products occurred after 2015. This decline can be attributed largely to China’s reduction in incentives within the construction industry, as being Turkey’s top export partner in this product category<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>In 2020, a downward trend was noted in almost every product category with the weakening economic activity on a global scale due to pandemic, except the resilient ones mentioned earlier. The highest point in vegetable exports occurred in 2020 during the entire analysis period.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">19000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 50 characters</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>export_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(export_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(export_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> export_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_export), <span class="at">y =</span> total_export, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>,<span class="fu">round</span>(total_export), <span class="st">"bn"</span>),<span class="at">y =</span> total_export <span class="sc">-</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add values above the columns</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Exported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Annual Export Value"</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>top_exports_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">9</span>)<span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>top_exports_products <span class="ot">&lt;-</span> top_exports_products <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Prepared foodstuffs,"</span>) <span class="sc">~</span> <span class="st">"Foodstuffs and Tobacco"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_edit <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners<span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Prepared foodstuffs,"</span>) <span class="sc">~</span> <span class="st">"Foodstuffs and Tobacco"</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top import products</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_edit <span class="sc">%&gt;%</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_exports_products<span class="sc">$</span>section_name)<span class="sc">%&gt;%</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> export_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_export<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">color =</span> section_name)) <span class="sc">+</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>section_name, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Export Trends of Top Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual Export Value (mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="top-import-product-categories" class="level4">
<h4 class="anchored" data-anchor-id="top-import-product-categories">Top Import Product Categories</h4>
<p>Turkey’s import value on average throughout the analysis period is ~183 bn USD.</p>
<p>Turkey’s top 10 import value constitute 81% of total imports.</p>
<p>Machinery and equipment, base metals and their articles, mineral products, chemicals as well as vehicles and associated equipment constitute the primary import categories contributing to Turkey’s import value. There is a substantial import of investment goods, components and parts, along with unprocessed materials used in industrial activities. Sectors with the highest import requirements are the ones with higher capital and technology intensity<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> .This highlights Turkey’s dependence on a significant influx of intermediate goods.</p>
<p>Uncategorized value, labelled as NA has an average of $21 billion of import bill throughout the analysis period, fills a gap in this analysis that we haven’t touched upon, which is the energy dependency of Turkey. Between 2002 and 2020, Turkey’s average energy bill, as reported by the Turkish Statistical Institute in the Foreign Trade Indicators, amounts to $31 billion. This constitutes 17% of Turkey’s total imports, playing a significant role in driving the economy.</p>
<p>Second chart also proves that Turkey’s exports are concentrated in the sectors where the use of imported inputs has expanded during the past two decade.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> The third chart explicitly highlights Turkey’s import dependency, underscoring the critical need to enhance local input production. This transition is crucial in order to position Turkey with its price advantage (undervalued TL), boost export profitability and enhance its competitiveness in the international market.</p>
<p>Based on these observations, there is a need for a strategic focus on R&amp;D investments and incentives for a highly skilled workforce. This is crucial for adoption of a new economic model, which Turkey could leverage to reduce its reliance on intermediate goods.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>imported_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>imported_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(imported_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(imported_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> imported_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_import), <span class="at">y =</span> total_import, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>,<span class="fu">round</span>(total_import), <span class="st">"bn"</span>),<span class="at">y =</span> total_import<span class="sc">-</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add values above the columns </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Imported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Annual Import Value"</span>) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>top_import_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>top_import_products <span class="ot">&lt;-</span> top_import_products <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_edit <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners<span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top import products</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>import_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_edit <span class="sc">%&gt;%</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_import_products<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> import_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_import<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">color =</span> section_name)) <span class="sc">+</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>section_name, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import Trends of Top 9 Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Import Value"</span>) <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total trade for each section</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_trade</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total export and import for each top partner</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> sections<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export <span class="sc">+</span> total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_import</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the net difference</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> top_sections <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)<span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> top_sections <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name,  <span class="st">"^Textile and textile articles"</span>) <span class="sc">~</span><span class="st">"Textiles"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name,  <span class="st">"^Vegetable Products"</span>) <span class="sc">~</span><span class="st">"Vegetables"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name,  <span class="st">"^Prepared foodstuffs"</span>) <span class="sc">~</span><span class="st">"Foodstuffs and Beverages"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export relations with top trading partners</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_sections, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_export <span class="sc">-</span> total_import))) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span> ) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> trade_difference<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference<span class="sc">/</span><span class="fl">1e6</span>))),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Foreign Trade Surplus/Deficit by Top 10 Products"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"Import"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"skyblue3"</span>, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net importer"</span>, <span class="st">"Turkey net exporter"</span>, <span class="st">"Export"</span>, <span class="st">"Import"</span>)) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="trade-partnership-analysis" class="level3">
<h3 class="anchored" data-anchor-id="trade-partnership-analysis">Trade Partnership Analysis</h3>
<section id="diversification-of-export-revenue-streams-by-top-10-product-category" class="level4">
<h4 class="anchored" data-anchor-id="diversification-of-export-revenue-streams-by-top-10-product-category">Diversification of Export Revenue Streams by Top 10 Product Category</h4>
<p>Ensuring a broad range of diverse trade partners is crucial for any country in order to diversify its export and import streams and serves as a risk mitigation strategy, particularly in the face of any possible geopolitical challenges.</p>
<p>We have identified that Turkey engages with more than 200 distinct export partners across its top 10 product categories, showcasing a diversified revenue stream. As previously noted in the above sections, Textiles and Apparel, Vehicles and Associated Equipment and Base Metals and Mineral Products stand out as significant contributors to Turkey’s export revenue.</p>
<p>In the last five years, leading revenue contributor, textiles has shown a stagnant trend. Meanwhile, revenue generated from second and third highest sources, namely vehicles and equipment and base metals have been declining during this period. Conversely, Mineral Products, Miscellaneous Manufactured Articles, Vegetable Products and Plastics demonstrated an increased capacity for revenue generation albeit still trailing behind the primary product categories mentioned earlier.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export)) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_exp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_exp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_exp_avg=</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">19000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">35</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_exp_avg, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_avg), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_avg) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Export Partner and Revenue Growth Analysis for Top 10 Product Categories"</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Export Countries"</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Annual Export Revenue mn USD "</span>,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme</span>(</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"left"</span>,  </span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,   </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)  </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>*Each bubble represents 5 year CAGR (2015-2020) for each product category</em></p>
</section>
<section id="diversification-of-import-revenue-streams-by-top-10-product-category" class="level4">
<h4 class="anchored" data-anchor-id="diversification-of-import-revenue-streams-by-top-10-product-category">Diversification of Import Revenue Streams by Top 10 Product Category</h4>
<p>Through this analysis, we have identified that Turkey’s dependency is diversified and country engages with more than 200 distinct import partners across its top 10 product categories, excluding natural product categories (mostly composed of semi-precious products, stones and powder).</p>
<p>In the last five years, import stream from machinery and mechanical appliances have been declining which has the highest contribution to import value of Turkey and has the highest distinct number of trading partners. Meanwhile, import values of vehicles and equipment and chemicals were flat during this period. Conversely, plastics demonstrated a substantial increased import value over the last five years. After China banned plastic waste imports, Turkey became one of the world’s primary destinations for the global plastic waste trade.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_imp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_imp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_imp_avg =</span> <span class="fu">sum</span>(trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 50 characters</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_imp_avg, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_avg), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_avg) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import Partner and Revenue Growth Analysis for Top 10 Product Categories"</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Import Countries"</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Annual Import Revenue mn USD"</span>,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme</span>(</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"left"</span>,  </span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,   </span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)  </span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>*Each bubble represents 5 year CAGR (2015-2020) for each product category</em></p>
</section>
<section id="top-10-trading-partners" class="level4">
<h4 class="anchored" data-anchor-id="top-10-trading-partners">Top 10 Trading Partners</h4>
<p>Top 10 trade partners’ trade value (total exports+imports) with Turkey throughout the analysis period constitute 51% of total trade value.</p>
<p>Turkey has strong relations with neighboring countries - close relations with Germany and Italy - followed by major economies such as China, USA and Russia.</p>
<p>Germany ranked as the number one destination for Turkey, having solidified the roots of the relationship between the two countries during postwar economic boom. This connection further expanded after the establishment of the Customs Union.</p>
<p>Since 1991, Turkey and Russia, as countries with a shared maritime border, have been enhancing their trade cooperation. Russia has emerged as a significant supplier of energy sources to Turkey, while in return, Turkey offers extensive tourism and construction services<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.&nbsp;</p>
<p>Introduction of Belt &amp; Road Initiative which was introduced by China in 2013, is a multinational effort to revive Silk Road and carry out trade through Far East Asia and Europe, with feeding different continents and countries along the way<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>.Turkey plays a strategic role due to its close proximity to both Asia and Europe. Being a signatory of this initiative and strong bilateral relationships with China further enhances its strategic position.</p>
<p>Turkey predominantly maintains a net importer position among its major trading partners, with the exceptions of the United Kingdom and Iraq on an aggregate level throughout the analysis period, as exhibited in the second chart. Notably, Turkey shows a higher dependency on Russia and China compared to other partners.</p>
<p>The third chart provides a clearer understanding of Turkey’s position for each year during the analysis period. Turkey has transitioned from a net importer to a net exporter for some European countries, such as Spain and France.</p>
<p>Fourth chart presents a better understanding of the partners with whom Turkey has strengthened its relations the most. Trade relations with Iraq, special categories that are not well described in the dataset, USA and Spain have seen increased growth in trade values over the last 5 years. In contrast, relations with Germany, France, and the UK have remained relatively flat.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a color palette from RColorBrewer</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>partner_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(top_partners<span class="sc">$</span>partner_name), <span class="st">"Set3"</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize top trading partners</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_trade), <span class="at">y =</span> total_trade, <span class="at">fill =</span> partner_name)) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>,<span class="fu">round</span>(total_trade), <span class="st">"bn"</span>),<span class="at">y =</span> total_trade<span class="sc">-</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add values above the columns</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Trading Partners (2002-2022)"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Annual Trade Value"</span>) <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> partner_colors)<span class="sc">+</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Above chart does not represent net trading value and Turkey’s trading position. Trading values are calculated by summing up total export and import values for each year and results indicate average values during analysis period.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total trade for each partner</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total export and import for each top partner</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> partners<span class="sc">$</span>partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export <span class="sc">+</span> total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the net difference</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> top_partners <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)<span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export relations with top trading partners</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_export <span class="sc">-</span> total_import))) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span> ) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> trade_difference<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference<span class="sc">/</span><span class="fl">1e6</span>))),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Foreign Trade Surplus/Deficit by Top 10 Partners"</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"Import"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"skyblue3"</span>, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net importer"</span>, <span class="st">"Turkey net exporter"</span>, <span class="st">"Export"</span>, <span class="st">"Import"</span>)) <span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of countries to filter</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>selected_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Germany"</span>, <span class="st">"Russian Federation"</span>, <span class="st">"China"</span>, <span class="st">"Italy"</span>, <span class="st">"USA"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Iran"</span>, <span class="st">"Iraq"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> selected_countries, year <span class="sc">%in%</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name, year) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot to show trade comparison with selected trading partners</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>trade_difference), <span class="at">y =</span> trade_difference<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference)))) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">height =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Adjust the 'height' parameter</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightcoral"</span>, <span class="st">"skyblue3"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net importer"</span>, <span class="st">"Turkey net exporter"</span>)) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trade Comparison with Top 10 Trading Partners(2015-2020)"</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Trade Difference (Export - Import, mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "YourFirstYear" and "YourEndYear" with the actual years that is selected for the analysis</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>first_year <span class="ot">&lt;-</span> <span class="dv">2015</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>end_year <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total trade value for the first and end years for each partner</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>total_trade_by_partner <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_trade_first =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> first_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> first_year]),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_trade_end =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> end_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> end_year]))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the top 10 partners based on the total trade value</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>top_10_partners <span class="ot">&lt;-</span> total_trade_by_partner <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, <span class="at">wt =</span> total_trade_end)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>percentage_change <span class="ot">&lt;-</span> top_10_partners <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">percentage_change =</span> ((total_trade_end<span class="sc">/</span>total_trade_first)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a lollipop chart</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(percentage_change, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">y =</span> percentage_change)) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"skyblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Partners: 5 year CAGR growth in Total Trade Value by 2020"</span>,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"5 year CAGR growth in Total Trade Value"</span>) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="trade-partner-analysis-by-product-categories" class="level4">
<h4 class="anchored" data-anchor-id="trade-partner-analysis-by-product-categories">Trade Partner Analysis by Product Categories</h4>
<p>Major export partners of Turkey imported textile and its articles which are followed by vehicles, aircraft and machinery and mechanical components from Turkey. Turkey collaborates with Germany, Spain, and the UK in the defense industry, maintaining its relationship through NATO as well.</p>
<p>Export product categories do not vary significantly among the top export partners, except for China, which notably imports mineral products the most. According to a study, Turkey’s mineral exports are moderately concentrated and this concentration is mainly caused by excessive mineral exports to China<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p>Turkey’s major import partners are Russia, Germany and China as previously noted and exhibited in the second chart. Turkey’s energy dependency to Russia and Iran of which are major natural gas, crude and mineral suppliers of Turkey. Turkey decreased its trading volume with Iran after USA urged Turkey to impose sanction in 2012 and 2018. Crude supplies were terminated in 2018 accordingly. Examining Turkey’s major imports, it becomes evident that China and Germany play pivotal roles, particularly in the supply of machinery and mechanical components vital for industrial processes. Conversely, Turkey exhibits minimal dependency on textile and vegetable imports, reflecting its advantageous position as a net exporter in these product categories.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Iraq, Spain, and USA</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners<span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Germany"</span>,<span class="st">"Russian Federation"</span>,<span class="st">"China"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Iraq"</span>, <span class="st">"Spain"</span>, <span class="st">"USA"</span>,<span class="st">"Iran"</span>, <span class="dv">1</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for total trade</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners <span class="ot">&lt;-</span> trade_data_selected_partners<span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_exp =</span> (trade_value_usd_exp)<span class="sc">/</span><span class="dv">19000000</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by section_name and calculate total trade values for each section_name</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>total_trade_values_19_year <span class="ot">&lt;-</span> trade_data_selected_partners <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2002</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name, partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_exp_value =</span> <span class="fu">sum</span>(total_trade_exp))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter top 5 section names</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data <span class="ot">&lt;-</span> total_trade_values_19_year <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_exp_value)) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_commodity_data<span class="sc">$</span>section_name, <span class="dv">25</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the color palette</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name)), <span class="st">"Set3"</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Map colors to truncated section names</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">setNames</span>(colors, <span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the color_mapping in ggplot</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_commodity_data, <span class="fu">aes</span>(<span class="at">x =</span> partner_name, <span class="at">y =</span> total_exp_value, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_mapping) <span class="sc">+</span>  <span class="co"># Set manual color scale</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Annual Export Breakdown by Product Category and Partner (2002-2020)"</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner Name"</span>, <span class="at">y =</span> <span class="st">"Total Export mn USD"</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sections"</span>) <span class="sc">+</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Iraq, Spain, and USA</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners<span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Germany"</span>,<span class="st">"Russian Federation"</span>,<span class="st">"China"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Iraq"</span>, <span class="st">"Spain"</span>, <span class="st">"USA"</span>,<span class="st">"Iran"</span>, <span class="dv">1</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for total trade</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners <span class="ot">&lt;-</span> trade_data_selected_partners<span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_imp =</span> (trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by section_name and calculate total trade values for each section_name</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>total_trade_values_19_year <span class="ot">&lt;-</span> trade_data_selected_partners <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2002</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name, partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_imp_value =</span> <span class="fu">sum</span>(total_trade_imp))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter top 5 section names</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data <span class="ot">&lt;-</span> total_trade_values_19_year <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_imp_value)) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_commodity_data<span class="sc">$</span>section_name, <span class="dv">25</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the color palette</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name)), <span class="st">"Set3"</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Map colors to truncated section names</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">setNames</span>(colors, <span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name))</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the color_mapping in ggplot</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_commodity_data, <span class="fu">aes</span>(<span class="at">x =</span> partner_name, <span class="at">y =</span> total_imp_value, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_mapping) <span class="sc">+</span>  <span class="co"># Set manual color scale</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Annual Import Breakdown by Product Category and Partner (2002-2020)"</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner Name"</span>, <span class="at">y =</span> <span class="st">"Total Import mn USD"</span>,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sections"</span>) <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="finalreport_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In conclusion, over these two decades, Turkey’s exports and imports have steadily risen, influenced by global events like the financial crisis, commodity shocks and changes in macroeconomic policies. Notably, the shift in Turkey’s monetary policy after the 2001 crisis, adopting a floating exchange rate, significantly impacted trade dynamics.</p>
<p>Despite facing a persistent foreign trade deficit, Turkey has showcased its ability to navigate through economic downturns. The global financial crisis of 2008 and the recent pandemic-induced economic slowdown have left their marks, but Turkey has demonstrated its ability to adapt.</p>
<p>Examining product categories, we’ve identified sectors like textiles, machinery, and base metals as significant contributors to Turkey’s export revenue. On the import side, machinery and base metals continue to play a crucial role, highlighting Turkey’s dependence on a diverse range of intermediate goods.</p>
<p>Our analysis also delved into the country’s trade partnerships, revealing a diverse network of more than 200 export and import partners. Turkey’s strong relations with neighboring countries, especially Germany and Italy, along with major economies like China, the USA, and Russia, underscore its strategic importance in global trade.</p>
<p>The charts and trends unveiled throughout our analysis provide actionable insights for Turkey’s future trade strategies. The need to enhance local input production, reduce reliance on intermediate goods, and strategically focus on R&amp;D investments emerge as critical considerations for sustaining economic growth. Our analysis serves as a practical guide for informed decision-making, offering valuable lessons for other nations seeking to fortify their economic development.</p>
</section>
<section id="shiny-app-link" class="level2">
<h2 class="anchored" data-anchor-id="shiny-app-link">Shiny App Link</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">"pjournal/mef07g-yellowsubmarine"</span>, <span class="at">subdir =</span> <span class="st">"/app/app.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="https://sezerlucianturkmen.shinyapps.io/yellowsubmarine/">Shiny App Link is here.</a></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p><a href="https://wits.worldbank.org/"><em>World Integrated Trade Solution (World Bank)</em></a></p>
<p><a href="https://docs.ropensci.org/tradestatistics/articles/basic-usage.html"><em>Dataset</em></a></p>


<!-- -->

</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><a href="https://www.researchgate.net/publication/360681170_DEVELOPMENT_OF_INTERNATIONAL_TRADE_IN_TURKEY_TRENDS_AND_CHANGES">Development of International Trade in Turkey: Trends and Changes</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://www.tepav.org.tr/upload/files/1281006927-9.Trade_and_Trade_Finance_in_Turkey___Impact_of_Financial_Problems_in_the_Decrease_in_Exports.pdf">Trade and Trade Finance in Turkey: What is the Impact of the Finance Problems in the Decrease in Exports?</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://dergipark.org.tr/en/download/article-file/2268094">The Analysis of Turkey’s Trade Balance in response to oil price changes</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://tim.org.tr/en/default">Exporters’ Assemby of Turkey</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="https://dergipark.org.tr/tr/download/article-file/1950234">Effects of the Covid-19 Pandemic on Turkish Natural Stone Industry</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>[Import Content of Turkish Production and Exports: A sectoral analysis](<a href="https://www.sciencedirect.com/science/article/pii/S1303070120300275#fig1" class="uri">https://www.sciencedirect.com/science/article/pii/S1303070120300275#fig1</a>)<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>[Import Content of Turkish Production and Exports: A sectoral analysis](<a href="https://www.sciencedirect.com/science/article/pii/S1303070120300275#fig1" class="uri">https://www.sciencedirect.com/science/article/pii/S1303070120300275#fig1</a>)<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>[Why Turkey should not import plastic waste pollution from developed countries?] (<a href="https://www.sciencedirect.com/science/article/abs/pii/S0025326X21008067" class="uri">https://www.sciencedirect.com/science/article/abs/pii/S0025326X21008067</a>)<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>An Analysis of Bilateral Trade Relation Between Turkey and Russia, Marina Kramskova, Dokuz Eylul University, 2022<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>[International Trade between Turkey and China] (<a href="https://dergipark.org.tr/tr/download/article-file/2939520" class="uri">https://dergipark.org.tr/tr/download/article-file/2939520</a>)<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0301420721004062?via%3Dihub">Contribution and/or dependency: Chinese hegemony on Turkey’s mineral export</a><a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./exploratorydataanalysis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assignment1.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Assignment 1</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb21" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> " Final Reports"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Group Yellow Submarine"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-01-04"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: false</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Takeways</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For the analysis period which is between 2002 and 2020, Turkey kept its net importer position in majority of the product categories that are primarily used as an intermediary in goods.</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Turkey's dependence on energy and natural resources is concentrated, posing a significant risk if relations with Russia and Iran were to deteriorate. A similar vulnerability is observed in machinery and mechanical components, suggesting the need for diversification or incentives to encourage local production.</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Turkey has close relations with Europe, taking advantage of being a signatory of custom union with the EU. On the contrary; the exposure to Europe, as evidenced in the EDA, underscores a category risk for Turkey. Economic downturns or recessions in Europe significantly impact Turkey's exports and imports.</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>While Turkey boasts more than 200 trading partners for both exports and imports, the high revenue-generating product categories lack diversification. Most of the top 10 product categories show stagnant or declining growth in USD values. This signals the importance of exploring new markets and expanding the product portfolio to mitigate risks associated with concentrated trade.</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>As the main outcome; this EDA reveals Turkey's heavy reliance on intermediate goods and a relatively lower emphasis on strategic investments in R&amp;D and incentives for a skilled workforce, pointing out a necessity of adopting a new economic model, which encourages innovation, reduces dependence on intermediates, increasing diversification of trade partners and ensures a more sustainable and resilient trade ecosystem.</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>Our group project, "Turkey Analysis: Trade Balance &amp; Partners" delves into the details of Turkey's international trade landscape from 2002 to 2020.</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>Utilizing the data aggregation capabilities of WITS, our analysis covers Turkey's export &amp; import dynamics and its relations with trade partners during this significant period. The data, sourced from a package developed by a team led by Mauricio Vargas provides a comprehensive overview of Turkey's trade dynamics.</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>Throughout our analysis, we uncovered key findings that include the consistent upward trajectory of Turkey's exports and imports, the influence of global events such as the financial crisis and the impact of monetary policies and currency fluctuations. Notably, Turkey has maintained a persistent foreign trade deficit, with fluctuations and intriguing trends observed in different years.</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>Our exploration extends to product categories, revealing that certain sectors, like textiles and machinery, significantly contribute to Turkey's export revenue. On the import side, machinery and base metals play a crucial role. We also delve into the trends of these categories over the years, identifying fluctuations and their potential drivers.</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>Additionally, our analysis scrutinizes Turkey's trade partnerships, highlighting the country's diverse range of trading allies. We examine the top trading partners, Turkey's net exporter/importer positions, and the evolution of trade relations over the last five years.</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outcomes</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include = FALSE}</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary Libraries</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="co">#In order to solve conflicts in different packages, we additionally loaded conflicted package to set our preference as dplyr</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"lag"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>loaded_datasets <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"wits_data.rds"</span>)</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_only <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_turkey_data_only</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_turkey_data_with_partners</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE, message=FALSE,warning=FALSE}</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(read_wits_turkey_data_only, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(read_wits_turkey_data_with_partners, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exports &amp; Imports Analysis</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>Turkey has experienced a consistent upward trajectory in both exports and imports from 2002 to 2020, as measured in USD values, influenced by factors such as global crisis, commodity shocks and changes in macroeconomic policies and currency exchange rates. After the 2001 crisis, Turkey changed its monetary policy and floating exchange rate application which significantly changed Turkey's trade dynamics<span class="ot">[^1]</span>. A notable slowdown in total trade values occurred in 2009, coinciding with the global financial crisis of 2008 when total trade deficit of Turkey was at \$39 billion. In this period, EU market which receives almost 50 percent of Turkey’s exports went through rapid contraction and the efforts to change the destination of exports toward Middle East and North Africa markets could not compensate for the loss<span class="ot">[^2]</span>. Between 2011 and 2014, Turkey witnessed an expansion in its foreign trade deficit, which then started to decrease from 2015 until 2020, except for a notable spike in 2017. During this period, Turkey's foreign trade deficit narrowed to \$63 billion in 2015 from \$85 billion in 2014 and \$100 billion in 2013.</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span><span class="co">[</span><span class="ot">Development of International Trade in Turkey: Trends and Changes</span><span class="co">](https://www.researchgate.net/publication/360681170_DEVELOPMENT_OF_INTERNATIONAL_TRADE_IN_TURKEY_TRENDS_AND_CHANGES)</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span><span class="co">[</span><span class="ot">Trade and Trade Finance in Turkey: What is the Impact of the Finance Problems in the Decrease in Exports?</span><span class="co">](https://www.tepav.org.tr/upload/files/1281006927-9.Trade_and_Trade_Finance_in_Turkey___Impact_of_Financial_Problems_in_the_Decrease_in_Exports.pdf)</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>The decrease in oil prices and downward trend in commodity prices was contributed to the reduction of Turkey's foreign trade deficit in 2015. According to a study<span class="ot">[^3]</span>, intermediate goods trade deficit in Turkey's economy is about twice the size of the total trade deficit and oil price shocks have more permanent and effective impact on the intermediate goods trade balance. Turkey's dependency on intermediate goods will be presented in detail in the upcoming sections. On the other hand, the decline in 2015 can be attributed to the implementation of quantitative easing in Europe, implemented after European debt crisis and recession, leading to an increased money supply in the region and devalued EUR against USD.</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span><span class="co">[</span><span class="ot">The Analysis of Turkey’s Trade Balance in response to oil price changes</span><span class="co">](https://dergipark.org.tr/en/download/article-file/2268094)</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>EU and G20 countries have always been as a crucial economic partner for Turkey and euro-dollar parity plays a significant role in affecting Turkey's trade values. The head of the Exporters' Assembly of Turkey (TİM) during that period stated that, despite an increase in export amounts, the adverse impact of the euro-dollar parity amounted to \~\$750 million on exports in the first 11 months of 2015.</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>Spike in 2017 can be attributed to increase in energy bills due to higher oil prices. Subsequently, the impact of non-monetary gold imports and exports began to play a significant role in trade statistics. Slowdown in economic activity, stemming from the currency crisis in August 2018, played a significant role on narrowing foreign deficit in 2019. Weakening economic activity on a global scale due to pandemic in 2020 have resulted in lower exports compared to imports, that resulted in wider foreign trade deficit.</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>We will delve deeper into the yearly dynamics and extend our analysis by examining product categories and trade partners.</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>total_exports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_exports =</span> <span class="fu">sum</span>(trade_value_usd_exp))</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>total_imports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_imports =</span> <span class="fu">sum</span>(trade_value_usd_imp))</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize exports and imports over the years</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_exports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_exports, <span class="at">color =</span> <span class="st">"Exports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_imports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_imports, <span class="at">color =</span> <span class="st">"Imports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Turkey's Exports and Imports Over the Years"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Trade Value (USD)"</span></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total trade for each year</span></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>yearly_trade <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year)) </span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total export and import for each year</span></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>yearly_trade_net <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year))</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the net difference</span></span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>yearly_trade_net <span class="ot">&lt;-</span> yearly_trade_net  <span class="sc">%&gt;%</span></span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)<span class="sc">%&gt;%</span></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export by year</span></span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> yearly_trade_net, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span> ) <span class="sc">+</span></span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> trade_difference, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference))),</span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Net Trade Position of Turkey"</span>,</span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"Import"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>,</span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"skyblue3"</span>, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Net importer"</span>, <span class="st">"Export"</span>, <span class="st">"Import"</span>)) <span class="sc">+</span></span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top Export Product Categories</span></span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>Turkey's annual export revenue on average throughout the analysis period is \~125bn USD.</span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>Turkey's top 10 export revenues constitute 89% of total export income.</span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>Textiles and apparel, machinery and equipment, vehicles and associated equipment as well as base metals and mineral products are the significant contributors to Turkey's export revenue.</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>Findings from a study conducted by the TIM<span class="ot">[^4]</span>, which defines the top 1000 exports, align with our observations. Prominent exporter companies in Turkey are engaged in the export of vehicles and spare parts, home appliances, and the export of base metals and mineral products. Examples include engine manufacturers and auto-makers, Ford Otosan, Toyota, Oyak-Renault, foreign trade company Kibar, major home appliances producers Vestel and Arcelik, automaker and energy firms Tupras and Socar. The study also highlights the presence of textile manufacturers on the list, although they may not be top-rated, indicating a higher number of companies in this category compared to others in Turkey.</span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span><span class="co">[</span><span class="ot">Exporters' Assemby of Turkey</span><span class="co">](https://tim.org.tr/en/default)</span></span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>In the second chart, the initial decline in export values across all product categories aligns with the 2008 crisis. Upon examining the yearly patterns of each product category, it becomes evident that vegetable products, plastics, and foodstuffs stand out as the most resilient to external factors, showcasing inelastic demand and maintaining their resilience against macroeconomic events. Peak in vegetable exports occurred in 2020 during the entire analysis period.</span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a>Following its peaks in 2012 and 2013, a notable decrease in the exports of natural and mineral products occurred after 2015. This decline can be attributed largely to China's reduction in incentives within the construction industry, as being Turkey's top export partner in this product category<span class="ot">[^5]</span>.</span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span><span class="co">[</span><span class="ot">Effects of the Covid-19 Pandemic on Turkish Natural Stone Industry</span><span class="co">](https://dergipark.org.tr/tr/download/article-file/1950234)</span></span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>In 2020, a downward trend was noted in almost every product category with the weakening economic activity on a global scale due to pandemic, except the resilient ones mentioned earlier. The highest point in vegetable exports occurred in 2020 during the entire analysis period.</span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">19000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 50 characters</span></span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>export_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(export_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(export_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> export_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_export), <span class="at">y =</span> total_export, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>,<span class="fu">round</span>(total_export), <span class="st">"bn"</span>),<span class="at">y =</span> total_export <span class="sc">-</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add values above the columns</span></span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Exported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Annual Export Value"</span>) <span class="sc">+</span></span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a>top_exports_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">19</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">9</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a>top_exports_products <span class="ot">&lt;-</span> top_exports_products <span class="sc">%&gt;%</span> </span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Prepared foodstuffs,"</span>) <span class="sc">~</span> <span class="st">"Foodstuffs and Tobacco"</span>,</span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_edit <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners<span class="sc">%&gt;%</span> </span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Prepared foodstuffs,"</span>) <span class="sc">~</span> <span class="st">"Foodstuffs and Tobacco"</span>,</span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top import products</span></span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_edit <span class="sc">%&gt;%</span></span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_exports_products<span class="sc">$</span>section_name)<span class="sc">%&gt;%</span></span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> export_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_export<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">color =</span> section_name)) <span class="sc">+</span></span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>section_name, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Export Trends of Top Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Annual Export Value (mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend</span></span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top Import Product Categories</span></span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a>Turkey's import value on average throughout the analysis period is \~183 bn USD.</span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a>Turkey's top 10 import value constitute 81% of total imports.</span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a>Machinery and equipment, base metals and their articles, mineral products, chemicals as well as vehicles and associated equipment constitute the primary import categories contributing to Turkey's import value. There is a substantial import of investment goods, components and parts, along with unprocessed materials used in industrial activities. Sectors with the highest import requirements are the ones with higher capital and technology intensity<span class="ot">[^6]</span> .This highlights Turkey's dependence on a significant influx of intermediate goods.</span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span><span class="sc">\[</span>Import Content of Turkish Production and Exports: A sectoral analysis<span class="sc">\]</span>(<span class="ot">&lt;https://www.sciencedirect.com/science/article/pii/S1303070120300275#fig1&gt;</span>)</span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a>Uncategorized value, labelled as NA has an average of \$21 billion of import bill throughout the analysis period, fills a gap in this analysis that we haven't touched upon, which is the energy dependency of Turkey. Between 2002 and 2020, Turkey's average energy bill, as reported by the Turkish Statistical Institute in the Foreign Trade Indicators, amounts to \$31 billion. This constitutes 17% of Turkey's total imports, playing a significant role in driving the economy.</span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a>Second chart also proves that Turkey’s exports are concentrated in the sectors where the use of imported inputs has expanded during the past two decade.<span class="ot">[^7]</span> The third chart explicitly highlights Turkey's import dependency, underscoring the critical need to enhance local input production. This transition is crucial in order to position Turkey with its price advantage (undervalued TL), boost export profitability and enhance its competitiveness in the international market.</span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span><span class="sc">\[</span>Import Content of Turkish Production and Exports: A sectoral analysis<span class="sc">\]</span>(<span class="ot">&lt;https://www.sciencedirect.com/science/article/pii/S1303070120300275#fig1&gt;</span>)</span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a>Based on these observations, there is a need for a strategic focus on R&amp;D investments and incentives for a highly skilled workforce. This is crucial for adoption of a new economic model, which Turkey could leverage to reduce its reliance on intermediate goods.</span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a>imported_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-266"><a href="#cb21-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb21-267"><a href="#cb21-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a>imported_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(imported_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(imported_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> imported_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_import), <span class="at">y =</span> total_import, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>,<span class="fu">round</span>(total_import), <span class="st">"bn"</span>),<span class="at">y =</span> total_import<span class="sc">-</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add values above the columns </span></span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Imported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Annual Import Value"</span>) <span class="sc">+</span></span>
<span id="cb21-281"><a href="#cb21-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-282"><a href="#cb21-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE}</span></span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>top_import_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>top_import_products <span class="ot">&lt;-</span> top_import_products <span class="sc">%&gt;%</span> </span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-307"><a href="#cb21-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-308"><a href="#cb21-308" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_edit <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners<span class="sc">%&gt;%</span> </span>
<span id="cb21-309"><a href="#cb21-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-310"><a href="#cb21-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top import products</span></span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a>import_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_edit <span class="sc">%&gt;%</span></span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_import_products<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-324"><a href="#cb21-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-325"><a href="#cb21-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-326"><a href="#cb21-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  </span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> import_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_import<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">color =</span> section_name)) <span class="sc">+</span></span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>section_name, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="cn">NULL</span>)) <span class="sc">+</span></span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import Trends of Top 9 Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Import Value"</span>) <span class="sc">+</span></span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend</span></span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-339"><a href="#cb21-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total trade for each section</span></span>
<span id="cb21-340"><a href="#cb21-340" aria-hidden="true" tabindex="-1"></a>sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-341"><a href="#cb21-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-342"><a href="#cb21-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-343"><a href="#cb21-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb21-344"><a href="#cb21-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb21-345"><a href="#cb21-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-346"><a href="#cb21-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-347"><a href="#cb21-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total export and import for each top partner</span></span>
<span id="cb21-348"><a href="#cb21-348" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-349"><a href="#cb21-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> sections<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-350"><a href="#cb21-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-351"><a href="#cb21-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb21-352"><a href="#cb21-352" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-353"><a href="#cb21-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export <span class="sc">+</span> total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb21-354"><a href="#cb21-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-355"><a href="#cb21-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-356"><a href="#cb21-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-357"><a href="#cb21-357" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the net difference</span></span>
<span id="cb21-358"><a href="#cb21-358" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> top_sections <span class="sc">%&gt;%</span></span>
<span id="cb21-359"><a href="#cb21-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)<span class="sc">%&gt;%</span></span>
<span id="cb21-360"><a href="#cb21-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-361"><a href="#cb21-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> top_sections <span class="sc">%&gt;%</span> </span>
<span id="cb21-363"><a href="#cb21-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-364"><a href="#cb21-364" aria-hidden="true" tabindex="-1"></a>    <span class="at">section_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Machinery and mechanical appliances"</span>) <span class="sc">~</span> <span class="st">"Machinery Products"</span>,</span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Base metals"</span>) <span class="sc">~</span> <span class="st">"Base Metal Products"</span>,</span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Natural or"</span>) <span class="sc">~</span> <span class="st">"Natural Products"</span>,</span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Vehicles,"</span>) <span class="sc">~</span> <span class="st">"Vehicles Equipment"</span>,</span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Plastics and articles"</span>) <span class="sc">~</span> <span class="st">"Plastics"</span>,</span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name, <span class="st">"^Product of the chemicals"</span>) <span class="sc">~</span> <span class="st">"Chemicals"</span>,</span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name,  <span class="st">"^Textile and textile articles"</span>) <span class="sc">~</span><span class="st">"Textiles"</span>,</span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name,  <span class="st">"^Vegetable Products"</span>) <span class="sc">~</span><span class="st">"Vegetables"</span>,</span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(section_name,  <span class="st">"^Prepared foodstuffs"</span>) <span class="sc">~</span><span class="st">"Foodstuffs and Beverages"</span>,</span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(section_name)</span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export relations with top trading partners</span></span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_sections, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_export <span class="sc">-</span> total_import))) <span class="sc">+</span></span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span> ) <span class="sc">+</span></span>
<span id="cb21-381"><a href="#cb21-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-382"><a href="#cb21-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> trade_difference<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference<span class="sc">/</span><span class="fl">1e6</span>))),</span>
<span id="cb21-383"><a href="#cb21-383" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-384"><a href="#cb21-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Foreign Trade Surplus/Deficit by Top 10 Products"</span>,</span>
<span id="cb21-385"><a href="#cb21-385" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb21-386"><a href="#cb21-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"Import"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>,</span>
<span id="cb21-387"><a href="#cb21-387" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"skyblue3"</span>, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb21-388"><a href="#cb21-388" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb21-389"><a href="#cb21-389" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net importer"</span>, <span class="st">"Turkey net exporter"</span>, <span class="st">"Export"</span>, <span class="st">"Import"</span>)) <span class="sc">+</span></span>
<span id="cb21-390"><a href="#cb21-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-391"><a href="#cb21-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-392"><a href="#cb21-392" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb21-393"><a href="#cb21-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-394"><a href="#cb21-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-395"><a href="#cb21-395" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trade Partnership Analysis</span></span>
<span id="cb21-396"><a href="#cb21-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-397"><a href="#cb21-397" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diversification of Export Revenue Streams by Top 10 Product Category</span></span>
<span id="cb21-398"><a href="#cb21-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-399"><a href="#cb21-399" aria-hidden="true" tabindex="-1"></a>Ensuring a broad range of diverse trade partners is crucial for any country in order to diversify its export and import streams and serves as a risk mitigation strategy, particularly in the face of any possible geopolitical challenges.</span>
<span id="cb21-400"><a href="#cb21-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-401"><a href="#cb21-401" aria-hidden="true" tabindex="-1"></a>We have identified that Turkey engages with more than 200 distinct export partners across its top 10 product categories, showcasing a diversified revenue stream. As previously noted in the above sections, Textiles and Apparel, Vehicles and Associated Equipment and Base Metals and Mineral Products stand out as significant contributors to Turkey's export revenue.</span>
<span id="cb21-402"><a href="#cb21-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-403"><a href="#cb21-403" aria-hidden="true" tabindex="-1"></a>In the last five years, leading revenue contributor, textiles has shown a stagnant trend. Meanwhile, revenue generated from second and third highest sources, namely vehicles and equipment and base metals have been declining during this period. Conversely, Mineral Products, Miscellaneous Manufactured Articles, Vegetable Products and Plastics demonstrated an increased capacity for revenue generation albeit still trailing behind the primary product categories mentioned earlier.</span>
<span id="cb21-404"><a href="#cb21-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-405"><a href="#cb21-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-406"><a href="#cb21-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-407"><a href="#cb21-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb21-408"><a href="#cb21-408" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-409"><a href="#cb21-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-410"><a href="#cb21-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-411"><a href="#cb21-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export)) <span class="sc">%&gt;%</span></span>
<span id="cb21-412"><a href="#cb21-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb21-413"><a href="#cb21-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-414"><a href="#cb21-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb21-415"><a href="#cb21-415" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-416"><a href="#cb21-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb21-417"><a href="#cb21-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-418"><a href="#cb21-418" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb21-419"><a href="#cb21-419" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb21-420"><a href="#cb21-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-421"><a href="#cb21-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb21-422"><a href="#cb21-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-423"><a href="#cb21-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-424"><a href="#cb21-424" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb21-425"><a href="#cb21-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-426"><a href="#cb21-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_exp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_exp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-427"><a href="#cb21-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-428"><a href="#cb21-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-429"><a href="#cb21-429" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb21-430"><a href="#cb21-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-431"><a href="#cb21-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_exp_avg=</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">19000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-432"><a href="#cb21-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-433"><a href="#cb21-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-434"><a href="#cb21-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb21-435"><a href="#cb21-435" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">35</span>)</span>
<span id="cb21-436"><a href="#cb21-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-437"><a href="#cb21-437" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb21-438"><a href="#cb21-438" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb21-439"><a href="#cb21-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-440"><a href="#cb21-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-441"><a href="#cb21-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_exp_avg, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb21-442"><a href="#cb21-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-443"><a href="#cb21-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb21-444"><a href="#cb21-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_avg), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_avg) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb21-445"><a href="#cb21-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb21-446"><a href="#cb21-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb21-447"><a href="#cb21-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Export Partner and Revenue Growth Analysis for Top 10 Product Categories"</span>,</span>
<span id="cb21-448"><a href="#cb21-448" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Export Countries"</span>,</span>
<span id="cb21-449"><a href="#cb21-449" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Annual Export Revenue mn USD "</span>,</span>
<span id="cb21-450"><a href="#cb21-450" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb21-451"><a href="#cb21-451" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb21-452"><a href="#cb21-452" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme</span>(</span>
<span id="cb21-453"><a href="#cb21-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"left"</span>,  </span>
<span id="cb21-454"><a href="#cb21-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,   </span>
<span id="cb21-455"><a href="#cb21-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)  </span>
<span id="cb21-456"><a href="#cb21-456" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-457"><a href="#cb21-457" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-458"><a href="#cb21-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-459"><a href="#cb21-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-460"><a href="#cb21-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-461"><a href="#cb21-461" aria-hidden="true" tabindex="-1"></a>*\*Each bubble represents 5 year CAGR (2015-2020) for each product category*</span>
<span id="cb21-462"><a href="#cb21-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-463"><a href="#cb21-463" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diversification of Import Revenue Streams by Top 10 Product Category</span></span>
<span id="cb21-464"><a href="#cb21-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-465"><a href="#cb21-465" aria-hidden="true" tabindex="-1"></a>Through this analysis, we have identified that Turkey's dependency is diversified and country engages with more than 200 distinct import partners across its top 10 product categories, excluding natural product categories (mostly composed of semi-precious products, stones and powder).</span>
<span id="cb21-466"><a href="#cb21-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-467"><a href="#cb21-467" aria-hidden="true" tabindex="-1"></a>In the last five years, import stream from machinery and mechanical appliances have been declining which has the highest contribution to import value of Turkey and has the highest distinct number of trading partners. Meanwhile, import values of vehicles and equipment and chemicals were flat during this period. Conversely, plastics demonstrated a substantial increased import value over the last five years. After China banned plastic waste imports, Turkey became one of the world's primary destinations for the global plastic waste trade.<span class="ot">[^8]</span></span>
<span id="cb21-468"><a href="#cb21-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-469"><a href="#cb21-469" aria-hidden="true" tabindex="-1"></a><span class="ot">[^8]: </span><span class="sc">\[</span>Why Turkey should not import plastic waste pollution from developed countries?<span class="sc">\]</span> (<span class="ot">&lt;https://www.sciencedirect.com/science/article/abs/pii/S0025326X21008067&gt;</span>)</span>
<span id="cb21-470"><a href="#cb21-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-471"><a href="#cb21-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-472"><a href="#cb21-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-473"><a href="#cb21-473" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb21-474"><a href="#cb21-474" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-475"><a href="#cb21-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-476"><a href="#cb21-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-477"><a href="#cb21-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb21-478"><a href="#cb21-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb21-479"><a href="#cb21-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-480"><a href="#cb21-480" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb21-481"><a href="#cb21-481" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-482"><a href="#cb21-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb21-483"><a href="#cb21-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-484"><a href="#cb21-484" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb21-485"><a href="#cb21-485" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb21-486"><a href="#cb21-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-487"><a href="#cb21-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb21-488"><a href="#cb21-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-489"><a href="#cb21-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-490"><a href="#cb21-490" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb21-491"><a href="#cb21-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-492"><a href="#cb21-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_imp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_imp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-493"><a href="#cb21-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-494"><a href="#cb21-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-495"><a href="#cb21-495" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb21-496"><a href="#cb21-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-497"><a href="#cb21-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_imp_avg =</span> <span class="fu">sum</span>(trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-498"><a href="#cb21-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-499"><a href="#cb21-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-500"><a href="#cb21-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 50 characters</span></span>
<span id="cb21-501"><a href="#cb21-501" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb21-502"><a href="#cb21-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-503"><a href="#cb21-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb21-504"><a href="#cb21-504" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb21-505"><a href="#cb21-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-506"><a href="#cb21-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-507"><a href="#cb21-507" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_imp_avg, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb21-508"><a href="#cb21-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-509"><a href="#cb21-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb21-510"><a href="#cb21-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_avg), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_avg) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb21-511"><a href="#cb21-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb21-512"><a href="#cb21-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb21-513"><a href="#cb21-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import Partner and Revenue Growth Analysis for Top 10 Product Categories"</span>,</span>
<span id="cb21-514"><a href="#cb21-514" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Import Countries"</span>,</span>
<span id="cb21-515"><a href="#cb21-515" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Annual Import Revenue mn USD"</span>,</span>
<span id="cb21-516"><a href="#cb21-516" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb21-517"><a href="#cb21-517" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb21-518"><a href="#cb21-518" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme</span>(</span>
<span id="cb21-519"><a href="#cb21-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"left"</span>,  </span>
<span id="cb21-520"><a href="#cb21-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,   </span>
<span id="cb21-521"><a href="#cb21-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)  </span>
<span id="cb21-522"><a href="#cb21-522" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-523"><a href="#cb21-523" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-524"><a href="#cb21-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-525"><a href="#cb21-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-526"><a href="#cb21-526" aria-hidden="true" tabindex="-1"></a>*\*Each bubble represents 5 year CAGR (2015-2020) for each product category*</span>
<span id="cb21-527"><a href="#cb21-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-528"><a href="#cb21-528" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top 10 Trading Partners</span></span>
<span id="cb21-529"><a href="#cb21-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-530"><a href="#cb21-530" aria-hidden="true" tabindex="-1"></a>Top 10 trade partners' trade value (total exports+imports) with Turkey throughout the analysis period constitute 51% of total trade value.</span>
<span id="cb21-531"><a href="#cb21-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-532"><a href="#cb21-532" aria-hidden="true" tabindex="-1"></a>Turkey has strong relations with neighboring countries - close relations with Germany and Italy - followed by major economies such as China, USA and Russia.</span>
<span id="cb21-533"><a href="#cb21-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-534"><a href="#cb21-534" aria-hidden="true" tabindex="-1"></a>Germany ranked as the number one destination for Turkey, having solidified the roots of the relationship between the two countries during postwar economic boom. This connection further expanded after the establishment of the Customs Union.</span>
<span id="cb21-535"><a href="#cb21-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-536"><a href="#cb21-536" aria-hidden="true" tabindex="-1"></a>Since 1991, Turkey and Russia, as countries with a shared maritime border, have been enhancing their trade cooperation. Russia has emerged as a significant supplier of energy sources to Turkey, while in return, Turkey offers extensive tourism and construction services<span class="ot">[^9]</span>.&nbsp;</span>
<span id="cb21-537"><a href="#cb21-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-538"><a href="#cb21-538" aria-hidden="true" tabindex="-1"></a><span class="ot">[^9]: </span>An Analysis of Bilateral Trade Relation Between Turkey and Russia, Marina Kramskova, Dokuz Eylul University, 2022</span>
<span id="cb21-539"><a href="#cb21-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-540"><a href="#cb21-540" aria-hidden="true" tabindex="-1"></a>Introduction of Belt &amp; Road Initiative which was introduced by China in 2013, is a multinational effort to revive Silk Road and carry out trade through Far East Asia and Europe, with feeding different continents and countries along the way<span class="ot">[^10]</span>.Turkey plays a strategic role due to its close proximity to both Asia and Europe. Being a signatory of this initiative and strong bilateral relationships with China further enhances its strategic position.</span>
<span id="cb21-541"><a href="#cb21-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-542"><a href="#cb21-542" aria-hidden="true" tabindex="-1"></a><span class="ot">[^10]: </span><span class="sc">\[</span>International Trade between Turkey and China<span class="sc">\]</span> (<span class="ot">&lt;https://dergipark.org.tr/tr/download/article-file/2939520&gt;</span>)</span>
<span id="cb21-543"><a href="#cb21-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-544"><a href="#cb21-544" aria-hidden="true" tabindex="-1"></a>Turkey predominantly maintains a net importer position among its major trading partners, with the exceptions of the United Kingdom and Iraq on an aggregate level throughout the analysis period, as exhibited in the second chart. Notably, Turkey shows a higher dependency on Russia and China compared to other partners.</span>
<span id="cb21-545"><a href="#cb21-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-546"><a href="#cb21-546" aria-hidden="true" tabindex="-1"></a>The third chart provides a clearer understanding of Turkey's position for each year during the analysis period. Turkey has transitioned from a net importer to a net exporter for some European countries, such as Spain and France.</span>
<span id="cb21-547"><a href="#cb21-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-548"><a href="#cb21-548" aria-hidden="true" tabindex="-1"></a>Fourth chart presents a better understanding of the partners with whom Turkey has strengthened its relations the most. Trade relations with Iraq, special categories that are not well described in the dataset, USA and Spain have seen increased growth in trade values over the last 5 years. In contrast, relations with Germany, France, and the UK have remained relatively flat.</span>
<span id="cb21-549"><a href="#cb21-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-550"><a href="#cb21-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-551"><a href="#cb21-551" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-552"><a href="#cb21-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-553"><a href="#cb21-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-554"><a href="#cb21-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb21-555"><a href="#cb21-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb21-556"><a href="#cb21-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-557"><a href="#cb21-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a color palette from RColorBrewer</span></span>
<span id="cb21-558"><a href="#cb21-558" aria-hidden="true" tabindex="-1"></a>partner_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(top_partners<span class="sc">$</span>partner_name), <span class="st">"Set3"</span>)</span>
<span id="cb21-559"><a href="#cb21-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-560"><a href="#cb21-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize top trading partners</span></span>
<span id="cb21-561"><a href="#cb21-561" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_trade), <span class="at">y =</span> total_trade, <span class="at">fill =</span> partner_name)) <span class="sc">+</span></span>
<span id="cb21-562"><a href="#cb21-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-563"><a href="#cb21-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>,<span class="fu">round</span>(total_trade), <span class="st">"bn"</span>),<span class="at">y =</span> total_trade<span class="sc">-</span> <span class="dv">3</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add values above the columns</span></span>
<span id="cb21-564"><a href="#cb21-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Trading Partners (2002-2022)"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Annual Trade Value"</span>) <span class="sc">+</span></span>
<span id="cb21-565"><a href="#cb21-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-566"><a href="#cb21-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-567"><a href="#cb21-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> partner_colors)<span class="sc">+</span></span>
<span id="cb21-568"><a href="#cb21-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb21-569"><a href="#cb21-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-570"><a href="#cb21-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-571"><a href="#cb21-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-572"><a href="#cb21-572" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb21-573"><a href="#cb21-573" aria-hidden="true" tabindex="-1"></a>Above chart does not represent net trading value and Turkey's trading position. Trading values are calculated by summing up total export and import values for each year and results indicate average values during analysis period.</span>
<span id="cb21-574"><a href="#cb21-574" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-575"><a href="#cb21-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-576"><a href="#cb21-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-577"><a href="#cb21-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total trade for each partner</span></span>
<span id="cb21-578"><a href="#cb21-578" aria-hidden="true" tabindex="-1"></a>partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-579"><a href="#cb21-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-580"><a href="#cb21-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-581"><a href="#cb21-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb21-582"><a href="#cb21-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb21-583"><a href="#cb21-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-584"><a href="#cb21-584" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total export and import for each top partner</span></span>
<span id="cb21-585"><a href="#cb21-585" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-586"><a href="#cb21-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> partners<span class="sc">$</span>partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-587"><a href="#cb21-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-588"><a href="#cb21-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb21-589"><a href="#cb21-589" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-590"><a href="#cb21-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export <span class="sc">+</span> total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb21-591"><a href="#cb21-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-592"><a href="#cb21-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-593"><a href="#cb21-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-594"><a href="#cb21-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the net difference</span></span>
<span id="cb21-595"><a href="#cb21-595" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> top_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-596"><a href="#cb21-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)<span class="sc">%&gt;%</span></span>
<span id="cb21-597"><a href="#cb21-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() </span>
<span id="cb21-598"><a href="#cb21-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-599"><a href="#cb21-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-600"><a href="#cb21-600" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export relations with top trading partners</span></span>
<span id="cb21-601"><a href="#cb21-601" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_export <span class="sc">-</span> total_import))) <span class="sc">+</span></span>
<span id="cb21-602"><a href="#cb21-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span> ) <span class="sc">+</span></span>
<span id="cb21-603"><a href="#cb21-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>,<span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-604"><a href="#cb21-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> trade_difference<span class="sc">/</span><span class="fl">1e6</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference<span class="sc">/</span><span class="fl">1e6</span>))),</span>
<span id="cb21-605"><a href="#cb21-605" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-606"><a href="#cb21-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Foreign Trade Surplus/Deficit by Top 10 Partners"</span>,</span>
<span id="cb21-607"><a href="#cb21-607" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb21-608"><a href="#cb21-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> <span class="st">"gray"</span>, <span class="st">"Import"</span> <span class="ot">=</span> <span class="st">"lightgray"</span>,</span>
<span id="cb21-609"><a href="#cb21-609" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"skyblue3"</span>, <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"lightcoral"</span>),</span>
<span id="cb21-610"><a href="#cb21-610" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb21-611"><a href="#cb21-611" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net importer"</span>, <span class="st">"Turkey net exporter"</span>, <span class="st">"Export"</span>, <span class="st">"Import"</span>)) <span class="sc">+</span></span>
<span id="cb21-612"><a href="#cb21-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-613"><a href="#cb21-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb21-614"><a href="#cb21-614" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb21-615"><a href="#cb21-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-616"><a href="#cb21-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-617"><a href="#cb21-617" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-618"><a href="#cb21-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-619"><a href="#cb21-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of countries to filter</span></span>
<span id="cb21-620"><a href="#cb21-620" aria-hidden="true" tabindex="-1"></a>selected_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Germany"</span>, <span class="st">"Russian Federation"</span>, <span class="st">"China"</span>, <span class="st">"Italy"</span>, <span class="st">"USA"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Iran"</span>, <span class="st">"Iraq"</span>)</span>
<span id="cb21-621"><a href="#cb21-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-622"><a href="#cb21-622" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-623"><a href="#cb21-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> selected_countries, year <span class="sc">%in%</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-624"><a href="#cb21-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name, year) <span class="sc">%&gt;%</span></span>
<span id="cb21-625"><a href="#cb21-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb21-626"><a href="#cb21-626" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb21-627"><a href="#cb21-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)</span>
<span id="cb21-628"><a href="#cb21-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-629"><a href="#cb21-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-630"><a href="#cb21-630" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot to show trade comparison with selected trading partners</span></span>
<span id="cb21-631"><a href="#cb21-631" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>trade_difference), <span class="at">y =</span> trade_difference<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference)))) <span class="sc">+</span></span>
<span id="cb21-632"><a href="#cb21-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">height =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Adjust the 'height' parameter</span></span>
<span id="cb21-633"><a href="#cb21-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-634"><a href="#cb21-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"lightcoral"</span>, <span class="st">"skyblue3"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb21-635"><a href="#cb21-635" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net importer"</span>, <span class="st">"Turkey net exporter"</span>)) <span class="sc">+</span></span>
<span id="cb21-636"><a href="#cb21-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trade Comparison with Top 10 Trading Partners(2015-2020)"</span>,</span>
<span id="cb21-637"><a href="#cb21-637" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb21-638"><a href="#cb21-638" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Trade Difference (Export - Import, mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb21-639"><a href="#cb21-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb21-640"><a href="#cb21-640" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb21-641"><a href="#cb21-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-642"><a href="#cb21-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-643"><a href="#cb21-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-644"><a href="#cb21-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-645"><a href="#cb21-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "YourFirstYear" and "YourEndYear" with the actual years that is selected for the analysis</span></span>
<span id="cb21-646"><a href="#cb21-646" aria-hidden="true" tabindex="-1"></a>first_year <span class="ot">&lt;-</span> <span class="dv">2015</span></span>
<span id="cb21-647"><a href="#cb21-647" aria-hidden="true" tabindex="-1"></a>end_year <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb21-648"><a href="#cb21-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-649"><a href="#cb21-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total trade value for the first and end years for each partner</span></span>
<span id="cb21-650"><a href="#cb21-650" aria-hidden="true" tabindex="-1"></a>total_trade_by_partner <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-651"><a href="#cb21-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-652"><a href="#cb21-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_trade_first =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> first_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> first_year]),</span>
<span id="cb21-653"><a href="#cb21-653" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_trade_end =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> end_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> end_year]))</span>
<span id="cb21-654"><a href="#cb21-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-655"><a href="#cb21-655" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the top 10 partners based on the total trade value</span></span>
<span id="cb21-656"><a href="#cb21-656" aria-hidden="true" tabindex="-1"></a>top_10_partners <span class="ot">&lt;-</span> total_trade_by_partner <span class="sc">%&gt;%</span></span>
<span id="cb21-657"><a href="#cb21-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, <span class="at">wt =</span> total_trade_end)</span>
<span id="cb21-658"><a href="#cb21-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-659"><a href="#cb21-659" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change</span></span>
<span id="cb21-660"><a href="#cb21-660" aria-hidden="true" tabindex="-1"></a>percentage_change <span class="ot">&lt;-</span> top_10_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-661"><a href="#cb21-661" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">percentage_change =</span> ((total_trade_end<span class="sc">/</span>total_trade_first)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb21-662"><a href="#cb21-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-663"><a href="#cb21-663" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a lollipop chart</span></span>
<span id="cb21-664"><a href="#cb21-664" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(percentage_change, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">y =</span> percentage_change)) <span class="sc">+</span></span>
<span id="cb21-665"><a href="#cb21-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"skyblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-666"><a href="#cb21-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-667"><a href="#cb21-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Partners: 5 year CAGR growth in Total Trade Value by 2020"</span>,</span>
<span id="cb21-668"><a href="#cb21-668" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb21-669"><a href="#cb21-669" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"5 year CAGR growth in Total Trade Value"</span>) <span class="sc">+</span></span>
<span id="cb21-670"><a href="#cb21-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb21-671"><a href="#cb21-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-672"><a href="#cb21-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-673"><a href="#cb21-673" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Trade Partner Analysis by Product Categories</span></span>
<span id="cb21-674"><a href="#cb21-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-675"><a href="#cb21-675" aria-hidden="true" tabindex="-1"></a>Major export partners of Turkey imported textile and its articles which are followed by vehicles, aircraft and machinery and mechanical components from Turkey. Turkey collaborates with Germany, Spain, and the UK in the defense industry, maintaining its relationship through NATO as well.</span>
<span id="cb21-676"><a href="#cb21-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-677"><a href="#cb21-677" aria-hidden="true" tabindex="-1"></a>Export product categories do not vary significantly among the top export partners, except for China, which notably imports mineral products the most. According to a study, Turkey's mineral exports are moderately concentrated and this concentration is mainly caused by excessive mineral exports to China<span class="ot">[^11]</span></span>
<span id="cb21-678"><a href="#cb21-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-679"><a href="#cb21-679" aria-hidden="true" tabindex="-1"></a><span class="ot">[^11]: </span><span class="co">[</span><span class="ot">Contribution and/or dependency: Chinese hegemony on Turkey's mineral export</span><span class="co">](https://www.sciencedirect.com/science/article/abs/pii/S0301420721004062?via%3Dihub)</span></span>
<span id="cb21-680"><a href="#cb21-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-681"><a href="#cb21-681" aria-hidden="true" tabindex="-1"></a>Turkey's major import partners are Russia, Germany and China as previously noted and exhibited in the second chart. Turkey's energy dependency to Russia and Iran of which are major natural gas, crude and mineral suppliers of Turkey. Turkey decreased its trading volume with Iran after USA urged Turkey to impose sanction in 2012 and 2018. Crude supplies were terminated in 2018 accordingly. Examining Turkey's major imports, it becomes evident that China and Germany play pivotal roles, particularly in the supply of machinery and mechanical components vital for industrial processes. Conversely, Turkey exhibits minimal dependency on textile and vegetable imports, reflecting its advantageous position as a net exporter in these product categories.</span>
<span id="cb21-682"><a href="#cb21-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-683"><a href="#cb21-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-684"><a href="#cb21-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Iraq, Spain, and USA</span></span>
<span id="cb21-685"><a href="#cb21-685" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners<span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-686"><a href="#cb21-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Germany"</span>,<span class="st">"Russian Federation"</span>,<span class="st">"China"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Iraq"</span>, <span class="st">"Spain"</span>, <span class="st">"USA"</span>,<span class="st">"Iran"</span>, <span class="dv">1</span>))</span>
<span id="cb21-687"><a href="#cb21-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-688"><a href="#cb21-688" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for total trade</span></span>
<span id="cb21-689"><a href="#cb21-689" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners <span class="ot">&lt;-</span> trade_data_selected_partners<span class="sc">%&gt;%</span></span>
<span id="cb21-690"><a href="#cb21-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_exp =</span> (trade_value_usd_exp)<span class="sc">/</span><span class="dv">19000000</span>)</span>
<span id="cb21-691"><a href="#cb21-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-692"><a href="#cb21-692" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by section_name and calculate total trade values for each section_name</span></span>
<span id="cb21-693"><a href="#cb21-693" aria-hidden="true" tabindex="-1"></a>total_trade_values_19_year <span class="ot">&lt;-</span> trade_data_selected_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-694"><a href="#cb21-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2002</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-695"><a href="#cb21-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name, partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-696"><a href="#cb21-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_exp_value =</span> <span class="fu">sum</span>(total_trade_exp))</span>
<span id="cb21-697"><a href="#cb21-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-698"><a href="#cb21-698" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter top 5 section names</span></span>
<span id="cb21-699"><a href="#cb21-699" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data <span class="ot">&lt;-</span> total_trade_values_19_year <span class="sc">%&gt;%</span></span>
<span id="cb21-700"><a href="#cb21-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-701"><a href="#cb21-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_exp_value)) <span class="sc">%&gt;%</span></span>
<span id="cb21-702"><a href="#cb21-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb21-703"><a href="#cb21-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-704"><a href="#cb21-704" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb21-705"><a href="#cb21-705" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_commodity_data<span class="sc">$</span>section_name, <span class="dv">25</span>)</span>
<span id="cb21-706"><a href="#cb21-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-707"><a href="#cb21-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the color palette</span></span>
<span id="cb21-708"><a href="#cb21-708" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name)), <span class="st">"Set3"</span>)</span>
<span id="cb21-709"><a href="#cb21-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-710"><a href="#cb21-710" aria-hidden="true" tabindex="-1"></a><span class="co"># Map colors to truncated section names</span></span>
<span id="cb21-711"><a href="#cb21-711" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">setNames</span>(colors, <span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name))</span>
<span id="cb21-712"><a href="#cb21-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-713"><a href="#cb21-713" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the color_mapping in ggplot</span></span>
<span id="cb21-714"><a href="#cb21-714" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_commodity_data, <span class="fu">aes</span>(<span class="at">x =</span> partner_name, <span class="at">y =</span> total_exp_value, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb21-715"><a href="#cb21-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb21-716"><a href="#cb21-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_mapping) <span class="sc">+</span>  <span class="co"># Set manual color scale</span></span>
<span id="cb21-717"><a href="#cb21-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Annual Export Breakdown by Product Category and Partner (2002-2020)"</span>,</span>
<span id="cb21-718"><a href="#cb21-718" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner Name"</span>, <span class="at">y =</span> <span class="st">"Total Export mn USD"</span>,</span>
<span id="cb21-719"><a href="#cb21-719" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sections"</span>) <span class="sc">+</span></span>
<span id="cb21-720"><a href="#cb21-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-721"><a href="#cb21-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb21-722"><a href="#cb21-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>))</span>
<span id="cb21-723"><a href="#cb21-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-724"><a href="#cb21-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-725"><a href="#cb21-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-726"><a href="#cb21-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE,warning=FALSE}</span></span>
<span id="cb21-727"><a href="#cb21-727" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Iraq, Spain, and USA</span></span>
<span id="cb21-728"><a href="#cb21-728" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners<span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-729"><a href="#cb21-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Germany"</span>,<span class="st">"Russian Federation"</span>,<span class="st">"China"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Iraq"</span>, <span class="st">"Spain"</span>, <span class="st">"USA"</span>,<span class="st">"Iran"</span>, <span class="dv">1</span>))</span>
<span id="cb21-730"><a href="#cb21-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-731"><a href="#cb21-731" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for total trade</span></span>
<span id="cb21-732"><a href="#cb21-732" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners <span class="ot">&lt;-</span> trade_data_selected_partners<span class="sc">%&gt;%</span></span>
<span id="cb21-733"><a href="#cb21-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_imp =</span> (trade_value_usd_imp)<span class="sc">/</span><span class="dv">19000000</span>)</span>
<span id="cb21-734"><a href="#cb21-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-735"><a href="#cb21-735" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by section_name and calculate total trade values for each section_name</span></span>
<span id="cb21-736"><a href="#cb21-736" aria-hidden="true" tabindex="-1"></a>total_trade_values_19_year <span class="ot">&lt;-</span> trade_data_selected_partners <span class="sc">%&gt;%</span></span>
<span id="cb21-737"><a href="#cb21-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2002</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-738"><a href="#cb21-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name, partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-739"><a href="#cb21-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_imp_value =</span> <span class="fu">sum</span>(total_trade_imp))</span>
<span id="cb21-740"><a href="#cb21-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-741"><a href="#cb21-741" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter top 5 section names</span></span>
<span id="cb21-742"><a href="#cb21-742" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data <span class="ot">&lt;-</span> total_trade_values_19_year <span class="sc">%&gt;%</span></span>
<span id="cb21-743"><a href="#cb21-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-744"><a href="#cb21-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_imp_value)) <span class="sc">%&gt;%</span></span>
<span id="cb21-745"><a href="#cb21-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb21-746"><a href="#cb21-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-747"><a href="#cb21-747" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb21-748"><a href="#cb21-748" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_commodity_data<span class="sc">$</span>section_name, <span class="dv">25</span>)</span>
<span id="cb21-749"><a href="#cb21-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-750"><a href="#cb21-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the color palette</span></span>
<span id="cb21-751"><a href="#cb21-751" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name)), <span class="st">"Set3"</span>)</span>
<span id="cb21-752"><a href="#cb21-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-753"><a href="#cb21-753" aria-hidden="true" tabindex="-1"></a><span class="co"># Map colors to truncated section names</span></span>
<span id="cb21-754"><a href="#cb21-754" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">setNames</span>(colors, <span class="fu">unique</span>(filtered_commodity_data<span class="sc">$</span>truncated_name))</span>
<span id="cb21-755"><a href="#cb21-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-756"><a href="#cb21-756" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the color_mapping in ggplot</span></span>
<span id="cb21-757"><a href="#cb21-757" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_commodity_data, <span class="fu">aes</span>(<span class="at">x =</span> partner_name, <span class="at">y =</span> total_imp_value, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb21-758"><a href="#cb21-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb21-759"><a href="#cb21-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_mapping) <span class="sc">+</span>  <span class="co"># Set manual color scale</span></span>
<span id="cb21-760"><a href="#cb21-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Annual Import Breakdown by Product Category and Partner (2002-2020)"</span>,</span>
<span id="cb21-761"><a href="#cb21-761" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner Name"</span>, <span class="at">y =</span> <span class="st">"Total Import mn USD"</span>,</span>
<span id="cb21-762"><a href="#cb21-762" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sections"</span>) <span class="sc">+</span></span>
<span id="cb21-763"><a href="#cb21-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add horizontal line at y = 0</span></span>
<span id="cb21-764"><a href="#cb21-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb21-765"><a href="#cb21-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>))</span>
<span id="cb21-766"><a href="#cb21-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-767"><a href="#cb21-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-768"><a href="#cb21-768" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb21-769"><a href="#cb21-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-770"><a href="#cb21-770" aria-hidden="true" tabindex="-1"></a>In conclusion, over these two decades, Turkey's exports and imports have steadily risen, influenced by global events like the financial crisis, commodity shocks and changes in macroeconomic policies. Notably, the shift in Turkey's monetary policy after the 2001 crisis, adopting a floating exchange rate, significantly impacted trade dynamics.</span>
<span id="cb21-771"><a href="#cb21-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-772"><a href="#cb21-772" aria-hidden="true" tabindex="-1"></a>Despite facing a persistent foreign trade deficit, Turkey has showcased its ability to navigate through economic downturns. The global financial crisis of 2008 and the recent pandemic-induced economic slowdown have left their marks, but Turkey has demonstrated its ability to adapt.</span>
<span id="cb21-773"><a href="#cb21-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-774"><a href="#cb21-774" aria-hidden="true" tabindex="-1"></a>Examining product categories, we've identified sectors like textiles, machinery, and base metals as significant contributors to Turkey's export revenue. On the import side, machinery and base metals continue to play a crucial role, highlighting Turkey's dependence on a diverse range of intermediate goods.</span>
<span id="cb21-775"><a href="#cb21-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-776"><a href="#cb21-776" aria-hidden="true" tabindex="-1"></a>Our analysis also delved into the country's trade partnerships, revealing a diverse network of more than 200 export and import partners. Turkey's strong relations with neighboring countries, especially Germany and Italy, along with major economies like China, the USA, and Russia, underscore its strategic importance in global trade.</span>
<span id="cb21-777"><a href="#cb21-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-778"><a href="#cb21-778" aria-hidden="true" tabindex="-1"></a>The charts and trends unveiled throughout our analysis provide actionable insights for Turkey's future trade strategies. The need to enhance local input production, reduce reliance on intermediate goods, and strategically focus on R&amp;D investments emerge as critical considerations for sustaining economic growth. Our analysis serves as a practical guide for informed decision-making, offering valuable lessons for other nations seeking to fortify their economic development.</span>
<span id="cb21-779"><a href="#cb21-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-780"><a href="#cb21-780" aria-hidden="true" tabindex="-1"></a><span class="fu">## Shiny App Link</span></span>
<span id="cb21-781"><a href="#cb21-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-784"><a href="#cb21-784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-785"><a href="#cb21-785" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb21-786"><a href="#cb21-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-787"><a href="#cb21-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-788"><a href="#cb21-788" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb21-789"><a href="#cb21-789" aria-hidden="true" tabindex="-1"></a>shiny<span class="sc">::</span><span class="fu">runGitHub</span>(<span class="st">"pjournal/mef07g-yellowsubmarine"</span>, <span class="at">subdir =</span> <span class="st">"/app/app.R"</span>)</span>
<span id="cb21-790"><a href="#cb21-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-791"><a href="#cb21-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-792"><a href="#cb21-792" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Shiny App Link is here.</span><span class="co">](https://sezerlucianturkmen.shinyapps.io/yellowsubmarine/)</span></span>
<span id="cb21-793"><a href="#cb21-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-794"><a href="#cb21-794" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb21-795"><a href="#cb21-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-796"><a href="#cb21-796" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">*World Integrated Trade Solution (World Bank)*</span><span class="co">](https://wits.worldbank.org/)</span></span>
<span id="cb21-797"><a href="#cb21-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-798"><a href="#cb21-798" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">*Dataset*</span><span class="co">](https://docs.ropensci.org/tradestatistics/articles/basic-usage.html)</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center"><a href="https://mef-bda503.github.io">MEF BDA 503</a></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>
[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "YELLOW SUBMARINE Progress Journal",
    "section": "",
    "text": "Introduction\nThis progress journal covers YELLOW SUBMARINE’s work during their term at BDA 503 Fall 2023.\nEach section is an assignment or an individual work."
  },
  {
    "objectID": "index.html#about",
    "href": "index.html#about",
    "title": "YELLOW SUBMARINE Progress Journal",
    "section": "About",
    "text": "About\nWorld Integrated Trade Solution (WITS) emerges as a pivotal platform, offering a comprehensive view of international trade dynamics, with a particular focus on Turkey from 2002 to 2020. This powerful tool aggregates data from diverse sources to furnish users with valuable insights into Turkey’s merchandise trade, tariffs, and non-tariff measures during this specific period. With an expansive database, WITS facilitates informed decision-making and strategic planning for researchers, policymakers, and businesses interested in Turkey’s trade landscape.\nEmbarking on an Exploratory Data Analysis (EDA) journey within WITS involves loading datasets, cleaning data, and employing statistical and visual analyses specific to Turkey’s trade from 2002 to 2020. This process unveils trade patterns, identifies trends, and provides actionable insights, enabling stakeholders to navigate the complexities of Turkey’s trade dynamics during this crucial timeframe. The synergy between WITS and EDA empowers users to make informed decisions and strategic choices, fostering a more interconnected and informed landscape for Turkey’s economy and trade."
  },
  {
    "objectID": "index.html#teaser",
    "href": "index.html#teaser",
    "title": "YELLOW SUBMARINE Progress Journal",
    "section": "Teaser",
    "text": "Teaser"
  },
  {
    "objectID": "index.html#contents",
    "href": "index.html#contents",
    "title": "YELLOW SUBMARINE Progress Journal",
    "section": "Contents",
    "text": "Contents\n\nData Preprocessing\n\nRDS Link\n\nExploratory Data Analysis\nFinal Report\n\nPDF format\nHTML format\n\nShiny App\n\nShiny Codes\nYou can also reach the Shiny App by running the code below in R Console:\nshiny::runGitHub(repo = \"pjournal/mef07g-yellowsubmarine\",subdir=\"app/app.R\")\n\nMedium Post"
  },
  {
    "objectID": "preprocesseddata.html#yellow-submarines-project-proposal-on-wits-data",
    "href": "preprocesseddata.html#yellow-submarines-project-proposal-on-wits-data",
    "title": "1  Preprocessed Data",
    "section": "1.1 Yellow Submarine’s Project Proposal on WITS data",
    "text": "1.1 Yellow Submarine’s Project Proposal on WITS data\nThe choice of this domain stems from the significance of Turkey’s role in the global trade landscape between 2002-2020. Before settling on the WITS database, we reviewed existing solutions, including the Harvard University Atlas project and Visualizations from the Observatory of Economic Complexity.)\nWe have decided on this database considering the primary sources that include:\na. Exports&Imports: Analyze composition of exports and imports data by complexity for each commodity\nb. Trade Partnerships: Utilize international trade databases to identify Turkey’s major trade partner and assess trade volumes\nc. Additional Insights: Explore supplementary datasets as needed to uncover specific aspects of Turkey’s trade dynamics, such as tariffs and distances data to map out key trading routes, highlighting the connectivity and strategic importance of Turkey in global trade.\nWith this project, we aim to produce a comprehensive report that synthesizes the findings into a coherent narrative. Visualizations, charts, and infographics will be employed to enhance the accessibility of the data."
  },
  {
    "objectID": "preprocesseddata.html#dataset-installation-and-preprocessing",
    "href": "preprocesseddata.html#dataset-installation-and-preprocessing",
    "title": "1  Preprocessed Data",
    "section": "1.2 Dataset Installation and Preprocessing",
    "text": "1.2 Dataset Installation and Preprocessing\n\n1.2.1 Necessary Source Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tradestatistics)\nlibrary(tibble)\n\n\n\n1.2.2 Datasets\nThe data retrieval and table creation were facilitated using the ‘tradestatistics’ package developed by a group of developers led by Mauricio Vargas. This package streamlines the process of fetching data from api.tradestatistics.io and generates tables that are convenient for analytical purposes. We used otc_create_tidy_data for our analysis\nDataSet 1: This data set shows Turkey’s export and import values with product categories & related commodities’ names & codes only\nDataSet 2: This data set shows Turkey’s and its partners’ export and import values with product categories & related commodities’ names & codes\n\n#DataSet 1: \n\nwits_turkey_data_only &lt;- ots_create_tidy_data(\n  years = 2002:2020,\n  reporters = \"tur\",\n  table = \"yrc\"\n)\nhead(wits_turkey_data_only)\n\n#DataSet 2: \n\nwits_turkey_data_with_partners &lt;- ots_create_tidy_data(\n  years = 2002:2020,\n  reporters = \"tur\",\n  table = \"yrpc\"\n)\nhead(wits_turkey_data_with_partners)\n\n#Combine the datasets into a list\ncombined_datasets &lt;- list(\n  wits_turkey_data_only = wits_turkey_data_only,\n  wits_turkey_data_with_partners = wits_turkey_data_with_partners\n)"
  },
  {
    "objectID": "preprocesseddata.html#creating-rds-file",
    "href": "preprocesseddata.html#creating-rds-file",
    "title": "1  Preprocessed Data",
    "section": "1.3 Creating RDS file",
    "text": "1.3 Creating RDS file\n\nsaveRDS(combined_datasets, file = \"wits_data.rds\")\n\nThe created .Rdata file can be reached through RDS Link"
  },
  {
    "objectID": "preprocesseddata.html#monitoring-the-data",
    "href": "preprocesseddata.html#monitoring-the-data",
    "title": "1  Preprocessed Data",
    "section": "1.4 Monitoring the Data",
    "text": "1.4 Monitoring the Data\n\nlibrary(DT)\n\nloaded_datasets &lt;- readRDS(\"wits_data.rds\")\nread_wits_turkey_data_only &lt;- loaded_datasets$wits_turkey_data_only\nread_wits_turkey_data_with_partners &lt;- loaded_datasets$wits_turkey_data_with_partners\n\nDT::datatable(head(read_wits_turkey_data_only),editable = list(\n  target = 'row', disable = list(columns = c(1, 3, 4))\n))\n\n\n\n\n\nDT::datatable(head(read_wits_turkey_data_with_partners), editable = list(\n  target = 'row', disable = list(columns = c(1, 3, 4))\n))"
  },
  {
    "objectID": "preprocesseddata.html#references",
    "href": "preprocesseddata.html#references",
    "title": "1  Preprocessed Data",
    "section": "1.5 References",
    "text": "1.5 References\nBasic examples listed in this link were useful during creating RDS and monitoring data tables"
  },
  {
    "objectID": "exploratorydataanalysis.html#group-project-turkey-analysis-trade-balance-partners",
    "href": "exploratorydataanalysis.html#group-project-turkey-analysis-trade-balance-partners",
    "title": "2  Exploratory Data Analysis",
    "section": "Group Project, Turkey Analysis: Trade Balance & Partners",
    "text": "Group Project, Turkey Analysis: Trade Balance & Partners\nThe choice of this domain stems from the significance of Turkey’s role in the global trade landscape between 2002-2020. We utilized a table generated within the ‘data’ package, developed by a team led by Mauricio Vargas. This package retrieves its data from https://api.tradestatistics.io/\n\nAnalysis\n\n\nLoading Datasets\n\n\nCode\nloaded_datasets &lt;- readRDS(\"wits_data.rds\")\nread_wits_turkey_data_only &lt;- loaded_datasets$wits_turkey_data_only\nread_wits_turkey_data_with_partners &lt;- loaded_datasets$wits_turkey_data_with_partners\n\n\n\n\nOverview of the Datasets\nDataset 1: This data set shows Turkey’s export and import values with product categories & related commodities’ names & codes only\n\n\nCode\nstr(read_wits_turkey_data_only)\n\n\nClasses 'data.table' and 'data.frame':  90663 obs. of  9 variables:\n $ year               : int  2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 ...\n $ reporter_iso       : chr  \"tur\" \"tur\" \"tur\" \"tur\" ...\n $ reporter_name      : chr  \"Turkey\" \"Turkey\" \"Turkey\" \"Turkey\" ...\n $ commodity_code     : chr  \"010121\" \"010121\" \"010121\" \"010121\" ...\n $ commodity_name     : chr  \"Horses; live, pure-bred breeding animals\" \"Horses; live, pure-bred breeding animals\" \"Horses; live, pure-bred breeding animals\" \"Horses; live, pure-bred breeding animals\" ...\n $ section_code       : chr  \"01\" \"01\" \"01\" \"01\" ...\n $ section_name       : chr  \"Live animals and animal products\" \"Live animals and animal products\" \"Live animals and animal products\" \"Live animals and animal products\" ...\n $ trade_value_usd_imp: num  6307262 1231248 958946 1111437 3684454 ...\n $ trade_value_usd_exp: num  0 136000 0 22750 403711 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n - attr(*, \"sorted\")= chr [1:2] \"commodity_code\" \"section_code\"\n\n\nCode\nsummary(read_wits_turkey_data_only)\n\n\n      year      reporter_iso       reporter_name      commodity_code    \n Min.   :2002   Length:90663       Length:90663       Length:90663      \n 1st Qu.:2006   Class :character   Class :character   Class :character  \n Median :2011   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2011                                                           \n 3rd Qu.:2016                                                           \n Max.   :2020                                                           \n commodity_name     section_code       section_name       trade_value_usd_imp\n Length:90663       Length:90663       Length:90663       Min.   :0.000e+00  \n Class :character   Class :character   Class :character   1st Qu.:4.259e+05  \n Mode  :character   Mode  :character   Mode  :character   Median :3.138e+06  \n                                                          Mean   :3.836e+07  \n                                                          3rd Qu.:1.574e+07  \n                                                          Max.   :4.073e+10  \n trade_value_usd_exp\n Min.   :0.000e+00  \n 1st Qu.:9.152e+04  \n Median :1.150e+06  \n Mean   :2.612e+07  \n 3rd Qu.:8.788e+06  \n Max.   :1.334e+10  \n\n\nDataset 2: This data set shows Turkey’s and its partners’ export and import values with product categories & related commodities’ names & codes\n\n\nCode\nstr(read_wits_turkey_data_with_partners)\n\n\nClasses 'data.table' and 'data.frame':  3887005 obs. of  11 variables:\n $ year               : int  2018 2019 2018 2005 2008 2002 2003 2004 2005 2006 ...\n $ reporter_iso       : chr  \"tur\" \"tur\" \"tur\" \"tur\" ...\n $ reporter_name      : chr  \"Turkey\" \"Turkey\" \"Turkey\" \"Turkey\" ...\n $ partner_iso        : chr  \"arg\" \"aus\" \"aut\" \"aze\" ...\n $ partner_name       : chr  \"Argentina\" \"Australia\" \"Austria\" \"Azerbaijan\" ...\n $ commodity_code     : chr  \"010121\" \"010121\" \"010121\" \"010121\" ...\n $ commodity_name     : chr  \"Horses; live, pure-bred breeding animals\" \"Horses; live, pure-bred breeding animals\" \"Horses; live, pure-bred breeding animals\" \"Horses; live, pure-bred breeding animals\" ...\n $ section_code       : chr  \"01\" \"01\" \"01\" \"01\" ...\n $ section_name       : chr  \"Live animals and animal products\" \"Live animals and animal products\" \"Live animals and animal products\" \"Live animals and animal products\" ...\n $ trade_value_usd_imp: num  14926 7757 26155 6784 0 ...\n $ trade_value_usd_exp: num  0 0 0 0 10250 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n - attr(*, \"sorted\")= chr [1:2] \"commodity_code\" \"section_code\"\n\n\nCode\nsummary(read_wits_turkey_data_with_partners)\n\n\n      year      reporter_iso       reporter_name      partner_iso       \n Min.   :2002   Length:3887005     Length:3887005     Length:3887005    \n 1st Qu.:2008   Class :character   Class :character   Class :character  \n Median :2013   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2012                                                           \n 3rd Qu.:2017                                                           \n Max.   :2020                                                           \n partner_name       commodity_code     commodity_name     section_code      \n Length:3887005     Length:3887005     Length:3887005     Length:3887005    \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n section_name       trade_value_usd_imp trade_value_usd_exp\n Length:3887005     Min.   :0.000e+00   Min.   :0.000e+00  \n Class :character   1st Qu.:0.000e+00   1st Qu.:4.230e+02  \n Mode  :character   Median :0.000e+00   Median :8.367e+03  \n                    Mean   :8.947e+05   Mean   :6.093e+05  \n                    3rd Qu.:1.157e+04   3rd Qu.:8.157e+04  \n                    Max.   :1.749e+10   Max.   :6.528e+09  \n\n\n\n\nData Cleaning\n\n\nCode\nsapply(read_wits_turkey_data_only, function(x) sum(is.na(x)))\n\n\n               year        reporter_iso       reporter_name      commodity_code \n                  0                   0                   0                   0 \n     commodity_name        section_code        section_name trade_value_usd_imp \n                  0                   0                  19                   0 \ntrade_value_usd_exp \n                  0 \n\n\nCode\nsapply(read_wits_turkey_data_with_partners, function(x) sum(is.na(x)))\n\n\n               year        reporter_iso       reporter_name         partner_iso \n                  0                   0                   0                   0 \n       partner_name      commodity_code      commodity_name        section_code \n                  0                   0                   0                   0 \n       section_name trade_value_usd_imp trade_value_usd_exp \n               2986                   0                   0 \n\n\nCode\nunique_values &lt;- unique(read_wits_turkey_data_with_partners$section_name)\nrows_with_missing_values &lt;- read_wits_turkey_data_with_partners[is.na(read_wits_turkey_data_with_partners$section_name), ]\n\n\nWe have identified rows with missing values in the column which are labelled as commodities that are not specified according to a kind. Since these rows contain both export and import values crucial for our overall analysis, we have opted not to remove them. Instead, we flagged them as NA for further analysis"
  },
  {
    "objectID": "exploratorydataanalysis.html#exploratory-data-analysis-eda",
    "href": "exploratorydataanalysis.html#exploratory-data-analysis-eda",
    "title": "2  Exploratory Data Analysis",
    "section": "Exploratory Data Analysis (EDA)",
    "text": "Exploratory Data Analysis (EDA)\n\nExports & Imports Analysis\n\nOverview of Turkey’s Exports and Imports Over the Years\nTurkey has experienced a consistent upward trajectory in both exports and imports from 2002 to 2020, as displayed in the y axis with aggregated amount of trade value in USDs throughout the analysis period and years in x axis.\nKey Findings: Important aspects to consider with this analysis include consistent upward trajectory, influence factors such as global financial crisis, monetary policies of trade partners and currency fluctuations. Turkey’s net position has always been negative. (total exports value - total imports value = foreign trade deficit).\nInterestingly, the foreign trade deficit expanded between 2011 and 2014 (inclusive of both start and end years) and began to diminish from 2015 to 2020, except for a spike in 2017. We will delve deeper into the yearly dynamics and extend our analysis by examining product categories and trade partners.\n\n\nCode\ntotal_exports&lt;- read_wits_turkey_data_only %&gt;%\n  group_by(year) %&gt;%\n  summarize(total_exports = sum(trade_value_usd_exp))\n  te_e &lt;- total_exports$total_exports\n  \n\ntotal_imports &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(year) %&gt;%\n  summarize(total_imports = sum(trade_value_usd_imp))\n  ti_i &lt;- total_imports$total_imports\n\n\n# Visualize exports and imports over the years\nggplot() +\n  geom_line(data = total_exports, aes(x = year, y = (te_e / 1e6), color = \"Exports\"), size = 1.5) +\n  geom_line(data = total_imports, aes(x = year, y = (ti_i / 1e6), color = \"Imports\"), size = 1.5) +\n  labs(title = \"Turkey's Exports and Imports Over the Years\", x = \"Year\", y = \"Trade Value (USD)\",\n )\n\n\n\n\n\nThe chart illustrated below shows Turkey’s foreign trade deficit in lightcoral colored column with year data on x axis, trade values on y axis.\n\n\nCode\n# Calculate total trade for each year\nyearly_trade &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(year) %&gt;%\n  summarize(total_trade = sum(trade_value_usd_exp + trade_value_usd_imp)) %&gt;%\n  arrange(desc(year)) \n  \n# Calculate total export and import for each year\nyearly_trade_net &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(year) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp),\n            total_import = sum(trade_value_usd_imp)) %&gt;%\n  arrange(desc(year))\n\n\n# Calculate the net difference\nyearly_trade_net &lt;- yearly_trade_net  %&gt;%\n  mutate(trade_difference = total_export - total_import)%&gt;%\n  na.omit() \n\n\n# Visualize import and export by year\n\nggplot(data = yearly_trade_net, aes(x = year)) +\n  geom_bar(aes(y = total_export, fill = \"Export\"), stat = \"identity\", position = \"dodge\",color = \"darkgray\", linetype = \"dashed\" ) +\n  geom_bar(aes(y = -total_import, fill = \"Import\"), stat = \"identity\", position = \"dodge\",color = \"darkgray\", linetype = \"dashed\") +\n  geom_bar(aes(y = trade_difference, fill = factor(sign(trade_difference))),\n           stat = \"identity\", position = \"dodge\", color = \"black\", alpha=0.7) +\n  labs(title = \"Net Trade Position of Turkey\",\n       x = \"Year\", y = \"Total Trade Value (USD)\") +\n  scale_fill_manual(values = c(\"Export\" = \"gray\", \"Import\" = \"lightgray\",\n                                \"1\" = \"skyblue3\", \"-1\" = \"lightcoral\"),\n                    name = \"\",\n                    labels = c(\"Net importer\", \"Export\", \"Import\")) +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(axis.text.x = element_text(angle = 90, hjust = 1),\n        legend.position = \"right\")\n\n\n\n\n\nLet’s conduct a more in-depth analysis to determine the product categories in which Turkey holds a strong position in its exports.\n\n\nTop Export Product Categories\nTurkey’s annual export revenue on average throughout the analysis period is ~125bn USD, as calculated below:\n\n\nCode\n# Calculate the annual export revenue througout the analysis period (by taking average)\nannual_export_value&lt;-read_wits_turkey_data_with_partners %&gt;%\n  summarise(annual_export_value = sum(trade_value_usd_exp))\nprint(annual_export_value/19000000) # in mn USDs\n\n\n  annual_export_value\n1            124642.6\n\n\nWe examined annual export income of each product category listed under top 10. Below list shows the ranking of each product category which generates the highest annual export income throughout the analysis period.\nKey Findings:\nTurkey’s top 10 export revenues constitutes 89% of total export income. Textiles and apparel, machinery and equipment, vehicles and associated equipment, as well as base metals and mineral products, are the significant contributors to Turkey’s export revenue.\nImportant aspects to consider with this analysis include key export players in Turkey and key trade partners that Turkey have, top product categories’ yearly trends and fluctuations over the analysis period.\nDefinition: Annual export income: aggregated amount of trade value of each product category/analysis period (19 years)\n\n\nCode\ntop_export_products &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp)/19) %&gt;%\n  na.omit() \n  \ntop_export_products &lt;- top_export_products %&gt;%\n  arrange(desc(total_export))\ntop_export_products$total_export &lt;- scales::number_format(suffix = \" mn\")(top_export_products$total_export / 1e6)\n\nDT::datatable(top_export_products, colnames = c('Section Name', 'Annual Export Income (USD) (2002-2020)'),options = list(pageLength = 10))\n\n\n\n\n\n\n\nBelow column chart illustrates top 10 product categories’ annual export income throughout the analysis period, y-axis with annual export income and x-axis with years.\n\n\nCode\nexport_plot_data &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp)/19000000) %&gt;%\n  top_n(10)\n\n# Truncate section names to the first 20 characters\nexport_plot_data$truncated_name &lt;- str_trunc(export_plot_data$section_name, 50)\n\n# Get distinct truncated names for colors\ncolor_names &lt;- unique(export_plot_data$truncated_name)\n\n# Generate a limited number of distinct colors\ncolors &lt;- brewer.pal(length(color_names), \"Set3\")\n\nggplot(data = export_plot_data, aes(x = reorder(section_name, -total_export), y = total_export, fill = truncated_name)) +\n  geom_bar(stat = \"identity\", color = \"black\") +\n  labs(title = \"Top 10 Diversity of Exported Products (2002-2020, Turkey)\", x = \"Products\", y = \"Total Export Value (USD)\") +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(axis.text.x = element_blank(), axis.title.x = element_blank(), legend.position = \"bottom\") +\n  guides(fill = guide_legend(nrow = 5)) +\n  scale_fill_manual(values = setNames(colors, color_names), name = \"\")\n\n\n\n\n\nLet’s examine the trend analysis of these product categories from 2002 to 2020\nKey Findings:\nFluctuations in natural and mineral product exports require further investigation. Initial thoughts focused on factors like steel industry dynamics, potential sanctions and commodity crises. Additionally, fluctuations in Turkey’s gold exports and imports which exhibited up and downs over recent years are also considered.\nIn 2020, a downward trend was noted in every product category, except for essential items such as vegetable products, plastics, and foodstuff, which exhibited inelastic demand and remained resilient during the pandemic.\n\n\nCode\nlibrary(dplyr)\ntop_exports_products &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp)) %&gt;%\n  top_n(9)%&gt;%\n  na.omit() \n\ntop_exports_products &lt;- top_exports_products %&gt;% \n  mutate(\n    section_name = case_when(\n      str_detect(section_name, \"^Machinery and mechanical appliances\") ~ \"Machinery Products\",\n      str_detect(section_name, \"^Base metals\") ~ \"Base Metal Products\",\n      str_detect(section_name, \"^Natural or\") ~ \"Natural Products\",\n      str_detect(section_name, \"^Vehicles,\") ~ \"Vehicles Equipment\",\n      str_detect(section_name, \"^Plastics and articles\") ~ \"Plastics\",\n      str_detect(section_name, \"^Product of the chemicals\") ~ \"Chemicals\",\n      str_detect(section_name, \"^Prepared foodstuffs,\") ~ \"Foodstuffs and Tobacco\",\n      TRUE ~ as.character(section_name)\n    )\n  )\n\nread_wits_turkey_data_with_partners_edit &lt;- read_wits_turkey_data_with_partners%&gt;% \n  mutate(\n    section_name = case_when(\n      str_detect(section_name, \"^Machinery and mechanical appliances\") ~ \"Machinery Products\",\n      str_detect(section_name, \"^Base metals\") ~ \"Base Metal Products\",\n      str_detect(section_name, \"^Natural or\") ~ \"Natural Products\",\n      str_detect(section_name, \"^Vehicles,\") ~ \"Vehicles Equipment\",\n      str_detect(section_name, \"^Plastics and articles\") ~ \"Plastics\",\n      str_detect(section_name, \"^Product of the chemicals\") ~ \"Chemicals\",\n      str_detect(section_name, \"^Prepared foodstuffs,\") ~ \"Foodstuffs and Tobacco\",\n      TRUE ~ as.character(section_name)\n    )\n  )\n\n# Filter the data with the selected top import products\nexport_plot_data &lt;- read_wits_turkey_data_with_partners_edit %&gt;%\nfilter(section_name %in% top_exports_products$section_name)%&gt;%\n  group_by(year, section_name) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp)) %&gt;%\n  ungroup()\n  \n\n# Create the plot with geom_point\nggplot(data = export_plot_data, aes(x = year, y = total_export/1000000, color = section_name)) +\n  geom_line(size = 1.2) +\n  facet_wrap(~section_name, scales = \"free_y\", ncol = 3, labeller = labeller(NULL)) +\n  labs(title = \"Export Trends of Top Products (2002-2020, Turkey)\", x = \"Year\", y = \"Total Export Value (mn USD)\") +\n  theme(legend.position = \"none\")  # Remove legend\n\n\n\n\n\nLet’s conduct a more in-depth analysis to determine the product categories in which Turkey is most dependent on its imports.\n\n\nTop Import Product Categories\nTurkey’s import value on average throughout the analysis period is ~183 bn USD, as calculated below:\n\n\nCode\n# Calculate the annual export revenue througout the analysis period (by taking average)\nannual_import_value&lt;-read_wits_turkey_data_with_partners %&gt;%\n  summarise(annual_imp_value = sum(trade_value_usd_imp))\nprint(annual_import_value/19000000) # in mn USDs\n\n\n  annual_imp_value\n1         183046.7\n\n\nWe examined annual import value of each product category listed under top 10. Below list shows the ranking of each product category which generates the highest annual import value throughout the analysis period.\nKey Findings:\nTurkey’s top 10 import value constitute 81% of total imports. Machinery and equipment, base metals and their articles, mineral products, chemicals as well as vehicles and associated equipment constitute the primary import categories contributing to Turkey’s import value.\nImportant aspects to consider with this analysis include key importers, top product categories’ yearly trends and fluctuations over the analysis period.\nDefinition: Annual import value: aggregated amount of trade value of each product category/analysis period (19 years)\n\n\nCode\ntop_import_products &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_import = sum(trade_value_usd_imp)/19) %&gt;%\n  na.omit() \n  \ntop_import_products &lt;- top_import_products %&gt;%\n  arrange(desc(total_import))\ntop_import_products$total_import &lt;- scales::number_format(suffix = \" mn\")(top_import_products$total_import / 1e6)\ndatatable(top_import_products, colnames = c('Section Name', 'Annual Import Value (USD)'),options = list(pageLength = 10))\n\n\n\n\n\n\n\nBelow column chart illustrates top 10 product categories’ annual import value throughout the analysis period, y-axis with annual import value and x-axis with years.\n\n\nCode\nimported_plot_data &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_import = sum(trade_value_usd_imp)) %&gt;%\n  top_n(10)\n\n# Truncate section names to the first 20 characters\nimported_plot_data$truncated_name &lt;- str_trunc(imported_plot_data$section_name, 50)\n\n# Get distinct truncated names for colors\ncolor_names &lt;- unique(imported_plot_data$truncated_name)\n\n# Generate a limited number of distinct colors\ncolors &lt;- brewer.pal(length(color_names), \"Set3\")\n\nggplot(data = imported_plot_data, aes(x = reorder(section_name, -total_import), y = total_import, fill = truncated_name)) +\n  geom_bar(stat = \"identity\", color = \"black\") +\n  labs(title = \"Top 10 Diversity of Imported Products (2002-2020, Turkey)\", x = \"Products\", y = \"Total Import Value (USD)\") +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(axis.text.x = element_blank(), axis.title.x = element_blank(), legend.position = \"bottom\") +\n  guides(fill = guide_legend(nrow = 5)) +\n  scale_fill_manual(values = setNames(colors, color_names), name = \"\")\n\n\n\n\n\nLet’s examine the trend analysis of these product categories from 2002 to 2020\nKey Findings:\nSlowdown in imports of all product categories is initially observed in 2009 reflecting the effects of global crisis in 2008.\nImport values of mineral and natural products fluctuated during analysis period, requires further investigation as it has been mentioned in exports section.\nAnalysis for product categories of vegetables and plastics under export section remains applicable for imports, showcasing inelastic demand during pandemic.\n\n\nCode\ntop_import_products &lt;- read_wits_turkey_data_only %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_import = sum(trade_value_usd_imp)) %&gt;%\n  top_n(10)%&gt;%\n  na.omit() \n\ntop_import_products &lt;- top_import_products %&gt;% \n  mutate(\n    section_name = case_when(\n        str_detect(section_name, \"^Machinery and mechanical appliances\") ~ \"Machinery Products\",\n      str_detect(section_name, \"^Base metals\") ~ \"Metal Products\",\n      str_detect(section_name, \"^Natural or\") ~ \"Natural Products\",\n      str_detect(section_name, \"^Vehicles,\") ~ \"Transport Equipment\",\n      str_detect(section_name, \"^Plastics and articles\") ~ \"Plastics\",\n      str_detect(section_name, \"^Product of the chemicals\") ~ \"Chemicals\",\n      TRUE ~ as.character(section_name)\n    )\n  )\n\nread_wits_turkey_data_with_partners_edit &lt;- read_wits_turkey_data_with_partners%&gt;% \n  mutate(\n    section_name = case_when(\n      str_detect(section_name, \"^Machinery and mechanical appliances\") ~ \"Machinery Products\",\n      str_detect(section_name, \"^Base metals\") ~ \"Metal Products\",\n      str_detect(section_name, \"^Natural or\") ~ \"Natural Products\",\n      str_detect(section_name, \"^Vehicles,\") ~ \"Transport Equipment\",\n      str_detect(section_name, \"^Plastics and articles\") ~ \"Plastics\",\n      str_detect(section_name, \"^Product of the chemicals\") ~ \"Chemicals\",\n      TRUE ~ as.character(section_name)\n    )\n  )\n\n# Filter the data with the selected top import products\nimport_plot_data &lt;- read_wits_turkey_data_with_partners_edit %&gt;%\n  filter(section_name %in% top_import_products$section_name) %&gt;%\n  group_by(year, section_name) %&gt;%\n  summarize(total_import = sum(trade_value_usd_imp)) %&gt;%\n  ungroup()  \n\n# Create the plot with geom_point\nggplot(data = import_plot_data, aes(x = year, y = total_import, color = section_name)) +\n  geom_line(size = 1.2) +\n  facet_wrap(~section_name, scales = \"free_y\", ncol = 3, labeller = labeller(NULL)) +\n  labs(title = \"Import Trends of Top 9 Products (2002-2020, Turkey)\", x = \"Year\", y = \"Total Import Value (USD)\") +\n  theme(legend.position = \"none\")  # Remove legend\n\n\n\n\n\n\n\n\nTrade Partnership Analysis\n\nDiversification of Export Revenue Streams by Top 10 Product Category\nThis chart aims to assess Turkey’s revenue generation capacity by scrutinizing top 10 product category.\nThe focus is to understand diversity of Turkey’s trade partners, identifying leading revenue generators in 2020 and evaluating the performance of these revenue categories over the last five years.\nKey Findings:\nImportant aspects to consider with this analysis include trade partner diversification of Turkey’s revenue streams, significant export revenue contributor categories’ performance within the last 5 year.\nInterestingly, Textiles and Apparel, Vehicles and Associated Equipment and Base Metals and Mineral exhibits a trend of non-growth or decline in revenue generation, which are among the highest revenue generator in 2020.\nConversely, Mineral Products, Miscellaneous Manufactured Articles, Vegetable Products and Plastics demonstrated an increased capacity for revenue generation over the last five years, albeit still trailing behind the primary product categories mentioned earlier.\nDefinition: Each bubble represents compounded annual growth rate of export income within the last 5 years, 2015-2020) for each product category. Export revenue value of 2020 generated from each product category that is colored in the bubbles is on y-axis, while number of distinct trade partners in on x axis.5 year compounded growth rate is calculated by dividing total trade value generated in 2020 by total trade value generated in 2015, the result is raised to an exponent of one divided by five years, one was subtracted from the subsequent result and multiplied by 100 to be presented as percentage\n\n\nCode\n# Find the top 10 section_name based on trade_value\ntop_sections &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp)) %&gt;%\n  arrange(desc(total_export)) %&gt;%\n  head(15)\n\n# Step 2: Filter the dataframe to include only the top 10 section_names\nread_wits_turkey_data_with_partners_top10 &lt;- read_wits_turkey_data_with_partners %&gt;%\n  filter(section_name %in% top_sections$section_name)\n\n# Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe\nread_wits_turkey_data_with_partners_top10  &lt;- read_wits_turkey_data_with_partners_top10  %&gt;%\n  group_by(section_name) %&gt;%\n  mutate(partner_count = n_distinct(partner_name)) %&gt;%\n  ungroup()\n\nread_wits_turkey_data_with_partners_top10 &lt;- read_wits_turkey_data_with_partners_top10 %&gt;%\n  group_by(section_name) %&gt;%\n  mutate(cagr = ((trade_value_usd_exp[2020]/trade_value_usd_exp[2015])^(1/5)-1)*100) %&gt;%\n  ungroup()\n\nread_wits_turkey_data_with_partners_top10 &lt;- read_wits_turkey_data_with_partners_top10 %&gt;%\n  filter(year == 2020) %&gt;%\n  group_by(section_name) %&gt;%\n  mutate(total_trade_value_exp_2020 = sum(trade_value_usd_exp)/1000000) %&gt;%\n  ungroup()\n\n# Truncate section names to the first 35 characters\nread_wits_turkey_data_with_partners_top10$truncated_name &lt;- str_trunc(read_wits_turkey_data_with_partners_top10$section_name, 35)\n\n# Get distinct truncated names for colors\ncolor_names &lt;- read_wits_turkey_data_with_partners_top10$truncated_name\n\n\nggplot(read_wits_turkey_data_with_partners_top10, aes(x = partner_count, y = total_trade_value_exp_2020, size = cagr, color = truncated_name)) +\n  geom_point(alpha = 0.7) +\n  scale_size_continuous(range = c(3, 15)) +\n  scale_y_continuous(limits = c(min(read_wits_turkey_data_with_partners_top10$total_trade_value_exp_2020), max(read_wits_turkey_data_with_partners_top10$total_trade_value_exp_2020) + 5)) + # adjust y-axis scale\n  scale_x_continuous(limits = c(min(read_wits_turkey_data_with_partners_top10$partner_count), max(read_wits_turkey_data_with_partners_top10$partner_count) + 5)) +  # adjust x-axis scale\n  scale_color_manual(values = scales::hue_pal()(length(unique(read_wits_turkey_data_with_partners_top10$section_name)))) +  # Use a different color palette\n  labs(title = \"Export Partner and Revenue Growth Analysis for Top 10 Product Categories\",\n       x = \"Number of Export Countries\",\n       y = \"Total Export Revenue mn USD (2020) \",\n       size = \"5 year CAGR\", \n       color = \"Section Name\") +\n theme(\n    legend.position = \"right\",  \n    legend.box = \"horizontal\",   \n    legend.margin = margin(t = 0, r = 0, b = 0, l = 0)  \n    \n  )\n\n\n\n\n\n\n\nDiversification of Import Streams by Top 10 Product Category\nThis chart aims to assess Turkey’s dependency on imports for its top 10 product categories and to understand diversity of Turkey’s trade partners, identifying leading import sources in 2020 and evaluating the performance of these sources over the last five years.\nKey Findings:\nInterestingly, despite declining trend in import values, machinery and mechanical appliances exhibited the highest import stream in 2020 of which has the highest number of trade partners. Conversely, plastics and chemicals demonstrated an increased import value over the last five years, albeit still trailing behind the primary product categories mentioned earlier.\nDefinition: Each bubble represents compounded annual growth rate of trade value within the last 5 years, 2015-2020) for each product category. Import values of 2020 generated from each product category that is colored in the bubbles is on y-axis, while number of distinct trade partners in on x axis.\n\n\nCode\n# Step 1: Find the top 10 section_name based on trade_value\ntop_sections &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(section_name) %&gt;%\n  summarize(total_import = sum(trade_value_usd_imp)) %&gt;%\n  arrange(desc(total_import)) %&gt;%\n  head(15)\n\n# Step 2: Filter the dataframe to include only the top 10 section_names\nread_wits_turkey_data_with_partners_top10 &lt;- read_wits_turkey_data_with_partners %&gt;%\n  filter(section_name %in% top_sections$section_name)\n\n# Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe\nread_wits_turkey_data_with_partners_top10  &lt;- read_wits_turkey_data_with_partners_top10  %&gt;%\n  group_by(section_name) %&gt;%\n  mutate(partner_count = n_distinct(partner_name)) %&gt;%\n  ungroup()\n\nread_wits_turkey_data_with_partners_top10 &lt;- read_wits_turkey_data_with_partners_top10 %&gt;%\n  group_by(section_name) %&gt;%\n  mutate(cagr = ((trade_value_usd_imp[2020]/trade_value_usd_imp[2015])^(1/5)-1)*100) %&gt;%\n  ungroup()\n\nread_wits_turkey_data_with_partners_top10 &lt;- read_wits_turkey_data_with_partners_top10 %&gt;%\n  filter(year == 2020) %&gt;%\n  group_by(section_name) %&gt;%\n  mutate(total_trade_value_imp_2020 = sum(trade_value_usd_imp)/1000000) %&gt;%\n  ungroup()\n\n# Truncate section names to the first 50 characters\nread_wits_turkey_data_with_partners_top10$truncated_name &lt;- str_trunc(read_wits_turkey_data_with_partners_top10$section_name, 50)\n\n# Get distinct truncated names for colors\ncolor_names &lt;- read_wits_turkey_data_with_partners_top10$truncated_name\n\nggplot(read_wits_turkey_data_with_partners_top10, aes(x = partner_count, y = total_trade_value_imp_2020, size = cagr, color = truncated_name)) +\n  geom_point(alpha = 0.7) +\n  scale_size_continuous(range = c(3, 15)) +\n  scale_y_continuous(limits = c(min(read_wits_turkey_data_with_partners_top10$total_trade_value_imp_2020), max(read_wits_turkey_data_with_partners_top10$total_trade_value_imp_2020) + 5)) + # adjust y-axis scale\n  scale_x_continuous(limits = c(min(read_wits_turkey_data_with_partners_top10$partner_count), max(read_wits_turkey_data_with_partners_top10$partner_count) + 5)) +  # adjust x-axis scale\n  scale_color_manual(values = scales::hue_pal()(length(unique(read_wits_turkey_data_with_partners_top10$section_name)))) +  # Use a different color palette\n  labs(title = \"Import Partner and Import Value Growth Analysis for Top 10 Product Categories\",\n       x = \"Number of Importers\",\n       y = \"Total Import mn USD (2020) \",\n       size = \"5 year CAGR\", \n       color = \"Section Name\") +\ntheme(\n    legend.position = \"right\",  \n    legend.box = \"horizontal\",   \n    legend.margin = margin(t = 0, r = 0, b = 0, l = 0)  \n    \n  )\n\n\n\n\n\nTurkey showcases a diverse range of trading partners. Let’s explore further to identify those that are among the top 10 for both exports and imports.\n\n\nTop 10 Trading Partners\nThe chart presented here illustrates the top 10 trade partners in each column along with the average annual bilateral trading value (a total of exports and imports) on y-axis for each trade partners on x- axis during analysis period (2002-2020).\nKey Findings:\nTop 10 trade partners’ trade value (total exports+imports) with Turkey throughout the analysis period constitute 51% of total trade value\nTurkey has strong relations with neighboring countries - closest relationship with Germany - followed by major economies such as China, USA and Russia.\nImportant aspects to consider with this analysis include, showing Turkey’s dependency on key trade partners by product categories.\n\n\nCode\ntop_partners &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(partner_name) %&gt;%\n  summarize(total_trade = sum(trade_value_usd_exp + trade_value_usd_imp)/19000000) %&gt;%\n  arrange(desc(total_trade)) %&gt;%\n  top_n(10)\n\n# Get a color palette from RColorBrewer\npartner_colors &lt;- brewer.pal(length(top_partners$partner_name), \"Set3\")\n\n# Visualize top trading partners\nggplot(data = top_partners, aes(x = reorder(partner_name, -total_trade), y = total_trade, fill = partner_name)) +\n  geom_bar(stat = \"identity\", color = \"black\") +\n  labs(title = \"Top 10 Trading Partners (2002-2022)\", x = \"Partner\", y = \"Average Trade Value (Exp+Imp)  (mnUSD)\") +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  scale_fill_manual(values = partner_colors)+\n  theme(legend.position = \"none\")\n\n\n\n\n\nLet’s delve deeper into the analysis by specifically examining Turkey’s net exporter/importer position, the trading partners with whom Turkey increased its relations within the analysis period and on which the product categories Turkey is most dependent for its importers and holding a strong export position.\nThe chart presented here illustrates the top 10 trade partners in each column along with total of exports, imports and net trade values (export-import) on y-axis for each trade partners on x-axis during analysis period (2002-2020).\nKey Findings:\nTurkey predominantly maintains a net importer position among its major trading partners, with the exceptions of the United Kingdom and Iraq on an aggregate level throughout the analysis period. Notably, Turkey exhibits a higher dependency on Russia and China compared to other partners.\n\n\nCode\n# Calculate total trade for each partner\npartners &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(partner_name) %&gt;%\n  summarize(total_trade = sum(trade_value_usd_exp + trade_value_usd_imp)) %&gt;%\n  arrange(desc(total_trade)) %&gt;%\n  top_n(10)\n\n# Calculate total export and import for each top partner\ntop_partners &lt;- read_wits_turkey_data_with_partners %&gt;%\n  filter(partner_name %in% partners$partner_name) %&gt;%\n  group_by(partner_name) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp),\n            total_import = sum(trade_value_usd_imp)) %&gt;%\n  arrange(desc(total_export + total_import)) %&gt;%\n  top_n(10)%&gt;%\n  na.omit() \n\n# Calculate the net difference\ntop_partners &lt;- top_partners %&gt;%\n  mutate(trade_difference = total_export - total_import)%&gt;%\n  na.omit() \n\n\n# Visualize import and export relations with top trading partners\nggplot(data = top_partners, aes(x = reorder(partner_name, -total_export - total_import))) +\n  geom_bar(aes(y = total_export, fill = \"Export\"), stat = \"identity\", position = \"dodge\",color = \"darkgray\", linetype = \"dashed\" ) +\n  geom_bar(aes(y = -total_import, fill = \"Import\"), stat = \"identity\", position = \"dodge\",color = \"darkgray\", linetype = \"dashed\") +\n  geom_bar(aes(y = trade_difference, fill = factor(sign(trade_difference))),\n           stat = \"identity\", position = \"dodge\", color = \"black\", alpha=0.7) +\n  labs(title = \"Import and Export Relations with Top 10 Trading Partners\",\n       x = \"Partner\", y = \"Total Trade Value (USD)\") +\n  scale_fill_manual(values = c(\"Export\" = \"gray\", \"Import\" = \"lightgray\",\n                                \"1\" = \"skyblue3\", \"-1\" = \"lightcoral\"),\n                    name = \"\",\n                    labels = c(\"Turkey net importer\", \"Turkey net exporter\", \"Export\", \"Import\")) +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(axis.text.x = element_text(angle = 90, hjust = 1),\n        legend.position = \"top\")\n\n\n\n\n\nThe chart presented here illustrates the top 10 trade partners on x axis, each column represents Turkey’s net exporter/importer position with their trade value on y-axis. Analysis were made separately for each year within the last 5 years\nKey Findings:\nThis chart gives us a clearer understanding of Turkey’s position for each year during the analysis period. Turkey has transitioned from a net importer to a net exporter for some European countries, such as Spain and France.\n\n\nCode\n# Vector of countries to filter\nselected_countries &lt;- c(\"Germany\", \"Russian Federation\", \"China\", \"Italy\", \"USA\", \"United Kingdom\", \"France\", \"Spain\", \"Iran\", \"Iraq\")\n\ntop_partners &lt;- read_wits_turkey_data_with_partners %&gt;%\n  filter(partner_name %in% selected_countries, year %in% 2015:2020) %&gt;%\n  group_by(partner_name, year) %&gt;%\n  summarize(total_export = sum(trade_value_usd_exp),\n            total_import = sum(trade_value_usd_imp)) %&gt;%\n  mutate(trade_difference = total_export - total_import)\n\n\n# Create a bar plot to show trade comparison with selected trading partners\nggplot(data = top_partners, aes(x = reorder(partner_name, -trade_difference), y = trade_difference/1000000, fill = factor(sign(trade_difference)))) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.8), color = \"black\", height = 1.5) +  # Adjust the 'height' parameter\n  facet_wrap(~year, scales = \"free_y\", ncol = 3) +\n  scale_fill_manual(values = c(\"lightcoral\", \"skyblue3\"), name = \"\",\n                    labels = c(\"Turkey net importer\", \"Turkey net exporter\")) +\n  labs(title = \"Trade Comparison with Top 10 Trading Partners(2015-2020)\",\n       x = \"Partner\",\n       y = \"Trade Difference (Export - Import, mn USD)\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1),\n        legend.position = \"top\")\n\n\n\n\n\nTo gain a better understanding of the partners with whom Turkey has strengthened its relations the most, let’s examine the chart below, which illustrates the 5-year CAGR in total trade values for each trading partner.\nThe chart presented here illustrates the top 10 trade partners on x axis along with 5 year CAGR of their trade value with Turkey on y-axis.\nKey Findings:\nTrade relations with Iraq, special categories that are not well described in the dataset, USA and Spain have seen increased growth in trade values over the last 5 years.\nIn contrast, relations with Germany, France, and the UK have remained relatively flat.\nImportant aspects to consider with this analysis include the trend in product categories with these trading partners\n\n\nCode\n# Replace \"YourFirstYear\" and \"YourEndYear\" with the actual years that is selected for the analysis\nfirst_year &lt;- 2015\nend_year &lt;- 2020\n\n# Calculate the total trade value for the first and end years for each partner\ntotal_trade_by_partner &lt;- read_wits_turkey_data_with_partners %&gt;%\n  group_by(partner_name) %&gt;%\n  summarise(total_trade_first = sum(trade_value_usd_imp[year == first_year] + trade_value_usd_exp[year == first_year]),\n            total_trade_end = sum(trade_value_usd_imp[year == end_year] + trade_value_usd_exp[year == end_year]))\n\n# Find the top 10 partners based on the total trade value\ntop_10_partners &lt;- total_trade_by_partner %&gt;%\n  top_n(10, wt = total_trade_end)\n\n# Calculate the percentage change\npercentage_change &lt;- top_10_partners %&gt;%\nmutate(percentage_change = ((total_trade_end/total_trade_first)^(1/5)-1)*100)\n\n# Create a lollipop chart\nggplot(percentage_change, aes(x = reorder(partner_name, percentage_change), y = percentage_change)) +\n  geom_segment(aes(xend = reorder(partner_name, percentage_change), yend = 0), color = \"skyblue\", size = 1) +\n  geom_point(color = \"red\", size = 3) +\n  labs(title = \"Top 10 Partners: 5 year CAGR growth in Total Trade Value by 2020\",\n       x = \"Partner\",\n       y = \"5 year CAGR growth in Total Trade Value\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\n\n\n\n\nOn which category Turkey was the most export revenue generative, let’s have a look at the below chart:\nThe chart presented here illustrates the top 10 export partners on x axis, each column represent top product categories, with annual export revenue generated from them on y-axis.\nKey Findings:\nMajor export partners of Turkey imported textile and its articles which are followed by vehicles, aircraft and machinery and mechanical components.\nExport product categories do not vary significantly among the top export partners, except for China, which notably imports mineral products the most.\nImportant aspects to consider with this analysis include a further examination on product concentration with these trading partners\n\n\nCode\n# Filter data for Iraq, Spain, and USA\ntrade_data_selected_partners&lt;- read_wits_turkey_data_with_partners %&gt;%\n  filter(partner_name %in% c(\"Germany\",\"Russian Federation\",\"China\", \"United Kingdom\", \"Iraq\", \"Spain\", \"USA\",\"Iran\", 1))\n\n# Add a new column for total trade\ntrade_data_selected_partners &lt;- trade_data_selected_partners%&gt;%\n  mutate(total_trade_exp = (trade_value_usd_exp)/19000000)\n\n# Group by section_name and calculate total trade values for each section_name\ntotal_trade_values_19_year &lt;- trade_data_selected_partners %&gt;%\n  filter(year &gt;= 2002 & year &lt;= 2020) %&gt;%\n  group_by(section_name, partner_name) %&gt;%\n  summarise(total_exp_value = sum(total_trade_exp))\n\n# Filter top 5 section names\nfiltered_commodity_data &lt;- total_trade_values_19_year %&gt;%\n  group_by(partner_name) %&gt;%\n  arrange(desc(total_exp_value)) %&gt;%\n  slice_head(n=5)\n\n# Truncate section names to the first 20 characters\nfiltered_commodity_data$truncated_name &lt;- str_trunc(filtered_commodity_data$section_name, 25)\n\n# Set up the color palette\ncolors &lt;- brewer.pal(length(unique(filtered_commodity_data$truncated_name)), \"Set3\")\n\n# Map colors to truncated section names\ncolor_mapping &lt;- setNames(colors, unique(filtered_commodity_data$truncated_name))\n\n# Use the color_mapping in ggplot\nggplot(filtered_commodity_data, aes(x = partner_name, y = total_exp_value, fill = truncated_name)) +\n  geom_col() +\n  scale_fill_manual(values = color_mapping) +  # Set manual color scale\n  labs(title = \"Average Annual Export Breakdown by Product Category and Partner (2002-2020)\",\n       x = \"Partner Name\", y = \"Annual Export Revenue mn USD\",\n       fill = \"Sections\") +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(legend.position = \"bottom\") +\n  guides(fill = guide_legend(nrow = 4))\n\n\n\n\n\nOn which category Turkey was the dependent, let’s have a look at importers chart:\nThe chart presented here illustrates the top 10 import partners on x axis, each column represent top product categories, with annual import value on y-axis.\nKey Findings:\nTurkey’s major trade partners are Russia, Germany and China as previously noted.\nDuring EDA, we have realized that energy is not categorized in this dataset of which seems under NA in this illustration. Turkey’s energy dependency to Russia and Iran of which are major natural gas, crude and mineral suppliers of Turkey. Turkey terminated its crude supplies from Iran after 2018 when US imposed sanctions on Iranian products.\nExamining Turkey’s major imports, it becomes evident that China and Germany play pivotal roles, particularly in the supply of machinery and mechanical components vital for industrial processes.\nConversely, Turkey exhibits minimal dependency on textile and vegetable imports, reflecting its advantageous position as a net exporter in these product categories.\nImportant aspects to consider with this analysis include a further examination on product concentration with these trading partners\n\n\nCode\n# Filter data for Iraq, Spain, and USA\ntrade_data_selected_partners&lt;- read_wits_turkey_data_with_partners %&gt;%\n  filter(partner_name %in% c(\"Germany\",\"Russian Federation\",\"China\", \"United Kingdom\", \"Iraq\", \"Spain\", \"USA\",\"Iran\", 1))\n\n# Add a new column for total trade\ntrade_data_selected_partners &lt;- trade_data_selected_partners%&gt;%\n  mutate(total_trade_imp = (trade_value_usd_imp)/19000000)\n\n# Group by section_name and calculate total trade values for each section_name\ntotal_trade_values_19_year &lt;- trade_data_selected_partners %&gt;%\n  filter(year &gt;= 2002 & year &lt;= 2020) %&gt;%\n  group_by(section_name, partner_name) %&gt;%\n  summarise(total_imp_value = sum(total_trade_imp))\n\n# Filter top 5 section names\nfiltered_commodity_data &lt;- total_trade_values_19_year %&gt;%\n  group_by(partner_name) %&gt;%\n  arrange(desc(total_imp_value)) %&gt;%\n  slice_head(n=5)\n\n# Truncate section names to the first 20 characters\nfiltered_commodity_data$truncated_name &lt;- str_trunc(filtered_commodity_data$section_name, 25)\n\n# Set up the color palette\ncolors &lt;- brewer.pal(length(unique(filtered_commodity_data$truncated_name)), \"Set3\")\n\n# Map colors to truncated section names\ncolor_mapping &lt;- setNames(colors, unique(filtered_commodity_data$truncated_name))\n\n# Use the color_mapping in ggplot\nggplot(filtered_commodity_data, aes(x = partner_name, y = total_imp_value, fill = truncated_name)) +\n  geom_col() +\n  scale_fill_manual(values = color_mapping) +  # Set manual color scale\n  labs(title = \"Average Annual Import Breakdown by Product Category and Partner (2002-2020)\",\n       x = \"Partner Name\", y = \"Total Import mn USD\",\n       fill = \"Sections\") +\n  geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", size = 0.5) +  # Add horizontal line at y = 0\n  theme(legend.position = \"bottom\") +\n  guides(fill = guide_legend(nrow = 4))"
  },
  {
    "objectID": "finalreport.html#key-takeways",
    "href": "finalreport.html#key-takeways",
    "title": "3  Final Report",
    "section": "Key Takeways",
    "text": "Key Takeways\n\nFor the analysis period which is between 2002 and 2020, Turkey kept its net importer position in majority of the product categories that are primarily used as intermediary goods.\nTurkey’s dependence on energy and natural resources is concentrated, posing a significant risk if relations with Russia and Iran were to deteriorate. A similar vulnerability is observed in machinery and mechanical components, suggesting the need for diversification or incentives to encourage local production.\nTurkey has close relations with Europe, taking advantage of being a signatory of custom union with the EU. On the contrary; the exposure to Europe, as evidenced in this study, underscores a category risk for Turkey. Economic downturns or recessions in Europe significantly impact Turkey’s exports and imports.\nWhile Turkey boasts more than 200 trading partners for both exports and imports, the high revenue-generating product categories lack diversification. Most of the top 10 product categories show stagnant or declining growth in USD values. This signals the importance of exploring new markets and expanding the product portfolio to mitigate risks associated with concentrated trade.\nAs the main outcome; this study reveals Turkey’s heavy reliance on intermediate goods and a relatively lower emphasis on strategic investments in R&D and incentives for a skilled workforce, pointing out a necessity of adopting a new economic model, which encourages innovation, reduces dependence on intermediates, increasing diversification of trade partners and ensures a more sustainable and resilient trade ecosystem."
  },
  {
    "objectID": "finalreport.html#introduction",
    "href": "finalreport.html#introduction",
    "title": "3  Final Report",
    "section": "Introduction",
    "text": "Introduction\nOur group project, “Turkey Analysis: Trade Balance & Partners” delves into the details of Turkey’s international trade landscape from 2002 to 2020.\nUtilizing the data aggregation capabilities of WITS, our analysis covers Turkey’s export & import dynamics and its relations with trade partners during this significant period. The data, sourced from a package developed by a team led by Mauricio Vargas provides a comprehensive overview of Turkey’s trade dynamics.\nThroughout our analysis, we uncovered key findings that include the consistent upward trajectory of Turkey’s exports and imports, the influence of global events such as the financial crisis and the impact of monetary policies and currency fluctuations. Notably, Turkey has maintained a persistent foreign trade deficit, with fluctuations and intriguing trends observed in different years.\nOur exploration extends to product categories, revealing that certain sectors, like textiles and machinery, significantly contribute to Turkey’s export revenue. On the import side, machinery and base metals play a crucial role. We also delve into the trends of these categories over the years, identifying fluctuations and their potential drivers.\nAdditionally, our analysis scrutinizes Turkey’s trade partnerships, highlighting the country’s diverse range of trading allies. We examine the top trading partners, Turkey’s net exporter/importer positions, and the evolution of trade relations over the last five years."
  },
  {
    "objectID": "finalreport.html#outcomes",
    "href": "finalreport.html#outcomes",
    "title": "3  Final Report",
    "section": "Outcomes",
    "text": "Outcomes\n\nExports & Imports Analysis\nTurkey has experienced a consistent upward trajectory in both exports and imports from 2002 to 2020, as measured in USD values, influenced by factors such as global crisis, commodity shocks and changes in macroeconomic policies and currency exchange rates. After the 2001 crisis, Turkey changed its monetary policy and floating exchange rate application which significantly changed Turkey’s trade dynamics1. A notable slowdown in total trade values occurred in 2009, coinciding with the global financial crisis of 2008 when total trade deficit of Turkey was at $39 billion. In this period, EU market which receives almost 50 percent of Turkey’s exports went through rapid contraction and the efforts to change the destination of exports toward Middle East and North Africa markets could not compensate for the loss2. Between 2011 and 2014, Turkey witnessed an expansion in its foreign trade deficit, which then started to decrease from 2015 until 2020, except for a notable spike in 2017. During this period, Turkey’s foreign trade deficit narrowed to $63 billion in 2015 from $85 billion in 2014 and $100 billion in 2013.\nThe decrease in oil prices and downward trend in commodity prices was contributed to the reduction of Turkey’s foreign trade deficit in 2015. According to a study3, intermediate goods trade deficit in Turkey’s economy is about twice the size of the total trade deficit and oil price shocks have more permanent and effective impact on the intermediate goods trade balance. Turkey’s dependency on intermediate goods will be presented in detail in the upcoming sections. On the other hand, the decline in 2015 can be attributed to the implementation of quantitative easing in Europe, implemented after European debt crisis and recession, leading to an increased money supply in the region and devalued EUR against USD.\nEU and G20 countries have always been as crucial economic partners for Turkey and euro-dollar parity plays a significant role in affecting Turkey’s trade values. The head of the Exporters’ Assembly of Turkey (TİM) during that period stated that, despite an increase in export amounts, the adverse impact of the euro-dollar parity amounted to ~$750 million on exports in the first 11 months of 2015.\nSpike in 2017 can be attributed to increase in energy bills due to higher oil prices. Subsequently, the impact of non-monetary gold imports and exports began to play a significant role in trade statistics. Slowdown in economic activity, stemming from the currency crisis in August 2018, played a significant role on narrowing foreign deficit in 2019. Weakening economic activity on a global scale due to pandemic in 2020 have resulted in lower exports compared to imports, that resulted in wider foreign trade deficit.\nWe will delve deeper into the yearly dynamics and extend our analysis by examining product categories and trade partners.\n\n\n\n\n\n\n\n\n\n\n\nTop Export Product Categories\nTurkey’s annual export revenue on average throughout the analysis period is ~125bn USD.\nTurkey’s top 10 export revenues constitute 89% of total export income.\nTextiles and apparel, machinery and equipment, vehicles and associated equipment as well as base metals and mineral products are the significant contributors to Turkey’s export revenue.\nFindings from a study conducted by the TIM4, which defines the top 1000 exports, align with our observations. Prominent exporter companies in Turkey are engaged in the export of vehicles and spare parts, home appliances, and the export of base metals and mineral products. Examples include engine manufacturers and auto-makers, Ford Otosan, Toyota, Oyak-Renault, foreign trade company Kibar, major home appliances producers Vestel and Arcelik, automaker and energy firms Tupras and Socar. The study also highlights the presence of textile manufacturers on the list, although they may not be top-rated, indicating a higher number of companies in this category compared to others in Turkey.\nIn the second chart, the initial decline in export values across all product categories aligns with the 2008 crisis. Upon examining the yearly patterns of each product category, it becomes evident that vegetable products, plastics, and foodstuffs stand out as the most resilient to external factors, showcasing inelastic demand and maintaining their resilience against macroeconomic events. Peak in vegetable exports occurred in 2020 during the entire analysis period.\nFollowing its peaks in 2012 and 2013, a notable decrease in the exports of natural and mineral products occurred after 2015. This decline can be attributed largely to China’s reduction in incentives within the construction industry, as being Turkey’s top export partner in this product category5.\nIn 2020, a downward trend was noted in almost every product category with the weakening economic activity on a global scale due to pandemic, except the resilient ones mentioned earlier.\n\n\n\n\n\n\n\n\n\n\n\n\nTop Import Product Categories\nTurkey’s import value on average throughout the analysis period is ~183 bn USD.\nTurkey’s top 10 import value constitute 81% of total imports.\nMachinery and equipment, base metals and their articles, mineral products, chemicals as well as vehicles and associated equipment constitute the primary import categories contributing to Turkey’s import value. There is a substantial import of investment goods, components and parts, along with unprocessed materials used in industrial activities. Sectors with the highest import requirements are the ones with higher capital and technology intensity6 .This highlights Turkey’s dependence on a significant influx of intermediate goods and FDIs.\nUncategorized value, labelled as NA has an average of $21 billion of import bill throughout the analysis period, fills a gap in this analysis that we haven’t touched upon, which is the energy dependency of Turkey. Between 2002 and 2020, Turkey’s average energy bill, as reported by the Turkish Statistical Institute in the Foreign Trade Indicators, amounts to $31 billion. This constitutes 17% of Turkey’s total imports, playing a significant role in driving the economy.\nSecond chart also proves that Turkey’s exports are concentrated in the sectors where the use of imported inputs has expanded during the past two decade.7 The third chart explicitly highlights Turkey’s import dependency, underscoring the critical need to enhance local input production. This transition is crucial in order to position Turkey with its price advantage (undervalued TL), boost export profitability and enhance its competitiveness in the international market.\nBased on these observations, there is a need for a strategic focus on R&D investments and incentives for a highly skilled workforce. This is crucial for adoption of a new economic model, which Turkey could leverage to reduce its reliance on intermediate goods.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrade Partnership Analysis\n\nDiversification of Export Revenue Streams by Top 10 Product Category\nEnsuring a broad range of diverse trade partners is crucial for any country in order to diversify its export and import streams and serves as a risk mitigation strategy, particularly in the face of any possible geopolitical challenges.\nWe have identified that Turkey engages with more than 200 distinct export partners across its top 10 product categories, showcasing a diversified revenue stream. As previously noted in the above sections, Textiles and Apparel, Vehicles and Associated Equipment and Base Metals and Mineral Products stand out as significant contributors to Turkey’s export revenue.\nIn the last five years, leading revenue contributor, textiles has shown a stagnant trend. Meanwhile, revenue generated from second and third highest sources, namely vehicles and equipment and base metals have been declining during this period. Conversely, Mineral Products, Miscellaneous Manufactured Articles, Vegetable Products and Plastics demonstrated an increased capacity for revenue generation albeit still trailing behind the primary product categories mentioned earlier.\n\n\n\n\n\n*Each bubble represents 5 year CAGR (2015-2020) for each product category\n\n\nDiversification of Import Revenue Streams by Top 10 Product Category\nThrough this analysis, we have identified that Turkey’s dependency is diversified and country engages with more than 200 distinct import partners across its top 10 product categories, excluding natural product categories (mostly composed of semi-precious products, stones and powder).\nIn the last five years, import stream from machinery and mechanical appliances have been declining which has the highest contribution to import value of Turkey and has the highest distinct number of trading partners. Meanwhile, import values of vehicles and equipment and chemicals were flat during this period. Conversely, plastics demonstrated a substantial increased import value over the last five years. After China banned plastic waste imports, Turkey became one of the world’s primary destinations for the global plastic waste trade.8\n\n\n\n\n\n*Each bubble represents 5 year CAGR (2015-2020) for each product category\n\n\nTop 10 Trading Partners\nTop 10 trade partners’ trade value (total exports+imports) with Turkey throughout the analysis period constitute 51% of total trade value.\nTurkey has strong relations with neighboring countries - close relations with Germany and Italy - followed by major economies such as China, USA and Russia.\nGermany ranked as the number one destination for Turkey, having solidified the roots of the relationship between the two countries during postwar economic boom. This connection further expanded after the establishment of the Customs Union.\nSince 1991, Turkey and Russia, as countries with a shared maritime border, have been enhancing their trade cooperation. Russia has emerged as a significant supplier of energy sources to Turkey, while in return, Turkey offers extensive tourism and construction services9. \nIntroduction of Belt & Road Initiative which was introduced by China in 2013, is a multinational effort to revive Silk Road and carry out trade through Far East Asia and Europe, with feeding different continents and countries along the way10.Turkey plays a strategic role due to its close proximity to both Asia and Europe. Being a signatory of this initiative and strong bilateral relationships with China further enhances its strategic position.\nTurkey predominantly maintains a net importer position among its major trading partners, with the exceptions of the United Kingdom and Iraq on an aggregate level throughout the analysis period, as exhibited in the second chart. Notably, Turkey shows a higher dependency on Russia and China compared to other partners.\nThe third chart provides a clearer understanding of Turkey’s position for each year during the analysis period. Turkey has transitioned from a net importer to a net exporter for some European countries, such as Spain and France.\nFourth chart presents a better understanding of the partners with whom Turkey has strengthened its relations the most. Trade relations with Iraq, special categories that are not well described in the dataset, USA and Spain have seen increased growth in trade values over the last 5 years. In contrast, relations with Germany, France, and the UK have remained relatively flat.\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\nAbove chart does not represent net trading value and Turkey’s trading position. Trading values are calculated by summing up total export and import values for each year and results indicate average values during analysis period.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTrade Partner Analysis by Product Categories\nMajor export partners of Turkey imported textile and its articles which are followed by vehicles, aircraft and machinery and mechanical components from Turkey. Turkey collaborates with Germany, Spain, and the UK in the defense industry, maintaining its relationship through NATO as well.\nExport product categories do not vary significantly among the top export partners, except for China, which notably imports mineral products the most. According to a study, Turkey’s mineral exports are moderately concentrated and this concentration is mainly caused by excessive mineral exports to China11\nTurkey’s major import partners are Russia, Germany and China as previously noted and exhibited in the second chart. Turkey’s energy dependency to Russia and Iran of which are major natural gas, crude and mineral suppliers of Turkey. Turkey decreased its trading volume with Iran after USA urged Turkey to impose sanction in 2012 and 2018. Crude supplies were terminated in 2018 accordingly. Examining Turkey’s major imports, it becomes evident that China and Germany play pivotal roles, particularly in the supply of machinery and mechanical components vital for industrial processes. Conversely, Turkey exhibits minimal dependency on textile and vegetable imports, reflecting its advantageous position as a net exporter in these product categories."
  },
  {
    "objectID": "finalreport.html#conclusion",
    "href": "finalreport.html#conclusion",
    "title": "3  Final Report",
    "section": "Conclusion",
    "text": "Conclusion\nIn conclusion, over these two decades, Turkey’s exports and imports have steadily risen, influenced by global events like the financial crisis, commodity shocks and changes in macroeconomic policies. Notably, the shift in Turkey’s monetary policy after the 2001 crisis, adopting a floating exchange rate, significantly impacted trade dynamics.\nDespite facing a persistent foreign trade deficit, Turkey has showcased its ability to navigate through economic downturns. The global financial crisis of 2008 and the recent pandemic-induced economic slowdown have left their marks, but Turkey has demonstrated its ability to adapt.\nExamining product categories, we’ve identified sectors like textiles, machinery, and base metals as significant contributors to Turkey’s export revenue. On the import side, machinery and base metals continue to play a crucial role, highlighting Turkey’s dependence on a diverse range of intermediate goods.\nOur analysis also delved into the country’s trade partnerships, revealing a diverse network of more than 200 export and import partners. Turkey’s strong relations with neighboring countries, especially Germany and Italy, along with major economies like China, the USA, and Russia, underscore its strategic importance in global trade.\nThe charts and trends unveiled throughout our analysis provide actionable insights for Turkey’s future trade strategies. The need to enhance local input production, reduce reliance on intermediate goods and strategically focus on R&D investments emerge as critical considerations for sustaining economic growth. Our analysis serves as a practical guide for informed decision-making, offering valuable lessons for other nations seeking to fortify their economic development."
  },
  {
    "objectID": "finalreport.html#shiny-app-link",
    "href": "finalreport.html#shiny-app-link",
    "title": "3  Final Report",
    "section": "Shiny App Link",
    "text": "Shiny App Link\n\n\nCode\nlibrary(shiny)\nshiny::runGitHub(\"pjournal/mef07g-yellowsubmarine\", subdir = \"/app/app.R\")\n\n\nShiny App Link is here."
  },
  {
    "objectID": "finalreport.html#references",
    "href": "finalreport.html#references",
    "title": "3  Final Report",
    "section": "References",
    "text": "References\nWorld Integrated Trade Solution (World Bank)\nDataset"
  },
  {
    "objectID": "finalreport.html#footnotes",
    "href": "finalreport.html#footnotes",
    "title": "3  Final Report",
    "section": "",
    "text": "Development of International Trade in Turkey: Trends and Changes↩︎\nTrade and Trade Finance in Turkey: What is the Impact of the Finance Problems in the Decrease in Exports?↩︎\nThe Analysis of Turkey’s Trade Balance in response to oil price changes↩︎\nExporters’ Assemby of Turkey↩︎\nEffects of the Covid-19 Pandemic on Turkish Natural Stone Industry↩︎\nImport Content of Turkish Production and Exports: A sectoral analysis↩︎\nImport Content of Turkish Production and Exports: A sectoral analysis↩︎\nWhy Turkey should not import plastic waste pollution from developed countries↩︎\nAn Analysis of Bilateral Trade Relation Between Turkey and Russia, Marina Kramskova, Dokuz Eylul University, 2022↩︎\n[International Trade between Turkey and China] (https://dergipark.org.tr/tr/download/article-file/2939520)↩︎\nContribution and/or dependency: Chinese hegemony on Turkey’s mineral export↩︎"
  },
  {
    "objectID": "presentation.html",
    "href": "presentation.html",
    "title": "4  Presentation",
    "section": "",
    "text": "Here you can find Presentation Codes:\n\nPresentation Code\n\nHere you can find Presentation in HTML :\n\nPresentation Code\n\nHere you can find Presentation in PDF :\n\nPresentation Code"
  },
  {
    "objectID": "assignment1.html#group-assignment-for-global-dietary-database",
    "href": "assignment1.html#group-assignment-for-global-dietary-database",
    "title": "5  Assignment 1",
    "section": "5.1 Group Assignment For Global Dietary Database",
    "text": "5.1 Group Assignment For Global Dietary Database\nIn this analysis, we delve into the Global Dietary Database to scrutinize Vitamin B12 intake among Former Soviet Union countries. Employing the analytical prowess of ‘dplyr’ and ‘ggplot2’ in R, our aim is to uncover patterns and variations, offering a data-driven perspective on nutritional habits within this geopolitical region.\nGlobal Dietary Database\nDataset\n\n\n# Soviet Union data cleaned up and inserted average column by calculating the mean\nsoviet_union_abbreviations &lt;- c(\"ARM\", \"AZE\", \"BLR\", \"EST\", \"GEO\", \"KAZ\", \"KGZ\", \"LVA\", \"LTU\", \"MDA\", \"RUS\", \"TJK\", \"TKM\", \"UKR\", \"UZB\")\n\nsoviet_union_data &lt;- data %&gt;%\n  filter(country %in% soviet_union_abbreviations)\n\n\n# Full country names\ncountry_names &lt;- c(\n  \"Armenia\", \"Azerbaijan\", \"Belarus\", \"Estonia\", \"Georgia\", \"Kazakhstan\", \"Kyrgyzstan\", \"Latvia\", \"Lithuania\", \"Moldova\",\n  \"Russia\", \"Tajikistan\", \"Turkmenistan\", \"Ukraine\", \"Uzbekistan\"\n)\n\n# Replace country abbreviations with full names\nsoviet_union_data$country &lt;- factor(soviet_union_data$country, levels = soviet_union_abbreviations, labels = country_names)\n\n\n\n5.1.1 B12 Intakes Total Averages by Country\nThe following plot displays the total averages of B12 intakes for each country in the Former Soviet Union. The bars represent the mean B12 intake, providing an overview of the variations across the different countries.\n\n# Group by Country\ngroup_by_country_data &lt;- soviet_union_data %&gt;%\n  group_by(country) %&gt;%\n  summarise(avg_b12 = mean(average, na.rm = TRUE))\n\n# Plotting the data with geom_bar\nggplot(group_by_country_data, aes(x = country, y = avg_b12, fill = country)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.8), alpha = 0.7) +\n  labs(title = \"B12 Intakes Total Averages by Country\",\n       x = \"Country\",\n       y = \"B12 intakes Total Average\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_viridis_d()  + \n  # Increase bar width\n  theme(legend.position = \"none\") +\n  geom_text(aes(label = round(avg_b12, 2)), vjust = -0.5, position = position_dodge(width = 0.8)) \n\n\n\n\n\n\n\n5.1.2 B12 Intakes Total Averages by Country and Gender\nThe following plot further breaks down the B12 intakes by gender within each country. The stacked bars show the mean B12 intake for both male and female individuals, providing insights into gender-specific patterns across the Former Soviet Union. ::: {.cell}\n# Group by Country and Gender\ngroup_by_country_gender_data &lt;- soviet_union_data %&gt;% filter(gender!='NA')%&gt;%\n  group_by(country, gender) %&gt;%\n  summarise(avg_b12 = mean(average, na.rm = TRUE), .groups = 'drop')\n\n# Plotting the data with geom_bar (stacked)\nggplot(group_by_country_gender_data, aes(x = country, y = avg_b12, fill = factor(gender))) +\n  geom_bar(stat = \"identity\", position = \"stack\", alpha = 0.7) +\n  labs(title = \"B12 Intakes Total Averages by Country and Gender\",\n       x = \"Country\",\n       y = \"B12 Intakes Total Average\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_viridis_d(name = \"Gender\", labels = c(\"Male\", \"Female\")) +\n  # Increase bar width\n  theme(legend.position = \"top\") +\n  geom_text(aes(label = round(avg_b12, 2)), position = position_stack(vjust = 0.5))\n\n\n\n:::\n\n\n\n5.1.3 B12 Intakes Total Averages by Country and Year\nThis plot unveils the nuanced trends in mean B12 intake across years for Former Soviet Union countries. Stacked bars represent the average B12 intake, providing insights into variations over time within each country.\n\n# Group by Year and Country\ngroup_by_country_year_data &lt;- soviet_union_data %&gt;% filter(gender!='NA')%&gt;%\n  group_by(year, country) %&gt;%\n  summarise(avg_b12 = mean(average, na.rm = TRUE), .groups = 'drop')\n\n# Plotting the data\nggplot(group_by_country_year_data, aes(x = year, y = avg_b12, color = country,alpha = 0.7)) +\n  geom_line(linewidth = 1) +\n  labs(title = \"Average B12 intake by Year and Country\",\n       x = \"Year\",\n       y = \"Average B12 intake\") \n\n\n\n\n\n\n\n5.1.4 Dynamic Insights: Age-Stratified Trends in B12 Intake Across Former Soviet Union Nations\nExploring age group dynamics in B12 intake across Former Soviet Union nations, this plot employs stacked bars to illustrate average intake trends over time. The concise representation unveils nuanced patterns, providing insight into the evolving nutritional habits within each country and highlighting age-specific variations in B12 consumption.\n\nraw_df &lt;- read.csv(url)\n#Change column names & column data\nraw_data &lt;- select(raw_df,country = iso3, age:upperci_95)\n\nsoviet_data &lt;- filter(raw_data, country %in% c(\"ARM\", \"AZE\", \"BLR\", \"EST\", \"GEO\", \"KAZ\", \"KGZ\", \"LVA\", \"LTU\", \"MDA\", \"RUS\", \"TJK\", \"TKM\", \"UKR\", \"UZB\"))\n\ncountry_mapping &lt;- c(\"ARM\"=\"Armenia\", \"AZE\"=\"Azerbaijan\", \"BLR\"=\"Belarus\", \"EST\"=\"Estonia\", \"GEO\"=\"Georgia\", \"KAZ\"=\"Kazakhstan\", \"KGZ\"=\"Kyrgyzstan\", \"LVA\"=\"Latvia\", \"LTU\"=\"Lithuania\", \"MDA\"=\"Moldova\", \"RUS\"=\"Russia\", \"TJK\"=\"Tajikistan\", \"TKM\"=\"Turkmenistan\", \"UKR\"=\"Ukraine\", \"UZB\"=\"Uzbekistan\") \n\nsoviet_data$country_full_name &lt;- country_mapping[soviet_data$country]\n\nsoviet_data[soviet_data == 999] &lt;- \"All\"\n\nsoviet_data &lt;- soviet_data %&gt;%\n\n#Calculate mean\nmutate(average_calculation = median + ((upperci_95 - lowerci_95) / 2))\n\n#Analyze according to age_range\nage_range &lt;- filter(soviet_data, age %in% c(0.5, 1.5, 2.5, 7.5, 12.5, 17.5, 22.5, 27.5, 32.5, 37.5, 42.5, 47.5, 52.5, 57.5, 62.5, 67.5, 72.5, 77.5, 82.5, 87.5, 92.5, 97.5,\"All\" ))\n\nage_mapping &lt;- (c(\"0.5\" = \"Child\", \"1.5\" = \"Child\", \"2.5\" = \"Child\",\"7.5\" = \"Child\", \"12.5\" = \"Adolescent\", \"17.5 \"= \"Adolescent\", \"22.5\" = \"Adult\", \"27.5\" = \"Adult\", \"32.5\" = \"Adult\", \"37.5\" = \"Adult\", \"42.5\" = \"Adult\",\"47\" = \"Adult\", \"47.5 \"= \"Adult\", \"52.5\" = \"Adult\", \"57.5\" = \"Adult\", \"62.5\" = \"Elderly\",\"67.5\" = \"Elderly\", \"72.5\" = \"Elderly\", \"77.5 \"= \"Elderly\", \"82.5\" = \"Elderly\", \"87.5\" = \"Elderly\", \"92.5\" = \"Elderly\",\"97.5\" = \"Elderly\", \"All\" = \"Undefined\"))\n\nsoviet_data$age_range &lt;- age_mapping[soviet_data$age]\n\n# Group by Age\ngroup_by_age_data &lt;- soviet_data %&gt;%\n  group_by(age_range) %&gt;%\n  summarise(avg_b12 = mean(average_calculation, na.rm = TRUE), .groups = 'drop')\n  na_columns&lt;- which(is.na(group_by_age_data$age_range))\n  group_by_age_data  %&gt;% glimpse()\n\nRows: 6\nColumns: 2\n$ age_range &lt;chr&gt; \"Adolescent\", \"Adult\", \"Child\", \"Elderly\", \"Undefined\", NA\n$ avg_b12   &lt;dbl&gt; 6.798432, 7.007763, 4.648042, 6.366478, 5.683773, 6.402601\n\n# Plotting Histogram\nggplot(group_by_age_data, aes(x = age_range, y = avg_b12, fill = age_range)) +\n  geom_bar(stat = \"identity\", position = \"dodge\", color = \"black\", alpha = 0.7) +\n  labs(title = \"Average B12 Intake by Age Group\",\n       x = \"Age Group\",\n       y = \"Average B12 Intake\") +\n  theme_minimal()"
  }
]
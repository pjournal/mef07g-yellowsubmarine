<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-12-14">

<title>YELLOW SUBMARINE Progress Journal - 3&nbsp; Exploratory Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./preprocesseddata.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./exploratorydataanalysis.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">YELLOW SUBMARINE Progress Journal</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pjournal/mef07g-yellowsubmarine" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Assignment 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocesseddata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preprocessed Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratorydataanalysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-exploratory-data-analysis-on-wits-data" id="toc-introduction-exploratory-data-analysis-on-wits-data" class="nav-link active" data-scroll-target="#introduction-exploratory-data-analysis-on-wits-data"><span class="header-section-number">3.1</span> Introduction: Exploratory Data Analysis on WITS data</a></li>
  <li><a href="#step-1-load-required-libraries" id="toc-step-1-load-required-libraries" class="nav-link" data-scroll-target="#step-1-load-required-libraries"><span class="header-section-number">3.2</span> Step 1: Load Required Libraries</a></li>
  <li><a href="#step-2-load-datasets" id="toc-step-2-load-datasets" class="nav-link" data-scroll-target="#step-2-load-datasets"><span class="header-section-number">3.3</span> Step 2: Load Datasets</a></li>
  <li><a href="#step-3-overview-of-the-datasets" id="toc-step-3-overview-of-the-datasets" class="nav-link" data-scroll-target="#step-3-overview-of-the-datasets"><span class="header-section-number">3.4</span> Step 3: Overview of the Datasets</a></li>
  <li><a href="#step-4-data-cleaning" id="toc-step-4-data-cleaning" class="nav-link" data-scroll-target="#step-4-data-cleaning"><span class="header-section-number">3.5</span> Step 4: Data Cleaning</a></li>
  <li><a href="#step-5-exploratory-data-analysis-eda" id="toc-step-5-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#step-5-exploratory-data-analysis-eda"><span class="header-section-number">3.6</span> Step 5: Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#country-profile" id="toc-country-profile" class="nav-link" data-scroll-target="#country-profile"><span class="header-section-number">3.6.1</span> Country Profile</a></li>
  <li><a href="#exports-imports-analysis" id="toc-exports-imports-analysis" class="nav-link" data-scroll-target="#exports-imports-analysis"><span class="header-section-number">3.6.2</span> Exports &amp; Imports Analysis</a></li>
  <li><a href="#trade-partnership-analysis" id="toc-trade-partnership-analysis" class="nav-link" data-scroll-target="#trade-partnership-analysis"><span class="header-section-number">3.6.3</span> Trade Partnership Analysis</a></li>
  </ul></li>
  <li><a href="#step-6-interpretation-and-conclusions" id="toc-step-6-interpretation-and-conclusions" class="nav-link" data-scroll-target="#step-6-interpretation-and-conclusions"><span class="header-section-number">3.7</span> Step 6: Interpretation and Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 14, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction-exploratory-data-analysis-on-wits-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction-exploratory-data-analysis-on-wits-data"><span class="header-section-number">3.1</span> Introduction: Exploratory Data Analysis on WITS data</h2>
<p>World Integrated Trade Solution (WITS) emerges as a pivotal platform, offering a comprehensive view of international trade dynamics, with a particular focus on Turkey from 2002 to 2020. This powerful tool aggregates data from diverse sources to furnish users with valuable insights into Turkey’s merchandise trade, tariffs, and non-tariff measures during this specific period. With an expansive database, WITS facilitates informed decision-making and strategic planning for researchers, policymakers, and businesses interested in Turkey’s trade landscape.</p>
<p>Embarking on an Exploratory Data Analysis (EDA) journey within WITS involves loading datasets, cleaning data, and employing statistical and visual analyses specific to Turkey’s trade from 2002 to 2020. This process unveils trade patterns, identifies trends, and provides actionable insights, enabling stakeholders to navigate the complexities of Turkey’s trade dynamics during this crucial timeframe. The synergy between WITS and EDA empowers users to make informed decisions and strategic choices, fostering a more interconnected and informed landscape for Turkey’s economy and trade.</p>
<hr>
</section>
<section id="step-1-load-required-libraries" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="step-1-load-required-libraries"><span class="header-section-number">3.2</span> Step 1: Load Required Libraries</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Description: Loading necessary libraries provides access to functions and tools that simplify data manipulation and visualization. dplyr is helpful for data wrangling, and ggplot2 is excellent for creating informative and visually appealing plots.</p>
</section>
<section id="step-2-load-datasets" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="step-2-load-datasets"><span class="header-section-number">3.3</span> Step 2: Load Datasets</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>loaded_datasets <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"wits_data.rds"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_only <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_turkey_data_only</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_turkey_data_with_partners</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>read_wits_all_country_data <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_all_country_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Description: Loading datasets is the initial step in any data analysis. It allows us to bring in the data that we’ll be working with throughout the analysis.</p>
</section>
<section id="step-3-overview-of-the-datasets" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="step-3-overview-of-the-datasets"><span class="header-section-number">3.4</span> Step 3: Overview of the Datasets</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read_wits_turkey_data_only)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'data.table' and 'data.frame':  90663 obs. of  9 variables:
 $ year               : int  2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 ...
 $ reporter_iso       : chr  "tur" "tur" "tur" "tur" ...
 $ reporter_name      : chr  "Turkey" "Turkey" "Turkey" "Turkey" ...
 $ commodity_code     : chr  "010121" "010121" "010121" "010121" ...
 $ commodity_name     : chr  "Horses; live, pure-bred breeding animals" "Horses; live, pure-bred breeding animals" "Horses; live, pure-bred breeding animals" "Horses; live, pure-bred breeding animals" ...
 $ section_code       : chr  "01" "01" "01" "01" ...
 $ section_name       : chr  "Live animals and animal products" "Live animals and animal products" "Live animals and animal products" "Live animals and animal products" ...
 $ trade_value_usd_imp: num  6307262 1231248 958946 1111437 3684454 ...
 $ trade_value_usd_exp: num  0 136000 0 22750 403711 ...
 - attr(*, ".internal.selfref")=&lt;externalptr&gt; 
 - attr(*, "sorted")= chr [1:2] "commodity_code" "section_code"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(read_wits_turkey_data_only)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      year      reporter_iso       reporter_name      commodity_code    
 Min.   :2002   Length:90663       Length:90663       Length:90663      
 1st Qu.:2006   Class :character   Class :character   Class :character  
 Median :2011   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2011                                                           
 3rd Qu.:2016                                                           
 Max.   :2020                                                           
 commodity_name     section_code       section_name       trade_value_usd_imp
 Length:90663       Length:90663       Length:90663       Min.   :0.000e+00  
 Class :character   Class :character   Class :character   1st Qu.:4.259e+05  
 Mode  :character   Mode  :character   Mode  :character   Median :3.138e+06  
                                                          Mean   :3.836e+07  
                                                          3rd Qu.:1.574e+07  
                                                          Max.   :4.073e+10  
 trade_value_usd_exp
 Min.   :0.000e+00  
 1st Qu.:9.152e+04  
 Median :1.150e+06  
 Mean   :2.612e+07  
 3rd Qu.:8.788e+06  
 Max.   :1.334e+10  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read_wits_turkey_data_with_partners)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'data.table' and 'data.frame':  3887005 obs. of  11 variables:
 $ year               : int  2018 2019 2018 2005 2008 2002 2003 2004 2005 2006 ...
 $ reporter_iso       : chr  "tur" "tur" "tur" "tur" ...
 $ reporter_name      : chr  "Turkey" "Turkey" "Turkey" "Turkey" ...
 $ partner_iso        : chr  "arg" "aus" "aut" "aze" ...
 $ partner_name       : chr  "Argentina" "Australia" "Austria" "Azerbaijan" ...
 $ commodity_code     : chr  "010121" "010121" "010121" "010121" ...
 $ commodity_name     : chr  "Horses; live, pure-bred breeding animals" "Horses; live, pure-bred breeding animals" "Horses; live, pure-bred breeding animals" "Horses; live, pure-bred breeding animals" ...
 $ section_code       : chr  "01" "01" "01" "01" ...
 $ section_name       : chr  "Live animals and animal products" "Live animals and animal products" "Live animals and animal products" "Live animals and animal products" ...
 $ trade_value_usd_imp: num  14926 7757 26155 6784 0 ...
 $ trade_value_usd_exp: num  0 0 0 0 10250 ...
 - attr(*, ".internal.selfref")=&lt;externalptr&gt; 
 - attr(*, "sorted")= chr [1:2] "commodity_code" "section_code"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(read_wits_turkey_data_with_partners)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      year      reporter_iso       reporter_name      partner_iso       
 Min.   :2002   Length:3887005     Length:3887005     Length:3887005    
 1st Qu.:2008   Class :character   Class :character   Class :character  
 Median :2013   Mode  :character   Mode  :character   Mode  :character  
 Mean   :2012                                                           
 3rd Qu.:2017                                                           
 Max.   :2020                                                           
 partner_name       commodity_code     commodity_name     section_code      
 Length:3887005     Length:3887005     Length:3887005     Length:3887005    
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
 section_name       trade_value_usd_imp trade_value_usd_exp
 Length:3887005     Min.   :0.000e+00   Min.   :0.000e+00  
 Class :character   1st Qu.:0.000e+00   1st Qu.:4.230e+02  
 Mode  :character   Median :0.000e+00   Median :8.367e+03  
                    Mean   :8.947e+05   Mean   :6.093e+05  
                    3rd Qu.:1.157e+04   3rd Qu.:8.157e+04  
                    Max.   :1.749e+10   Max.   :6.528e+09  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read_wits_all_country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> NULL</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(read_wits_all_country_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Length  Class   Mode 
     0   NULL   NULL </code></pre>
</div>
</div>
<p>Description: Checking the structure and summary of the datasets provides an understanding of the variables, data types, and basic statistics. This helps identify potential issues and informs subsequent cleaning and analysis steps.</p>
</section>
<section id="step-4-data-cleaning" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="step-4-data-cleaning"><span class="header-section-number">3.5</span> Step 4: Data Cleaning</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(read_wits_turkey_data_only, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               year        reporter_iso       reporter_name      commodity_code 
                  0                   0                   0                   0 
     commodity_name        section_code        section_name trade_value_usd_imp 
                  0                   0                  19                   0 
trade_value_usd_exp 
                  0 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># will be done</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Description: Cleaning the data involves addressing missing values and outliers. It ensures that the data is reliable and ready for further analysis.</p>
</section>
<section id="step-5-exploratory-data-analysis-eda" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="step-5-exploratory-data-analysis-eda"><span class="header-section-number">3.6</span> Step 5: Exploratory Data Analysis (EDA)</h2>
<section id="country-profile" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="country-profile"><span class="header-section-number">3.6.1</span> Country Profile</h3>
<table class="table">
<tbody>
<tr class="odd">
<td><strong>Export Ranking:</strong></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Import Ranking:</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Top Trading Partners</strong>:</td>
<td></td>
</tr>
</tbody>
</table>
<p><em>Most available data is as of 2020 year-end:</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate Country Profile Stats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Line Chart: Exports and Imports over the Years:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>total_exports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_exports =</span> <span class="fu">sum</span>(trade_value_usd_exp))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>total_imports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_imports =</span> <span class="fu">sum</span>(trade_value_usd_imp))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize exports and imports over the years</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_exports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_exports, <span class="at">color =</span> <span class="st">"Exports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_imports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_imports, <span class="at">color =</span> <span class="st">"Imports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Turkey's Exports and Imports Over the Years"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Trade Value (USD)"</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Line Chart Description: Analyzing exports and imports over time provides insights into the trade trends of the country. Visualization helps in identifying patterns and understanding the overall trade dynamics</em></p>
<p><strong>Result: Turkey’s status is as a net importer since 2002</strong></p>
</section>
<section id="exports-imports-analysis" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="exports-imports-analysis"><span class="header-section-number">3.6.2</span> Exports &amp; Imports Analysis</h3>
<p><strong>Top 10 product categories are listed in this section both for exports and imports in order to analyze this further by looking into trade partners of these product types</strong></p>
<p><strong>Clustered Column Chart: Diversity of Exported Products</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_export</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>export_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(export_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(export_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> export_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_export), <span class="at">y =</span> total_export, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Exported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Total Export Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description:The “Diversity of Exported Products” graphic provides insights into Turkey’s international trade from 2002 to 2020. It showcases the top 10 product categories that Turkey has predominantly exported over the years. Each product category is represented by a distinct color, offering a visual representation of the diversity and distribution of exported goods. The vertical bars display the total export values in USD for each product category, providing a clear overview of Turkey’s major export sectors. The graphic aids in identifying trends, patterns, and the relative significance of various product categories in Turkey’s export landscape.</em></p>
<p><strong>Bubble Chart: Relationship between Complexity and Annual Export Growth (CAGR Last 5 years) for Top Product Categories</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export)) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_exp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_exp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_exp_2020 =</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(read_wits_turkey_data_with_partners_top10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 222,082 × 14
    year reporter_iso reporter_name partner_iso partner_name commodity_code
   &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;         
 1  2020 tur          Turkey        aze         Azerbaijan   060110        
 2  2020 tur          Turkey        bel         Belgium      060110        
 3  2020 tur          Turkey        chl         Chile        060110        
 4  2020 tur          Turkey        fra         France       060110        
 5  2020 tur          Turkey        geo         Georgia      060110        
 6  2020 tur          Turkey        irq         Iraq         060110        
 7  2020 tur          Turkey        isr         Israel       060110        
 8  2020 tur          Turkey        nld         Netherlands  060110        
 9  2020 tur          Turkey        syr         Syria        060110        
10  2020 tur          Turkey        tkm         Turkmenistan 060110        
# ℹ 222,072 more rows
# ℹ 8 more variables: commodity_name &lt;chr&gt;, section_code &lt;chr&gt;,
#   section_name &lt;chr&gt;, trade_value_usd_imp &lt;dbl&gt;, trade_value_usd_exp &lt;dbl&gt;,
#   partner_count &lt;int&gt;, cagr &lt;dbl&gt;, total_trade_value_exp_2020 &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_exp_2020, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_2020), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_2020) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bubble Chart of Top 10 Section Names"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Export Countries"</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Export Revenue mn USD (2020) "</span>,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: Complexity represents count of Turkey’s export partners for each product category that are defined in Analysis of Diversity of Exported Products, that are shown on x axis. Compounded growth rates of exports are represented on y axis. Each bubble represents exports value as of 2020 for each product category.</em></p>
<p><strong>Clustered Column Chart: Diversity of Imported Products</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>imported_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_import</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>imported_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(imported_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(imported_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> imported_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_import), <span class="at">y =</span> total_import, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Imported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Total Import Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: The “Diversity of Imported Products” graphic illustrates the diversity of products that Turkey has imported from other countries between 2002 and 2020. Similar to the exported products graphic, this visualization highlights the top 10 imported product categories. Each category is uniquely colored for easy identification. The vertical bars display the total import values in USD for each product category, offering insights into the composition of Turkey’s imports. This graphic assists in understanding the import dynamics, identifying significant product categories, and discerning patterns in Turkey’s international trade relationships.</em></p>
<p><strong>Bubble Chart: Relationship between Complexity and Annual Import Growth (CAGR Last 5 years) for Top Product Categories</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_imp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_imp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_imp_2020 =</span> <span class="fu">sum</span>(trade_value_usd_imp)<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(read_wits_turkey_data_with_partners_top10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 209,510 × 14
    year reporter_iso reporter_name partner_iso partner_name commodity_code
   &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;         
 1  2020 tur          Turkey        aze         Azerbaijan   060110        
 2  2020 tur          Turkey        bel         Belgium      060110        
 3  2020 tur          Turkey        chl         Chile        060110        
 4  2020 tur          Turkey        fra         France       060110        
 5  2020 tur          Turkey        geo         Georgia      060110        
 6  2020 tur          Turkey        irq         Iraq         060110        
 7  2020 tur          Turkey        isr         Israel       060110        
 8  2020 tur          Turkey        nld         Netherlands  060110        
 9  2020 tur          Turkey        syr         Syria        060110        
10  2020 tur          Turkey        tkm         Turkmenistan 060110        
# ℹ 209,500 more rows
# ℹ 8 more variables: commodity_name &lt;chr&gt;, section_code &lt;chr&gt;,
#   section_name &lt;chr&gt;, trade_value_usd_imp &lt;dbl&gt;, trade_value_usd_exp &lt;dbl&gt;,
#   partner_count &lt;int&gt;, cagr &lt;dbl&gt;, total_trade_value_imp_2020 &lt;dbl&gt;</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_imp_2020, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_2020), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_2020) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bubble Chart of Top 10 Section Names"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Importers"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Import mn USD (2020) "</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 52176 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: Complexity represents count of Turkey’s import partners for each product category that are defined in Analysis of Diversity of Imported Products, that are shown on x axis. Compounded growth rates of imports are represented on y axis. Each bubble represents exports value as of 2020 for each product category.</em></p>
</section>
<section id="trade-partnership-analysis" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="trade-partnership-analysis"><span class="header-section-number">3.6.3</span> Trade Partnership Analysis</h3>
<p><strong>Clustered Column Chart: Top 10 Trading Partners by Total Trade Value</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_trade</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a color palette from RColorBrewer</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>partner_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(top_partners<span class="sc">$</span>partner_name), <span class="st">"Set3"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize top trading partners</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_trade), <span class="at">y =</span> total_trade, <span class="at">fill =</span> partner_name)) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Trading Partners"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> partner_colors)<span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: Analyzing trade with specific partners helps in identifying key collaborators. Visualizing the top trading partners provides a clear understanding of the major contributors to the country’s trade.</em></p>
<p><strong>Clustered Column Chart: Trade Partner Classification as Net Exporter or Importer</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_trade</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> partners<span class="sc">$</span>partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export <span class="sc">+</span> total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_import</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a color palette from RColorBrewer</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>partner_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="fu">length</span>(top_partners<span class="sc">$</span>partner_name) <span class="sc">*</span> <span class="dv">2</span>, <span class="at">name =</span> <span class="st">"Paired"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in brewer.pal(n = length(top_partners$partner_name) * 2, name = "Paired"): n too large, allowed maximum for palette Paired is 12
Returning the palette you asked for with that many colors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export relations with top trading partners</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_export <span class="sc">-</span> total_import))) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import and Export Relations with Top 10 Trading Partners"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> partner_colors[<span class="dv">1</span>], <span class="st">"Import"</span> <span class="ot">=</span> partner_colors[<span class="dv">2</span>]), <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Clustered Column Chart: Net Trade Difference with Top 10 Trading Partners (2015-2020)</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of countries to filter</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>selected_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Germany"</span>, <span class="st">"Russian Federation"</span>, <span class="st">"China"</span>, <span class="st">"Italy"</span>, <span class="st">"USA"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Iran"</span>, <span class="st">"Iraq"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> selected_countries, year <span class="sc">%in%</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name, year) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'partner_name'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot to show trade comparison with selected trading partners</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>trade_difference), <span class="at">y =</span> trade_difference<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference)))) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">height =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Adjust the 'height' parameter</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net exporter"</span>, <span class="st">"Turkey net importer"</span>)) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trade Comparison with Top 10 Trading Partners(2015-2020)"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Trade Difference (Export - Import, mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_bar(stat = "identity", position = position_dodge(width = 0.8),
: Ignoring unknown parameters: `height`</code></pre>
</div>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: This bar plot illustrates the import and export relations between Turkey and its top 10 trading partners. Bars shows Turkey’s net importer &amp; exporter status as each of them corresponds to a specific partner, and positive figures represent Turkey’s status as net exporter while negative figures represent net importer. The plot offers a concise overview of Turkey’s trade dynamics with its key partners, emphasizing the balance of trade and highlighting significant trading relationships. // <u>Burada export-import yapıp net exporter veya net importer olup olmadığını olcelim</u></em></p>
<p><strong>Lollipop Chart: Trend Analysis of Top 10 Trading Partners’ trade value</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "YourFirstYear" and "YourEndYear" with the actual years that is selected for the analysis</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>first_year <span class="ot">&lt;-</span> <span class="dv">2015</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>end_year <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total trade value for the first and end years for each partner</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>total_trade_by_partner <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_trade_first =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> first_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> first_year]),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_trade_end =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> end_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> end_year]))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the top 10 partners based on the total trade value</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>top_10_partners <span class="ot">&lt;-</span> total_trade_by_partner <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, <span class="at">wt =</span> total_trade_end)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>percentage_change <span class="ot">&lt;-</span> top_10_partners <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage_change =</span> ((total_trade_end <span class="sc">-</span> total_trade_first) <span class="sc">/</span> total_trade_first) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a lollipop chart</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(percentage_change, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">y =</span> percentage_change)) <span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"skyblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Partners: Percentage Change in Total Trade Value (2015 to 2020)"</span>,</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage Change in Total Trade Value"</span>) <span class="sc">+</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: This lollipop chart illustrates 5 year trade value (total import + export) change between Turkey and its top 10 trading partners. Positive bars represent increase in trade values between Turkey and its top 10 partners in 5 years, while negative bars indicate decrease in trade relationship. The chart offers a concise overview of Turkey’s trade relationship with its key partners, presenting input for further analysis on defining partners that have close relationship with Turkey.</em></p>
<p><strong>Stacked Column Chart: Close Trade Partners (Increasing trend in trade volumes) listed with Product Categories</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Iraq, Spain, and USA</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners<span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Iraq"</span>, <span class="st">"Spain"</span>, <span class="st">"USA"</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for total trade</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners <span class="ot">&lt;-</span> trade_data_selected_partners<span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade =</span> (trade_value_usd_imp <span class="sc">+</span> trade_value_usd_exp)<span class="sc">/</span><span class="dv">1000000</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by section_name and calculate total trade values for each section_name</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>total_trade_values_5_year <span class="ot">&lt;-</span> trade_data_selected_partners <span class="sc">%&gt;%</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2015</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name, partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_trade_value =</span> <span class="fu">sum</span>(total_trade))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'section_name'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter top 5 section names</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data <span class="ot">&lt;-</span> total_trade_values_5_year <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade_value)) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>(filtered_commodity_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
   section_name                                   partner_name total_trade_value
   &lt;chr&gt;                                          &lt;chr&gt;                    &lt;dbl&gt;
 1 Natural or cultured pearls, precious or semi-… Iraq                    20051.
 2 Vegetable products                             Iraq                     7368.
 3 Prepared foodstuffs, beverages, spirits and v… Iraq                     6781.
 4 Base metals and articles of base metal         Iraq                     5474.
 5 Textile and textile articles                   Iraq                     5141.
 6 Vehicles, aircraft, vessels and associated tr… Spain                   18065.
 7 Textile and textile articles                   Spain                   15406.
 8 Machinery and mechanical appliances, electric… Spain                    9891.
 9 Base metals and articles of base metal         Spain                    8985.
10 Product of the chemicals or allied industries  Spain                    5046.
11 Vehicles, aircraft, vessels and associated tr… USA                     20741.
12 Machinery and mechanical appliances, electric… USA                     19968.
13 Base metals and articles of base metal         USA                     16568.
14 Textile and textile articles                   USA                     13360.
15 Product of the chemicals or allied industries  USA                      8983.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_commodity_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked Column Chart</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_commodity_data, <span class="fu">aes</span>(<span class="at">x =</span> partner_name, <span class="at">y =</span> total_trade_value, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Trade Breakdown by Section Name and Partner (2015-2020)"</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner Name"</span>, <span class="at">y =</span> <span class="st">"Total Trade mn USD"</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: These pie charts illustrate commodity breakdown data of each country that has close relationship with Turkey which are defined in previous analysis. Iraq, USA and Spain were analyzed in this section. Each pie chart represent share of top 5 commodities in total trade values.</em></p>
<p><strong>Line Chart: Trend Analysis of Exports Value by top 10 product categories</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>top_export_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_export</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top export products</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_export_products<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data based on the top export products</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>filtered_export_data <span class="ot">&lt;-</span> export_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_export_products<span class="sc">$</span>section_name)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>filtered_export_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_export_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(filtered_export_data<span class="sc">$</span>truncated_name)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> filtered_export_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_export, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Export Trends of Top 10 Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Export Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: Explore the export trends of Turkey’s top 10 product categories from 2002 to 2020. Each line represents a product category, showcasing the variation in total export values over the years. The colors distinguish different product categories, providing a visual overview of their respective export dynamics.</em></p>
<p><strong>Line Chart: Trend Analysis of Global Market Share of Total Exports Value of Turkey in Total Exports by product categories</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tba</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Chart Description: This chart Turkey’s export value in global exports, providing country’s presence and strategic importance in commodity markets</em></p>
<p><strong>Line Chart: Trend Analysis of Import Value by top 10 product categories</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>top_import_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by total_import</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top import products</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>import_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_import_products<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data based on the top import products</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>filtered_import_data <span class="ot">&lt;-</span> import_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_import_products<span class="sc">$</span>section_name)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>filtered_import_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_import_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(filtered_import_data<span class="sc">$</span>truncated_name)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> filtered_import_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_import, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import Trends of Top 10 Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Import Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="exploratorydataanalysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Chart Description: Description: Explore the import trends of Turkey’s top 10 product categories from 2002 to 2020. Each line represents a product category, showcasing the variation in total import values over the years. The colors distinguish different product categories, providing a visual overview of their respective import dynamics.</em></p>
</section>
</section>
<section id="step-6-interpretation-and-conclusions" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="step-6-interpretation-and-conclusions"><span class="header-section-number">3.7</span> Step 6: Interpretation and Conclusions</h2>
<p>Description: In this final step, interpretations and conclusions are drawn based on the analysis. It’s an opportunity to provide insights into the data, make recommendations, and outline potential next steps for further final report and presentation</p>
<hr>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./preprocesseddata.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preprocessed Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> " Exploratory Data Analysis"</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-12-14"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction: Exploratory Data Analysis on WITS data</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>World Integrated Trade Solution (WITS) emerges as a pivotal platform, offering a comprehensive view of international trade dynamics, with a particular focus on Turkey from 2002 to 2020. This powerful tool aggregates data from diverse sources to furnish users with valuable insights into Turkey's merchandise trade, tariffs, and non-tariff measures during this specific period. With an expansive database, WITS facilitates informed decision-making and strategic planning for researchers, policymakers, and businesses interested in Turkey's trade landscape.</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>Embarking on an Exploratory Data Analysis (EDA) journey within WITS involves loading datasets, cleaning data, and employing statistical and visual analyses specific to Turkey's trade from 2002 to 2020. This process unveils trade patterns, identifies trends, and provides actionable insights, enabling stakeholders to navigate the complexities of Turkey's trade dynamics during this crucial timeframe. The synergy between WITS and EDA empowers users to make informed decisions and strategic choices, fostering a more interconnected and informed landscape for Turkey's economy and trade.</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 1: Load Required Libraries</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>Description: Loading necessary libraries provides access to functions and tools that simplify data manipulation and visualization. dplyr is helpful for data wrangling, and ggplot2 is excellent for creating informative and visually appealing plots.</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 2: Load Datasets</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the datasets</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>loaded_datasets <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"wits_data.rds"</span>)</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_only <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_turkey_data_only</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_turkey_data_with_partners</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>read_wits_all_country_data <span class="ot">&lt;-</span> loaded_datasets<span class="sc">$</span>wits_all_country_data</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>Description: Loading datasets is the initial step in any data analysis. It allows us to bring in the data that we'll be working with throughout the analysis.</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 3: Overview of the Datasets</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read_wits_turkey_data_only)</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(read_wits_turkey_data_only)</span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read_wits_turkey_data_with_partners)</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(read_wits_turkey_data_with_partners)</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(read_wits_all_country_data)</span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(read_wits_all_country_data)</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>Description: Checking the structure and summary of the datasets provides an understanding of the variables, data types, and basic statistics. This helps identify potential issues and informs subsequent cleaning and analysis steps.</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 4: Data Cleaning</span></span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(read_wits_turkey_data_only, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a><span class="co"># will be done</span></span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>Description: Cleaning the data involves addressing missing values and outliers. It ensures that the data is reliable and ready for further analysis.</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 5: Exploratory Data Analysis (EDA)</span></span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a><span class="fu">### Country Profile</span></span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>|                            |     |</span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a>|----------------------------|-----|</span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>| **Export Ranking:**        |     |</span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>| **Import Ranking:**        |     |</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a>| **Top Trading Partners**:  |     |</span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>*Most available data is as of 2020 year-end:*</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate Country Profile Stats</span></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a>**Line Chart: Exports and Imports over the Years:**</span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a>total_exports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_exports =</span> <span class="fu">sum</span>(trade_value_usd_exp))</span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a>total_imports <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_imports =</span> <span class="fu">sum</span>(trade_value_usd_imp))</span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize exports and imports over the years</span></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_exports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_exports, <span class="at">color =</span> <span class="st">"Exports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_imports, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_imports, <span class="at">color =</span> <span class="st">"Imports"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Turkey's Exports and Imports Over the Years"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Trade Value (USD)"</span></span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a>*Line Chart Description: Analyzing exports and imports over time provides insights into the trade trends of the country. Visualization helps in identifying patterns and understanding the overall trade dynamics*</span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a>**Result: Turkey's status is as a net importer since 2002**</span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exports &amp; Imports Analysis</span></span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a>**Top 10 product categories are listed in this section both for exports and imports in order to analyze this further by looking into trade partners of these product types**</span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a>**Clustered Column Chart: Diversity of Exported Products**</span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a>export_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(export_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(export_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> export_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_export), <span class="at">y =</span> total_export, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Exported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Total Export Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a>*Chart Description:The "Diversity of Exported Products" graphic provides insights into Turkey's international trade from 2002 to 2020. It showcases the top 10 product categories that Turkey has predominantly exported over the years. Each product category is represented by a distinct color, offering a visual representation of the diversity and distribution of exported goods. The vertical bars display the total export values in USD for each product category, providing a clear overview of Turkey's major export sectors. The graphic aids in identifying trends, patterns, and the relative significance of various product categories in Turkey's export landscape.*</span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a>**Bubble Chart: Relationship between Complexity and Annual Export Growth (CAGR Last 5 years) for Top Product Categories**</span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export)) <span class="sc">%&gt;%</span></span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_exp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_exp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_exp_2020 =</span> <span class="fu">sum</span>(trade_value_usd_exp)<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(read_wits_turkey_data_with_partners_top10)</span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_exp_2020, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_2020), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_exp_2020) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bubble Chart of Top 10 Section Names"</span>,</span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Export Countries"</span>,</span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Export Revenue mn USD (2020) "</span>,</span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span> ()</span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a>*Chart Description: Complexity represents count of Turkey's export partners for each product category that are defined in Analysis of Diversity of Exported Products, that are shown on x axis. Compounded growth rates of exports are represented on y axis. Each bubble represents exports value as of 2020 for each product category.*</span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a>**Clustered Column Chart: Diversity of Imported Products**</span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a>imported_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a>imported_plot_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(imported_plot_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(imported_plot_data<span class="sc">$</span>truncated_name)</span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> imported_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(section_name, <span class="sc">-</span>total_import), <span class="at">y =</span> total_import, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Diversity of Imported Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Products"</span>, <span class="at">y =</span> <span class="st">"Total Import Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a>*Chart Description: The "Diversity of Imported Products" graphic illustrates the diversity of products that Turkey has imported from other countries between 2002 and 2020. Similar to the exported products graphic, this visualization highlights the top 10 imported product categories. Each category is uniquely colored for easy identification. The vertical bars display the total import values in USD for each product category, offering insights into the composition of Turkey's imports. This graphic assists in understanding the import dynamics, identifying significant product categories, and discerning patterns in Turkey's international trade relationships.*</span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a>**Bubble Chart: Relationship between Complexity and Annual Import Growth (CAGR Last 5 years) for Top Product Categories**</span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Find the top 10 section_name based on trade_value</span></span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a>top_sections <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter the dataframe to include only the top 10 section_names</span></span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_sections<span class="sc">$</span>section_name)</span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Count partner_names corresponding to the top 10 section_names in the entire dataframe</span></span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10  <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10  <span class="sc">%&gt;%</span></span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partner_count =</span> <span class="fu">n_distinct</span>(partner_name)) <span class="sc">%&gt;%</span></span>
<span id="cb68-263"><a href="#cb68-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-264"><a href="#cb68-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cagr =</span> ((trade_value_usd_imp[<span class="dv">2020</span>]<span class="sc">/</span>trade_value_usd_imp[<span class="dv">2015</span>])<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10 <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10 <span class="sc">%&gt;%</span></span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade_value_imp_2020 =</span> <span class="fu">sum</span>(trade_value_usd_imp)<span class="sc">/</span><span class="dv">1000000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(read_wits_turkey_data_with_partners_top10)</span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a>read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners_top10<span class="sc">$</span>truncated_name</span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(read_wits_turkey_data_with_partners_top10, <span class="fu">aes</span>(<span class="at">x =</span> partner_count, <span class="at">y =</span> total_trade_value_imp_2020, <span class="at">size =</span> cagr, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_2020), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>total_trade_value_imp_2020) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="co"># adjust y-axis scale</span></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count), <span class="fu">max</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>partner_count) <span class="sc">+</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># adjust x-axis scale</span></span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(read_wits_turkey_data_with_partners_top10<span class="sc">$</span>section_name)))) <span class="sc">+</span>  <span class="co"># Use a different color palette</span></span>
<span id="cb68-291"><a href="#cb68-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bubble Chart of Top 10 Section Names"</span>,</span>
<span id="cb68-292"><a href="#cb68-292" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Importers"</span>,</span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Import mn USD (2020) "</span>,</span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"5 year CAGR"</span>, </span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span> ()</span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-298"><a href="#cb68-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a>*Chart Description: Complexity represents count of Turkey's import partners for each product category that are defined in Analysis of Diversity of Imported Products, that are shown on x axis. Compounded growth rates of imports are represented on y axis. Each bubble represents exports value as of 2020 for each product category.*</span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trade Partnership Analysis</span></span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a>**Clustered Column Chart: Top 10 Trading Partners by Total Trade Value**</span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a color palette from RColorBrewer</span></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a>partner_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(top_partners<span class="sc">$</span>partner_name), <span class="st">"Set3"</span>)</span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize top trading partners</span></span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_trade), <span class="at">y =</span> total_trade, <span class="at">fill =</span> partner_name)) <span class="sc">+</span></span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Trading Partners"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> partner_colors)<span class="sc">+</span></span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a>*Chart Description: Analyzing trade with specific partners helps in identifying key collaborators. Visualizing the top trading partners provides a clear understanding of the major contributors to the country's trade.*</span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a>**Clustered Column Chart: Trade Partner Classification as Net Exporter or Importer**</span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a>partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-335"><a href="#cb68-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_trade =</span> <span class="fu">sum</span>(trade_value_usd_exp <span class="sc">+</span> trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade)) <span class="sc">%&gt;%</span></span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> partners<span class="sc">$</span>partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_export <span class="sc">+</span> total_import)) <span class="sc">%&gt;%</span></span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a color palette from RColorBrewer</span></span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a>partner_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="fu">length</span>(top_partners<span class="sc">$</span>partner_name) <span class="sc">*</span> <span class="dv">2</span>, <span class="at">name =</span> <span class="st">"Paired"</span>)</span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize import and export relations with top trading partners</span></span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>total_export <span class="sc">-</span> total_import))) <span class="sc">+</span></span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_export, <span class="at">fill =</span> <span class="st">"Export"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="sc">-</span>total_import, <span class="at">fill =</span> <span class="st">"Import"</span>), <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import and Export Relations with Top 10 Trading Partners"</span>, <span class="at">x =</span> <span class="st">"Partner"</span>, <span class="at">y =</span> <span class="st">"Total Trade Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Export"</span> <span class="ot">=</span> partner_colors[<span class="dv">1</span>], <span class="st">"Import"</span> <span class="ot">=</span> partner_colors[<span class="dv">2</span>]), <span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a>**Clustered Column Chart: Net Trade Difference with Top 10 Trading Partners (2015-2020)**</span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector of countries to filter</span></span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a>selected_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Germany"</span>, <span class="st">"Russian Federation"</span>, <span class="st">"China"</span>, <span class="st">"Italy"</span>, <span class="st">"USA"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Iran"</span>, <span class="st">"Iraq"</span>)</span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a>top_partners <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> selected_countries, year <span class="sc">%in%</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name, year) <span class="sc">%&gt;%</span></span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp),</span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trade_difference =</span> total_export <span class="sc">-</span> total_import)</span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot to show trade comparison with selected trading partners</span></span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> top_partners, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, <span class="sc">-</span>trade_difference), <span class="at">y =</span> trade_difference<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">sign</span>(trade_difference)))) <span class="sc">+</span></span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">height =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Adjust the 'height' parameter</span></span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Turkey net exporter"</span>, <span class="st">"Turkey net importer"</span>)) <span class="sc">+</span></span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trade Comparison with Top 10 Trading Partners(2015-2020)"</span>,</span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Trade Difference (Export - Import, mn USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a>*Chart Description: This bar plot illustrates the import and export relations between Turkey and its top 10 trading partners. Bars shows Turkey's net importer &amp; exporter status as each of them corresponds to a specific partner, and positive figures represent Turkey's status as net exporter while negative figures represent net importer. The plot offers a concise overview of Turkey's trade dynamics with its key partners, emphasizing the balance of trade and highlighting significant trading relationships. // [Burada export-import yapıp net exporter veya net importer olup olmadığını olcelim]{.underline}*</span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a>**Lollipop Chart: Trend Analysis of Top 10 Trading Partners' trade value**</span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace "YourFirstYear" and "YourEndYear" with the actual years that is selected for the analysis</span></span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a>first_year <span class="ot">&lt;-</span> <span class="dv">2015</span></span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a>end_year <span class="ot">&lt;-</span> <span class="dv">2020</span></span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total trade value for the first and end years for each partner</span></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a>total_trade_by_partner <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_trade_first =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> first_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> first_year]),</span>
<span id="cb68-401"><a href="#cb68-401" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_trade_end =</span> <span class="fu">sum</span>(trade_value_usd_imp[year <span class="sc">==</span> end_year] <span class="sc">+</span> trade_value_usd_exp[year <span class="sc">==</span> end_year]))</span>
<span id="cb68-402"><a href="#cb68-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the top 10 partners based on the total trade value</span></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a>top_10_partners <span class="ot">&lt;-</span> total_trade_by_partner <span class="sc">%&gt;%</span></span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, <span class="at">wt =</span> total_trade_end)</span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage change</span></span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a>percentage_change <span class="ot">&lt;-</span> top_10_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-409"><a href="#cb68-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage_change =</span> ((total_trade_end <span class="sc">-</span> total_trade_first) <span class="sc">/</span> total_trade_first) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb68-410"><a href="#cb68-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a lollipop chart</span></span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(percentage_change, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">y =</span> percentage_change)) <span class="sc">+</span></span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">reorder</span>(partner_name, percentage_change), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"skyblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Partners: Percentage Change in Total Trade Value (2015 to 2020)"</span>,</span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner"</span>,</span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage Change in Total Trade Value"</span>) <span class="sc">+</span></span>
<span id="cb68-418"><a href="#cb68-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a>*Chart Description: This lollipop chart illustrates 5 year trade value (total import + export) change between Turkey and its top 10 trading partners. Positive bars represent increase in trade values between Turkey and its top 10 partners in 5 years, while negative bars indicate decrease in trade relationship. The chart offers a concise overview of Turkey's trade relationship with its key partners, presenting input for further analysis on defining partners that have close relationship with Turkey.*</span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a>**Stacked Column Chart: Close Trade Partners (Increasing trend in trade volumes) listed with Product Categories**</span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for Iraq, Spain, and USA</span></span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners<span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(partner_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Iraq"</span>, <span class="st">"Spain"</span>, <span class="st">"USA"</span>))</span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-432"><a href="#cb68-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for total trade</span></span>
<span id="cb68-433"><a href="#cb68-433" aria-hidden="true" tabindex="-1"></a>trade_data_selected_partners <span class="ot">&lt;-</span> trade_data_selected_partners<span class="sc">%&gt;%</span></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_trade =</span> (trade_value_usd_imp <span class="sc">+</span> trade_value_usd_exp)<span class="sc">/</span><span class="dv">1000000</span>)</span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-436"><a href="#cb68-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by section_name and calculate total trade values for each section_name</span></span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a>total_trade_values_5_year <span class="ot">&lt;-</span> trade_data_selected_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2015</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name, partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_trade_value =</span> <span class="fu">sum</span>(total_trade))</span>
<span id="cb68-441"><a href="#cb68-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-442"><a href="#cb68-442" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter top 5 section names</span></span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data <span class="ot">&lt;-</span> total_trade_values_5_year <span class="sc">%&gt;%</span></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(partner_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_trade_value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>(filtered_commodity_data)</span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a>filtered_commodity_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_commodity_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked Column Chart</span></span>
<span id="cb68-454"><a href="#cb68-454" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_commodity_data, <span class="fu">aes</span>(<span class="at">x =</span> partner_name, <span class="at">y =</span> total_trade_value, <span class="at">fill =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-455"><a href="#cb68-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total Trade Breakdown by Section Name and Partner (2015-2020)"</span>,</span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Partner Name"</span>, <span class="at">y =</span> <span class="st">"Total Trade mn USD"</span>,</span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Section Name"</span>) <span class="sc">+</span></span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>))</span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a>*Chart Description: These pie charts illustrate commodity breakdown data of each country that has close relationship with Turkey which are defined in previous analysis. Iraq, USA and Spain were analyzed in this section. Each pie chart represent share of top 5 commodities in total trade values.*</span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a>**Line Chart: Trend Analysis of Exports Value by top 10 product categories**</span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-470"><a href="#cb68-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-471"><a href="#cb68-471" aria-hidden="true" tabindex="-1"></a>top_export_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top export products</span></span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a>export_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_export_products<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_export =</span> <span class="fu">sum</span>(trade_value_usd_exp))</span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data based on the top export products</span></span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a>filtered_export_data <span class="ot">&lt;-</span> export_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_export_products<span class="sc">$</span>section_name)</span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a>filtered_export_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_export_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-489"><a href="#cb68-489" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb68-490"><a href="#cb68-490" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(filtered_export_data<span class="sc">$</span>truncated_name)</span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-495"><a href="#cb68-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb68-496"><a href="#cb68-496" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> filtered_export_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_export, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-497"><a href="#cb68-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-498"><a href="#cb68-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Export Trends of Top 10 Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Export Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-499"><a href="#cb68-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb68-500"><a href="#cb68-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb68-501"><a href="#cb68-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb68-502"><a href="#cb68-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-503"><a href="#cb68-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-504"><a href="#cb68-504" aria-hidden="true" tabindex="-1"></a>*Chart Description: Explore the export trends of Turkey's top 10 product categories from 2002 to 2020. Each line represents a product category, showcasing the variation in total export values over the years. The colors distinguish different product categories, providing a visual overview of their respective export dynamics.*</span>
<span id="cb68-505"><a href="#cb68-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-506"><a href="#cb68-506" aria-hidden="true" tabindex="-1"></a>**Line Chart: Trend Analysis of Global Market Share of Total Exports Value of Turkey in Total Exports by product categories**</span>
<span id="cb68-507"><a href="#cb68-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-510"><a href="#cb68-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-511"><a href="#cb68-511" aria-hidden="true" tabindex="-1"></a><span class="co">#tba</span></span>
<span id="cb68-512"><a href="#cb68-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-513"><a href="#cb68-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-514"><a href="#cb68-514" aria-hidden="true" tabindex="-1"></a>*Chart Description: This chart Turkey's export value in global exports, providing country's presence and strategic importance in commodity markets*</span>
<span id="cb68-515"><a href="#cb68-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-516"><a href="#cb68-516" aria-hidden="true" tabindex="-1"></a>**Line Chart: Trend Analysis of Import Value by top 10 product categories**</span>
<span id="cb68-517"><a href="#cb68-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-520"><a href="#cb68-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-521"><a href="#cb68-521" aria-hidden="true" tabindex="-1"></a>top_import_products <span class="ot">&lt;-</span> read_wits_turkey_data_only <span class="sc">%&gt;%</span></span>
<span id="cb68-522"><a href="#cb68-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-523"><a href="#cb68-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp)) <span class="sc">%&gt;%</span></span>
<span id="cb68-524"><a href="#cb68-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb68-525"><a href="#cb68-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-526"><a href="#cb68-526" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data with the selected top import products</span></span>
<span id="cb68-527"><a href="#cb68-527" aria-hidden="true" tabindex="-1"></a>import_plot_data <span class="ot">&lt;-</span> read_wits_turkey_data_with_partners <span class="sc">%&gt;%</span></span>
<span id="cb68-528"><a href="#cb68-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_import_products<span class="sc">$</span>section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-529"><a href="#cb68-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, section_name) <span class="sc">%&gt;%</span></span>
<span id="cb68-530"><a href="#cb68-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_import =</span> <span class="fu">sum</span>(trade_value_usd_imp))</span>
<span id="cb68-531"><a href="#cb68-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-532"><a href="#cb68-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data based on the top import products</span></span>
<span id="cb68-533"><a href="#cb68-533" aria-hidden="true" tabindex="-1"></a>filtered_import_data <span class="ot">&lt;-</span> import_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb68-534"><a href="#cb68-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(section_name <span class="sc">%in%</span> top_import_products<span class="sc">$</span>section_name)</span>
<span id="cb68-535"><a href="#cb68-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-536"><a href="#cb68-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Truncate section names to the first 20 characters</span></span>
<span id="cb68-537"><a href="#cb68-537" aria-hidden="true" tabindex="-1"></a>filtered_import_data<span class="sc">$</span>truncated_name <span class="ot">&lt;-</span> <span class="fu">str_trunc</span>(filtered_import_data<span class="sc">$</span>section_name, <span class="dv">50</span>)</span>
<span id="cb68-538"><a href="#cb68-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-539"><a href="#cb68-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Get distinct truncated names for colors</span></span>
<span id="cb68-540"><a href="#cb68-540" aria-hidden="true" tabindex="-1"></a>color_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(filtered_import_data<span class="sc">$</span>truncated_name)</span>
<span id="cb68-541"><a href="#cb68-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-542"><a href="#cb68-542" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a limited number of distinct colors</span></span>
<span id="cb68-543"><a href="#cb68-543" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="fu">length</span>(color_names), <span class="st">"Set3"</span>)</span>
<span id="cb68-544"><a href="#cb68-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-545"><a href="#cb68-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot with geom_point</span></span>
<span id="cb68-546"><a href="#cb68-546" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> filtered_import_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_import, <span class="at">color =</span> truncated_name)) <span class="sc">+</span></span>
<span id="cb68-547"><a href="#cb68-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-548"><a href="#cb68-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Import Trends of Top 10 Products (2002-2020, Turkey)"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Total Import Value (USD)"</span>) <span class="sc">+</span></span>
<span id="cb68-549"><a href="#cb68-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb68-550"><a href="#cb68-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb68-551"><a href="#cb68-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">setNames</span>(colors, color_names), <span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb68-552"><a href="#cb68-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-553"><a href="#cb68-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-554"><a href="#cb68-554" aria-hidden="true" tabindex="-1"></a>*Chart Description: Description: Explore the import trends of Turkey's top 10 product categories from 2002 to 2020. Each line represents a product category, showcasing the variation in total import values over the years. The colors distinguish different product categories, providing a visual overview of their respective import dynamics.*</span>
<span id="cb68-555"><a href="#cb68-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-556"><a href="#cb68-556" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 6: Interpretation and Conclusions</span></span>
<span id="cb68-557"><a href="#cb68-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-558"><a href="#cb68-558" aria-hidden="true" tabindex="-1"></a>Description: In this final step, interpretations and conclusions are drawn based on the analysis. It's an opportunity to provide insights into the data, make recommendations, and outline potential next steps for further final report and presentation</span>
<span id="cb68-559"><a href="#cb68-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-560"><a href="#cb68-560" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center"><a href="https://mef-bda503.github.io">MEF BDA 503</a></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>